import{_ as w,u as S,A as i,n,a0 as p,d as a,q as o,$ as g,F as h,a2 as u,X as b,Y as c,Z as B,p as k,a4 as T,a5 as D,at as m,ac as v,ap as y,a3 as V}from"./index.f6661a24.js";import{Q as U}from"./QToolbarTitle.0f4dda99.js";import{Q as $}from"./QToolbar.7bb603c7.js";import{Q as F}from"./QHeader.ba9c2ff9.js";import{Q as C}from"./QInnerLoading.c6ed50f8.js";import{Q as f}from"./QSelect.4e3956e1.js";import{Q as P}from"./QDate.b5ca4044.js";import{Q}from"./QPopupProxy.98b4d203.js";import{Q as I}from"./QTime.9a851507.js";import{Q as A}from"./QSpace.7af5fd36.js";import{Q as L}from"./QFooter.4f4f9530.js";import{Q as N}from"./QForm.4e86ee71.js";import{Q as z}from"./QPage.78315ab4.js";import{C as q}from"./ClosePopup.6296f014.js";import"./QResizeObserver.dc10e4c2.js";import"./QChip.5b52e54d.js";import"./QItemLabel.0d3c2221.js";import"./QMenu.c4f03f28.js";import"./selection.ef67fb9c.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./use-render-cache.3aae9b27.js";import"./date.6d02ab88.js";import"./TouchPan.ca911d69.js";import"./touch.9135741d.js";const E={name:"TableForms",setup(){return{DataStore:S()}},data(){return{loading:!1,data:[],client_id:[],reservation_date:"",reservation_time:"",guest_number:0,table_id:"",special_request:"",status:"pending",room_names:[],table_names:[{label:this.$t("Please select"),value:0}],status_list:[],customer_list:[]}},created(){this.DataStore.getTableList()},mounted(){this.id=this.$route.query.id,i.empty(this.id)||this.getBookingDetails()},computed:{isEdit(){return!i.empty(this.id)}},methods:{formSubmit(){let e={id:i.empty(this.id)?"":this.id,client_id:this.client_id,reservation_date:this.reservation_date,reservation_time:this.reservation_time,guest_number:this.guest_number,table_id:this.table_id,special_request:this.special_request,status:this.status};i.showLoadingBox("",this.$q),i.fetchDataByTokenPost(i.empty(this.id)?"AddBooking":"UpdateBooking",e).then(t=>{i.notify("light-green",t.msg,"check_circle",this.$q),i.empty(this.id)?this.$router.replace({path:"/table/menu"}):this.$router.replace({path:"/tables/reservation_overview",query:{id:t.details.id}})}).catch(t=>{i.notify("red-5",t,"error_outline",this.$q)}).then(t=>{i.hideLoadingBox(this.$q)})},filterFn(e,t,_){if(e.length<2){_();return}i.fetchDataByTokenPost("SearchCustomer","q="+e).then(r=>{t(()=>{this.customer_list=r.details.data})}).catch(r=>{console.debug(r)}).then(r=>{})},setModel(e){console.log(e)},getBookingDetails(){this.loading=!0,i.fetchDataByTokenPost("getBookingDetails","id="+this.id+"&payload=update").then(e=>{this.data=e.details.data,this.room_names=e.details.room_names,this.table_names=e.details.table_names,this.status_list=e.details.status_list,this.client_id=this.data.client_id,this.reservation_date=this.data.reservation_date_raw,this.reservation_time=this.data.reservation_time_raw,this.guest_number=parseInt(this.data.guest_number_raw),this.table_id=parseInt(this.data.table_id),this.special_request=this.data.special_request,this.status=this.data.status,this.customer_list=e.details.customer_list}).catch(e=>{}).then(e=>{this.loading=!1})}}},j={class:"row items-center justify-end"},M={class:"row items-center justify-end"};function R(e,t,_,r,s,d){return n(),p(h,null,[a(F,{class:g({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:o(()=>[a($,null,{default:o(()=>[a(u,{onClick:t[0]||(t[0]=l=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(U,{class:"text-weight-bold"},{default:o(()=>[d.isEdit?(n(),p(h,{key:0},[b(c(e.$t("Update Booking")),1)],64)):(n(),p(h,{key:1},[b(c(e.$t("Add Booking")),1)],64))]),_:1})]),_:1}),a(B)]),_:1},8,["class"]),a(z,{class:g([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode},"q-pa-md"])},{default:o(()=>[s.loading?(n(),k(C,{key:0,showing:!0,color:"primary",size:"md"})):(n(),k(N,{key:1,onSubmit:d.formSubmit},{default:o(()=>[a(f,{modelValue:s.client_id,"onUpdate:modelValue":[t[1]||(t[1]=l=>s.client_id=l),d.setModel],label:e.$t("Customer"),behavior:"dialog","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",outlined:"",options:s.customer_list,onFilter:d.filterFn,color:"grey-5","stack-label":"",rules:[l=>l&&l.length>0||this.$t("This field is required")],"emit-value":"","map-options":""},{"no-option":o(()=>[a(T,null,{default:o(()=>[a(D,{class:"text-grey"},{default:o(()=>[b(c(e.$t("No results")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","label","options","onFilter","onUpdate:modelValue","rules"]),a(m,{modelValue:s.reservation_date,"onUpdate:modelValue":t[3]||(t[3]=l=>s.reservation_date=l),rules:["date"],outlined:"",color:"grey-5",label:e.$t("Reservation date"),"stack-label":"",readonly:""},{append:o(()=>[a(v,{name:"event",class:"cursor-pointer",color:"blue"},{default:o(()=>[a(Q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(P,{modelValue:s.reservation_date,"onUpdate:modelValue":t[2]||(t[2]=l=>s.reservation_date=l),color:"blue"},{default:o(()=>[y("div",j,[V(a(u,{label:e.$t("Close"),color:"dark",flat:"","no-caps":""},null,8,["label"]),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),a(m,{modelValue:s.reservation_time,"onUpdate:modelValue":t[5]||(t[5]=l=>s.reservation_time=l),mask:"time",rules:["time"],outlined:"",color:"grey-5",label:e.$t("Reservation time"),"stack-label":"",readonly:""},{append:o(()=>[a(v,{name:"access_time",class:"cursor-pointer",color:"blue"},{default:o(()=>[a(Q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:o(()=>[a(I,{modelValue:s.reservation_time,"onUpdate:modelValue":t[4]||(t[4]=l=>s.reservation_time=l),color:"blue",mask:"hh:mm",format24h:""},{default:o(()=>[y("div",M,[V(a(u,{label:e.$t("Close"),color:"dark",flat:"","no-caps":""},null,8,["label"]),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),a(m,{modelValue:s.guest_number,"onUpdate:modelValue":t[6]||(t[6]=l=>s.guest_number=l),type:"number",label:e.$t("Guest number"),"stack-label":"",outlined:"",color:"grey-5",rules:[l=>l>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(f,{modelValue:s.table_id,"onUpdate:modelValue":t[7]||(t[7]=l=>s.table_id=l),options:r.DataStore.table_list,label:e.$t("Table name"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":"",rules:[l=>l||this.$t("This field is required")]},null,8,["modelValue","options","label","rules"]),a(m,{modelValue:s.special_request,"onUpdate:modelValue":t[8]||(t[8]=l=>s.special_request=l),label:e.$t("Special request"),"stack-label":"",outlined:"",color:"grey-5",autogrow:""},null,8,["modelValue","label"]),a(A,{class:"q-pa-sm"}),a(f,{modelValue:s.status,"onUpdate:modelValue":t[9]||(t[9]=l=>s.status=l),options:r.DataStore.booking_status_list_value,label:e.$t("Status"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[l=>l&&l.length>0||this.$t("This field is required")],"emit-value":"","map-options":""},null,8,["modelValue","options","label","rules"]),a(L,null,{default:o(()=>[a(u,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ce=w(E,[["render",R]]);export{ce as default};
