import{_ as $,ay as C,A as l,m as D,n as s,a0 as c,d as t,q as u,$ as _,F as b,a2 as y,X as m,Y as n,as as k,Z as v,p as d,ap as h,ac as Q,at as A,az as w}from"./index.f6661a24.js";import{Q as L}from"./QToolbarTitle.0f4dda99.js";import{Q as x}from"./QToolbar.7bb603c7.js";import{Q as U}from"./QHeader.ba9c2ff9.js";import{Q as V}from"./QInnerLoading.c6ed50f8.js";import{Q as g}from"./QImg.b7890c8b.js";import{Q as q}from"./QSpace.7af5fd36.js";import{Q as B}from"./QFooter.4f4f9530.js";import{Q as F}from"./QForm.4e86ee71.js";import{Q as T}from"./QPage.78315ab4.js";import{A as f}from"./AppCamera.4fe7ee93.js";import"./QResizeObserver.dc10e4c2.js";const z={name:"AddLicense",data(){return{loading:!1,data:[],license_number:"",license_expiration:"",upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:"",upload_enabled2:!1,photo_data2:"",photo2:"",upload_path2:"",avatar2:""}},components:{UploaderFile:C(()=>w(()=>import("./UploaderFile.36c0f73c.js"),["assets/UploaderFile.36c0f73c.js","assets/QUploader.d12c38b5.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QCircularProgress.24399868.js","assets/format.de7e9769.js"]))},computed:{hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!l.empty(this.photo)},hasPhotodata2(){return Object.keys(this.photo_data2).length>0},hasPhoto2(){return!l.empty(this.photo2)}},mounted(){this.id=this.$route.query.id,l.empty(this.id)||this.getLicense()},methods:{getLicense(){this.loading=!0,l.fetchDataByTokenPost("getDriverInfo","id="+this.id).then(e=>{this.data=e.details,this.license_number=this.data.license_number,this.license_expiration=this.data.license_expiration,this.avatar=e.details.license_front_photo_url,this.photo=e.details.license_front_photo,this.upload_path=e.details.path_license,this.avatar2=e.details.license_back_photo_url,this.photo2=e.details.license_back_photo,this.upload_path2=e.details.path_license}).catch(e=>{}).then(e=>{this.loading=!1})},formSubmit(){l.showLoadingBox("",this.$q);let e={id:this.id,license_number:this.license_number,license_expiration:this.license_expiration,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:"",upload_path2:this.upload_path2,photo2:this.photo2,file_data2:this.hadData2()?this.photo_data2.data:"",image_type2:this.hadData2()?this.photo_data2.format:""};l.fetchDataByTokenPost("AddLicense",e).then(a=>{l.notify("light-green",a.msg,"check_circle",this.$q)}).catch(a=>{l.notify("red-5",a,"error_outline",this.$q)}).then(a=>{l.hideLoadingBox(this.$q)})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},afterUploadfile2(e){this.photo2=e.filename,this.avatar2=e.url_image,this.upload_path2=e.upload_path},takePhoto(){this.$q.capacitor?f.isCameraEnabled().then(e=>{f.isFileAccessEnabled().then(a=>{f.getPhoto(1).then(p=>{this.photo_data=p}).catch(p=>{this.photo_data=[]})}).catch(a=>{l.notify("dark",a,"error",this.$q)})}).catch(e=>{l.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0},takePhoto2(){this.$q.capacitor?f.isCameraEnabled().then(e=>{f.isFileAccessEnabled().then(a=>{f.getPhoto(1).then(p=>{this.photo_data2=p}).catch(p=>{this.photo_data2=[]})}).catch(a=>{l.notify("dark",a,"error",this.$q)})}).catch(e=>{l.notify("dark",e,"error",this.$q)}):this.upload_enabled2=!this.upload_enabled2},hadData2(){return Object.keys(this.photo_data2).length>0}}},S={class:"row q-gutter-sm"},j={class:"col"},E={class:"font12 line-normal"},I=h("br",null,null,-1),N={class:"q-mb-sm"},O={class:"row q-gutter-sm"},Y={class:"col"},G={class:"font12 line-normal"},J=h("br",null,null,-1),H={key:1,class:"text-grey"};function R(e,a,p,X,i,o){const P=D("UploaderFile");return s(),c(b,null,[t(U,{class:_({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:u(()=>[t(x,null,{default:u(()=>[t(y,{onClick:a[0]||(a[0]=r=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),t(L,{class:"text-weight-bold"},{default:u(()=>[m(n(e.$t("License"))+" ",1),o.hasData?(s(),c(b,{key:0},[m(" - "+n(i.data.first_name)+" "+n(i.data.last_name),1)],64)):k("",!0)]),_:1})]),_:1}),t(v)]),_:1},8,["class"]),t(T,{class:_([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!i.loading&&!o.hasData},"q-pa-md"])},{default:u(()=>[i.loading?(s(),d(V,{key:0,showing:!0,color:"primary",size:"md"})):(s(),d(F,{key:1,onSubmit:o.formSubmit},{default:u(()=>[o.hasData?(s(),c(b,{key:0},[h("div",S,[o.hasPhotodata?(s(),d(g,{key:0,src:i.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):o.hasPhoto?(s(),d(g,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),c("div",{key:2,class:_(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[t(Q,{name:"las la-image",class:"text-grey",size:"xl"})],2)),h("div",j,[h("div",E,[m(n(e.$t("License front photo"))+".",1),I,m(" "+n(e.$t("Accepted types: PNG. JPG")),1)]),t(y,{label:o.hasPhoto?this.$t("Change Photo"):o.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:o.takePhoto},null,8,["label","onClick"])])]),t(q,{class:"q-pa-sm"}),i.upload_enabled?(s(),d(P,{key:0,ref:"uploader_file",onAfterUploadfile:o.afterUploadfile},null,8,["onAfterUploadfile"])):k("",!0),h("div",N,[t(v)]),h("div",O,[o.hasPhotodata2?(s(),d(g,{key:0,src:i.photo_data2.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):o.hasPhoto2?(s(),d(g,{key:1,src:this.avatar2,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),c("div",{key:2,class:_(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[t(Q,{name:"las la-image",class:"text-grey",size:"xl"})],2)),h("div",Y,[h("div",G,[m(n(e.$t("License back photo"))+".",1),J,m(" "+n(e.$t("Accepted types: PNG. JPG")),1)]),t(y,{label:o.hasPhoto2?this.$t("Change Photo"):e.hasData2?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:o.takePhoto2},null,8,["label","onClick"])])]),t(q,{class:"q-pa-sm"}),i.upload_enabled2?(s(),d(P,{key:1,ref:"uploader_file",onAfterUploadfile:o.afterUploadfile2},null,8,["onAfterUploadfile"])):k("",!0),t(q,{class:"q-pa-sm"}),t(A,{modelValue:i.license_number,"onUpdate:modelValue":a[1]||(a[1]=r=>i.license_number=r),label:e.$t("License number"),"stack-label":"",outlined:"",color:"grey-5",rules:[r=>r&&r.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),t(A,{modelValue:i.license_expiration,"onUpdate:modelValue":a[2]||(a[2]=r=>i.license_expiration=r),label:e.$t("License expiration"),hint:e.$t("(YYYY/mm/dd)"),mask:"####/##/##","stack-label":"",outlined:"",color:"grey-5",rules:[r=>r&&r.length>0||this.$t("This field is required")]},null,8,["modelValue","label","hint","rules"]),t(B,null,{default:u(()=>[t(y,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})],64)):(s(),c("div",H,n(e.$t("No available data")),1))]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var he=$(z,[["render",R]]);export{he as default};
