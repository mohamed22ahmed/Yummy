import{_ as k,ay as C,u as S,A as s,m as Q,n,a0 as d,d as r,q as i,$ as f,F as p,a2 as b,X as _,Y as g,Z as q,p as c,at as u,ap as v,ac as D,a3 as T,as as w,ar as P,az as U}from"./index.f6661a24.js";import{Q as A}from"./QToolbarTitle.0f4dda99.js";import{Q as x}from"./QToolbar.7bb603c7.js";import{Q as B}from"./QHeader.ba9c2ff9.js";import{Q as E}from"./QInnerLoading.c6ed50f8.js";import{Q as m}from"./QSelect.4e3956e1.js";import{Q as I}from"./QDate.b5ca4044.js";import{Q as O}from"./QPopupProxy.98b4d203.js";import{Q as $}from"./QSpace.7af5fd36.js";import{Q as z}from"./QFooter.4f4f9530.js";import{Q as F}from"./QForm.4e86ee71.js";import{Q as L}from"./QPage.78315ab4.js";import{C as N}from"./ClosePopup.6296f014.js";import{u as j}from"./DriverStore.21c2c9f6.js";import{u as M}from"./CartStore.4102b575.js";import"./QResizeObserver.dc10e4c2.js";import"./QChip.5b52e54d.js";import"./QItemLabel.0d3c2221.js";import"./QMenu.c4f03f28.js";import"./selection.ef67fb9c.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";import"./use-render-cache.3aae9b27.js";import"./date.6d02ab88.js";const H={name:"CouponManage",components:{SelectCustomer:C(()=>U(()=>import("./SelectCustomer.8eeb8283.js"),["assets/SelectCustomer.8eeb8283.js","assets/QSelect.4e3956e1.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QChip.5b52e54d.js","assets/QItemLabel.0d3c2221.js","assets/QMenu.c4f03f28.js","assets/selection.ef67fb9c.js","assets/rtl.276c3f1b.js","assets/format.de7e9769.js","assets/CartStore.4102b575.js"]))},data(){return{id:"",data:[],loading:!1,voucher_name:"",voucher_type:"fixed amount",amount:0,min_order:0,days_available:[],expiration:"",transaction_type:[],used_once:"",visible:!0,status:"publish",max_number_use:""}},setup(t){const o=S(),y=j(),a=M();return{DataStore:o,DriverStore:y,CartStore:a}},created(){this.DriverStore.PromoAttributes()},mounted(){this.id=this.$route.query.id,s.empty(this.id)||this.getData()},computed:{isEdit(){return!s.empty(this.id)},hasData(){return Object.keys(this.data).length>0},CheckData(){return!s.empty(this.id)&&Object.keys(this.data).length<=0}},methods:{getData(){this.loading=!0,s.fetchDataByTokenPost("getCoupon","id="+this.id).then(t=>{this.data=t.details,this.voucher_name=t.details.voucher_name,this.voucher_type=t.details.voucher_type,this.amount=t.details.amount,this.min_order=t.details.min_order,this.expiration=t.details.expiration,this.used_once=t.details.used_once,this.visible=t.details.visible==1,this.status=t.details.status,this.days_available=t.details.days_available,this.transaction_type=t.details.transaction_type,this.max_number_use=t.details.max_number_use,this.CartStore.customer_id=t.details.selected_customer}).catch(t=>{s.notify("red-5",t,"error_outline",this.$q)}).then(t=>{this.loading=!1})},afterInput(t){this.phone=t},formSubmit(){let t={id:this.id,voucher_name:this.voucher_name,voucher_type:this.voucher_type,amount:this.amount,min_order:this.min_order,days_available:this.days_available,expiration:this.expiration,transaction_type:this.transaction_type,used_once:this.used_once,visible:this.visible,status:this.status,max_number_use:this.max_number_use,selected_customer:this.CartStore.customer_id};s.showLoadingBox("",this.$q),s.fetchDataByTokenPost(s.empty(this.id)?"AddCoupon":"UpdateCoupon",t).then(o=>{s.notify("light-green",o.msg,"check_circle",this.$q),this.$router.replace({path:"/promo/coupon-list"})}).catch(o=>{s.notify("red-5",o,"error_outline",this.$q)}).then(o=>{s.hideLoadingBox(this.$q)})}}},R={class:"row q-gutter-x-sm"},X={class:"row items-center justify-end"};function Y(t,o,y,a,l,h){const V=Q("SelectCustomer");return n(),d(p,null,[r(B,{class:f({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode})},{default:i(()=>[r(x,null,{default:i(()=>[r(b,{onClick:o[0]||(o[0]=e=>t.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:t.$q.dark.mode?"white":"dark"},null,8,["color"]),r(A,{class:"text-weight-bold"},{default:i(()=>[h.isEdit?(n(),d(p,{key:0},[_(g(t.$t("Update Coupon")),1)],64)):(n(),d(p,{key:1},[_(g(t.$t("Add Coupon")),1)],64))]),_:1})]),_:1}),r(q)]),_:1},8,["class"]),r(L,{class:f([{"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode},"q-pa-md"])},{default:i(()=>[l.loading?(n(),c(E,{key:0,showing:!0,color:"primary",size:"md"})):(n(),c(F,{key:1,onSubmit:h.formSubmit},{default:i(()=>[r(u,{modelValue:l.voucher_name,"onUpdate:modelValue":o[1]||(o[1]=e=>l.voucher_name=e),label:t.$t("Coupon name"),"stack-label":"",outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),r(m,{modelValue:l.voucher_type,"onUpdate:modelValue":o[2]||(o[2]=e=>l.voucher_type=e),options:a.DriverStore.getPromoAttributes.voucher_type,label:t.$t("Coupon Type"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("This field is required")],"emit-value":"","map-options":""},null,8,["modelValue","options","label","rules"]),v("div",R,[r(u,{modelValue:l.amount,"onUpdate:modelValue":o[3]||(o[3]=e=>l.amount=e),type:"number",step:"any",label:t.$t("Amount"),"stack-label":"",outlined:"",color:"grey-5",rules:[e=>e&&e>0||this.$t("This field is required")],class:"col"},null,8,["modelValue","label","rules"]),r(u,{modelValue:l.min_order,"onUpdate:modelValue":o[4]||(o[4]=e=>l.min_order=e),label:t.$t("Min Order"),type:"number",step:"any","stack-label":"",outlined:"",color:"grey-5",rules:[e=>e&&e>0||this.$t("This field is required")],class:"col"},null,8,["modelValue","label","rules"])]),r(m,{modelValue:l.days_available,"onUpdate:modelValue":o[5]||(o[5]=e=>l.days_available=e),options:a.DriverStore.getPromoAttributes.days,label:t.$t("Days Available"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("This field is required")],"emit-value":"","map-options":"",multiple:""},null,8,["modelValue","options","label","rules"]),r(u,{modelValue:l.expiration,"onUpdate:modelValue":o[7]||(o[7]=e=>l.expiration=e),mask:"date",rules:["date"],"stack-label":"",outlined:"",color:"grey-5",label:t.$t("Expiration"),class:"col"},{append:i(()=>[r(D,{name:"event",class:"cursor-pointer"},{default:i(()=>[r(O,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:i(()=>[r(I,{modelValue:l.expiration,"onUpdate:modelValue":o[6]||(o[6]=e=>l.expiration=e),color:"blue"},{default:i(()=>[v("div",X,[T(r(b,{label:t.$t("Close"),color:"dark",flat:"","no-caps":""},null,8,["label"]),[[N]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),r(m,{modelValue:l.transaction_type,"onUpdate:modelValue":o[8]||(o[8]=e=>l.transaction_type=e),options:a.DriverStore.getPromoAttributes.transaction_list,label:t.$t("Transaction Type"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("This field is required")],"emit-value":"","map-options":"",multiple:""},null,8,["modelValue","options","label","rules"]),r(m,{modelValue:l.used_once,"onUpdate:modelValue":o[9]||(o[9]=e=>l.used_once=e),options:a.DriverStore.getPromoAttributes.coupon_options,label:t.$t("Coupon Options"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[e=>e&&e>0||this.$t("This field is required")],"emit-value":"","map-options":""},null,8,["modelValue","options","label","rules"]),l.used_once==5?(n(),c(u,{key:0,modelValue:l.max_number_use,"onUpdate:modelValue":o[10]||(o[10]=e=>l.max_number_use=e),label:t.$t("Define max number of use"),type:"number",step:"any","stack-label":"",outlined:"",color:"grey-5"},null,8,["modelValue","label"])):l.used_once==6?(n(),d(p,{key:1},[r(V,{ref:"customer",onCreateCustomer:t.createCustomer,options_data:a.CartStore.customer_data?a.CartStore.customer_data:t.customer_data,template:2},null,8,["onCreateCustomer","options_data"]),r($,{class:"q-pa-sm"})],64)):w("",!0),r(P,{modelValue:l.visible,"onUpdate:modelValue":o[11]||(o[11]=e=>l.visible=e),color:"primary",label:t.$t("Visible")},null,8,["modelValue","label"]),r(m,{modelValue:l.status,"onUpdate:modelValue":o[12]||(o[12]=e=>l.status=e),options:a.DataStore.status_list,label:t.$t("Status"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("This field is required")],"emit-value":"","map-options":""},null,8,["modelValue","options","label","rules"]),r(z,null,{default:i(()=>[r(b,{type:"submit",color:"primary","text-color":"white",label:t.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":"",disable:h.CheckData},null,8,["label","disable"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ge=k(H,[["render",Y]]);export{ge as default};
