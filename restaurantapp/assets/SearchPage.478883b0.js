import{_ as V,ay as H,A as h,m as N,n as i,a0 as _,d as e,q as a,$ as q,F as g,a2 as b,X as m,Y as n,Z as z,ap as d,at as T,ac as x,p as f,as as w,a1 as Q,az as B,a4 as O,a5 as k,b9 as I}from"./index.f6661a24.js";import{Q as A}from"./QToolbarTitle.0f4dda99.js";import{Q as F}from"./QToolbar.7bb603c7.js";import{Q as J}from"./QHeader.ba9c2ff9.js";import{Q as y}from"./QSkeleton.e9a2b7df.js";import{Q as C}from"./QList.16ddb51a.js";import{Q as v}from"./QItemLabel.0d3c2221.js";import{Q as S}from"./QChip.5b52e54d.js";import{Q as U}from"./QBtnToggle.b6d48c98.js";import{Q as j}from"./QPageScroller.14e8a1ba.js";import{Q as L}from"./QPage.78315ab4.js";import"./QResizeObserver.dc10e4c2.js";import"./use-page-sticky.25bfa08e.js";const p="merchant_search_history",R={name:"SearchPage",components:{OrderPreview:H(()=>B(()=>import("./OrderPreview.c018e3fa.js"),["assets/OrderPreview.c018e3fa.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QToolbarTitle.0f4dda99.js","assets/QSpace.7af5fd36.js","assets/QToolbar.7bb603c7.js","assets/QImg.b7890c8b.js","assets/QItemLabel.0d3c2221.js","assets/QList.16ddb51a.js","assets/OrderStore.c0aa6efc.js","assets/PrintTemplate.1e180354.js","assets/AppBluetooth.bdfa691f.js"]))},data(){return{q:"",loading:!1,awaitingSearch:!1,data:[],status_list:[],item_details:[],order_items:[],settings_tabs:[],order_group_buttons:[],order_buttons:[],services_list:[],data_recent:[],search_history:[],limit:50,page:1}},created(){this.getSearchHistory()},watch:{q(t,s){if(!this.awaitingSearch){if(typeof this.q=="undefined"||this.q===null||this.q===""||this.q==="null"||this.q==="undefined")return!1;setTimeout(()=>{this.saveHistory();let c="q="+this.q;c+="&filter_by=all",c+="&limit="+this.limit,c+="&page="+this.page,h.fetchDataByTokenPost("OrderList",c).then(l=>{this.data=l.details.data,this.status_list=l.details.status_list,this.item_details=l.details.item_details,this.services_list=l.details.services_list,this.settings_tabs=l.details.settings_tabs,this.order_group_buttons=l.details.order_group_buttons,this.order_buttons=l.details.order_buttons}).catch(l=>{this.data=[]}).then(l=>{this.awaitingSearch=!1})},1e3)}this.awaitingSearch=!0}},computed:{hasHistory(){return Object.keys(this.data_recent).length>0},hasFilter(){return!h.empty(this.q)},hasResults(){return Object.keys(this.data).length>0}},methods:{getSearchHistory(){const t=h.getStorage(p);if(!h.empty(t)){let s=JSON.parse(t);Object.keys(s).length>0&&(this.data_recent=[],Object.entries(s).forEach(([c,l])=>{this.data_recent.push({label:l,value:l})}))}},saveHistory(){const t=h.getStorage(p);let s=[],c=0;h.empty(t)?(s.push(this.q),h.setStorage(p,JSON.stringify(s))):(s=JSON.parse(t),c=s.length,console.log(s),c>4&&s.splice(0,1),s.includes(this.q)||(s.push(this.q),h.setStorage(p,JSON.stringify(s))),this.getSearchHistory())},showPreview(t){this.order_items=t,this.$refs.order_preview.dialog=!0},afterUpdatestatus(){},removeHistory(){this.data_recent=[],h.setStorage(p,JSON.stringify(this.data_recent))}}},E={class:"q-pa-md"},D={key:0,class:"flex flex-center",style:{height:"calc(70vh)"}},$={class:"full-width text-center"},K={class:"text-weight-bold"},X={class:"text-weight-light text-grey"},Y={key:1,class:"q-pl-md q-pr-md"},Z={class:"row item-center justify-between"},G={class:"font13 text-weight-bold text-h5"},M={key:1,class:"flex flex-center",style:{height:"calc(70vh)"}},W={class:"full-width text-center"},ee={class:"text-weight-bold"},te={class:"text-weight-light text-grey"};function se(t,s,c,l,o,u){const P=N("OrderPreview");return i(),_(g,null,[e(J,{class:q({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode}),reveal:"","reveal-offset":"50"},{default:a(()=>[e(F,null,{default:a(()=>[e(b,{onClick:s[0]||(s[0]=r=>t.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:t.$q.dark.mode?"white":"dark"},null,8,["color"]),e(A,{class:"text-weight-bold"},{default:a(()=>[m(n(t.$t("Search Orders")),1)]),_:1})]),_:1}),e(z)]),_:1},8,["class"]),e(L,{class:q({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode})},{default:a(()=>[d("div",E,[e(T,{outlined:"",modelValue:o.q,"onUpdate:modelValue":s[2]||(s[2]=r=>o.q=r),label:t.$t("Search"),color:"grey-5","lazy-rules":""},{prepend:a(()=>[e(x,{name:"search"})]),append:a(()=>[u.hasFilter?(i(),f(x,{key:0,class:"cursor-pointer",name:"close",color:"grey",onClick:s[1]||(s[1]=r=>this.q="")})):w("",!0)]),_:1},8,["modelValue","label"])]),u.hasFilter&&o.awaitingSearch?(i(),f(C,{key:0},{default:a(()=>[(i(),_(g,null,Q(5,r=>e(O,{key:r},{default:a(()=>[e(k,{avatar:""},{default:a(()=>[e(y,{width:"80px",height:"80px"})]),_:1}),e(k,null,{default:a(()=>[e(y,{type:"text"}),e(y,{type:"text",class:"w-50"}),e(y,{type:"text",class:"w-70"}),e(y,{type:"text",class:"w-25"})]),_:1})]),_:2},1024)),64))]),_:1})):u.hasResults&&!o.awaitingSearch&&o.q?(i(),f(C,{key:1,separator:""},{default:a(()=>[(i(!0),_(g,null,Q(o.data,r=>(i(),f(O,{key:r,clickable:"",onClick:re=>u.showPreview(r)},{default:a(()=>[e(k,null,{default:a(()=>[e(v,{class:"text-weight-medium"},{default:a(()=>[m(n(r.order_id),1)]),_:2},1024),e(v,{caption:""},{default:a(()=>[m(n(r.description),1)]),_:2},1024),e(v,{caption:"",class:"font11"},{default:a(()=>[m(n(r.date_created),1)]),_:2},1024)]),_:2},1024),e(k,{side:""},{default:a(()=>[o.services_list[r.order_type]?(i(),f(S,{key:0,color:t.$q.dark.mode?"grey600":"mygrey","text-color":t.$q.dark.mode?"grey300":"dark",size:"sm",class:"q-ma-none"},{default:a(()=>[m(n(o.services_list[r.order_type].service_name),1)]),_:2},1032,["color","text-color"])):w("",!0),o.status_list[r.status_raw]?(i(),f(S,{key:1,size:"xs",color:"primary","text-color":"white",style:I(`color:${o.status_list[r.status_raw].font_color_hex} !important; background-color:${o.status_list[r.status_raw].background_color_hex} !important; `)},{default:a(()=>[m(n(r.status),1)]),_:2},1032,["style"])):w("",!0),e(S,{size:"xs",color:"mygrey","text-color":"dark"},{default:a(()=>[m(n(r.payment_status_name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(i(),_(g,{key:2},[u.hasFilter&&!o.awaitingSearch?(i(),_("div",D,[d("div",$,[d("div",K,n(t.$t("No order found")),1),d("div",X,n(t.$t("Sorry, we couldn't find any results")),1)])])):(i(),_("div",Y,[u.hasHistory?(i(),_(g,{key:0},[d("div",Z,[d("div",G,n(t.$t("Recently Search")),1),d("div",null,[e(b,{onClick:u.removeHistory,round:"",color:"grey",icon:"las la-times",size:"xs",flat:""},null,8,["onClick"])])]),e(U,{modelValue:o.search_history,"onUpdate:modelValue":s[3]||(s[3]=r=>o.search_history=r),"toggle-color":"secondary",color:t.$q.dark.mode?"grey600":"mygrey","text-color":t.$q.dark.mode?"grey300":"dark","no-caps":"","no-wrap":"",unelevated:"",class:"rounded-group2 text-weight-bold line-1",options:o.data_recent,onClick:s[4]||(s[4]=r=>this.q=this.search_history)},null,8,["modelValue","color","text-color","options"])],64)):(i(),_("div",M,[d("div",W,[d("div",ee,n(t.$t("Search for orders")),1),d("div",te,n(t.$t("Search by order number or customer name")),1)])]))]))],64)),e(P,{ref:"order_preview",data:o.order_items,items_details:o.item_details,settings_tabs:o.settings_tabs,order_group_buttons:o.order_group_buttons,order_buttons:o.order_buttons,onAfterUpdatestatus:u.afterUpdatestatus},null,8,["data","items_details","settings_tabs","order_group_buttons","order_buttons","onAfterUpdatestatus"]),e(j,{position:"bottom-right","scroll-offset":150,offset:[18,18]},{default:a(()=>[e(b,{fab:"",icon:"keyboard_arrow_up",color:"mygrey","text-color":"dark",dense:"",padding:"3px"})]),_:1})]),_:1},8,["class"])],64)}var ye=V(R,[["render",se]]);export{ye as default};
