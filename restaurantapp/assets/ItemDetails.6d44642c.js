import{_ as B,ay as N,az as M,u as P,A as $,m as H,n as _,p as A,q as c,d as o,b7 as L,b8 as D,$ as w,ap as u,a3 as U,a2 as x,Y as r,dn as j,a0 as m,as as C,F as f,a1 as F,X as y,a4 as G,a5 as z,a7 as X,aA as Y,a8 as J,at as R,aQ as K}from"./index.f6661a24.js";import{Q as W}from"./QImg.b7890c8b.js";import{Q as E}from"./QItemLabel.0d3c2221.js";import{Q as Z}from"./QList.16ddb51a.js";import{Q as ee}from"./QSelect.4e3956e1.js";import{Q as te}from"./QSpace.7af5fd36.js";import{C as ie}from"./ClosePopup.6296f014.js";import"./QChip.5b52e54d.js";import"./QMenu.c4f03f28.js";import"./selection.ef67fb9c.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";const Q=function(e){return typeof e=="undefined"||e===null||e===""||e==="null"||e==="undefined"},se={name:"ItemDetails",components:{NumberFormat:N(()=>M(()=>import("./NumberFormat.5c736195.js"),["assets/NumberFormat.5c736195.js","assets/index.f6661a24.js","assets/index.1593f83d.css"]))},setup(){return{DataStore:P()}},data(){return{dialog:!1,size:"",with_qty:!1,qty:1,item_qty:1,morphGroupModel:"add",item_data:[],cat_id:0,item_uuid:"",loading:!1,loading_add:!1,items:[],item_size_id:0,size_data:[],size_datas:[],cooking_ref:0,cooking_data:[],ingredients:[],ingredients_data:[],addons:{},special_instructions:"",transaction_type:"",if_sold_out:"",sold_out_options:[],item_total:0,disabled_cart:!0,slide_items:0,favorites:[],number_config:[],meta:[],items_not_available:[],category_not_available:[]}},watch:{addons:{handler(e,a){this.ItemSummary()},deep:!0},item_size_id(){this.ItemSummary()},cooking_ref(){this.ItemSummary()},ingredients(){this.ItemSummary()},item_qty(){this.ItemSummary()}},methods:{showModal(e,a){this.dialog=e,this.item_data=a},itemAvailable(e,a){return this.items_not_available.includes(e)===!1&&this.category_not_available.includes(a)===!1},resetData(){this.item_qty=1,this.items=[],this.item_size_id=0,this.size_data=[],this.size_datas=[],this.cooking_ref=0,this.cooking_data=[],this.ingredients=[],this.ingredients_data=[],this.addons={},this.special_instructions="",this.transaction_type="",this.if_sold_out="",this.sold_out_options=[],this.item_total=0,this.disabled_cart=!0,this.slide_items=0},getMenuItem(e,a){this.item_data=e,a.start(),this.resetData(),this.loading=!0,""+this.item_data.cat_id+this.item_data.item_uuid,$.fetchDataByTokenPost("getMenuItem","cat_id="+this.item_data.cat_id+"&item_uuid="+this.item_data.item_uuid).then(l=>{this.dialog=!0,this.number_config=l.details.config,this.items=l.details.data.items,this.meta=l.details.data.meta,this.size_datas=l.details.data.items.price;const k=l.details.sold_out_options;this.if_sold_out=l.details.default_sold_out_options,this.items_not_available=l.details.data.items_not_available,this.category_not_available=l.details.data.category_not_available;const i=l.details.data.items.price,g=l.details.data.meta?l.details.data.meta.cooking_ref:{},s=l.details.data.meta?l.details.data.meta_details.cooking_ref:{},t=l.details.data.meta?l.details.data.meta.ingredients:{},n=l.details.data.meta?l.details.data.meta_details.ingredients:{},p=l.details.data?l.details.data.addons:{},q=l.details.data?l.details.data.addon_items:{};Object.keys(k).length>0&&Object.entries(k).forEach(([h,d])=>{this.sold_out_options.push({label:d,value:h})}),Object.keys(i).length>0&&(Object.entries(i).forEach(([h,d])=>{d.discount<=0?this.size_data.push({label:d.size_name+" "+d.pretty_price,value:parseInt(d.item_size_id)}):this.size_data.push({label:d.size_name+" "+d.pretty_price_after_discount,value:parseInt(d.item_size_id)})}),this.item_size_id=parseInt(Object.keys(i)[0])),typeof g!="undefined"&&g!==null&&g.length>0&&Object.entries(g).forEach(([h,d])=>{this.cooking_data.push({label:s[d].meta_name,value:s[d].meta_id})}),typeof t!="undefined"&&t!==null&&t.length>0&&Object.entries(t).forEach(([h,d])=>{this.ingredients_data.push({label:n[d].meta_name,value:n[d].meta_id}),this.items.ingredients_preselected&&this.ingredients.push(n[d].meta_id)}),Object.keys(p).length>0&&Object.entries(p).forEach(([h,d])=>{const V=[];Object.entries(d).forEach(([S,b])=>{const v=[];Object.entries(b.sub_items).forEach(([Ue,O])=>{if(q[O]){const T=q[O];q[O].checked=!1,q[O].disabled=!1,q[O].qty=1,v.push(T)}});const I={subcat_id:b.subcat_id,subcategory_name:b.subcategory_name,subcategory_description:b.subcategory_description,multi_option:b.multi_option,multi_option_min:b.multi_option_min,multi_option_value:b.multi_option_value,require_addon:b.require_addon,pre_selected:b.pre_selected,sub_items_checked:"",sub_items:v};V.push(I)}),this.addons[h]=V})}).catch(l=>{console.debug(l)}).then(l=>{this.loading=!1,a.stop()})},beforeHide(){this.qty=1},ItemSummary(){let e=0;const a=[],l=[];let k=[],i=[];if(!Q(this.size_datas[this.item_size_id])){const s=this.size_datas[this.item_size_id];s.discount>0?e+=this.item_qty*parseFloat(s.price_after_discount):e+=this.item_qty*parseFloat(s.price)}Q(this.addons[this.item_size_id])||this.addons[this.item_size_id].forEach((s,t)=>{if(s.require_addon==="1"&&a.push(s.subcat_id),s.multi_option==="custom"){let h=0;const d=s.multi_option_value;let V=s.multi_option_min;d>0&&k.push({subcat_id:s.subcat_id,min:V,max:d});const S=[],b=[];s.sub_items.forEach((v,I)=>{v.checked===!0?(h++,e+=this.item_qty*parseFloat(v.price),l.push(s.subcat_id)):S.push(I),v.disabled===!0&&b.push(I)}),i[s.subcat_id]={total:h},h>=d?S.forEach((v,I)=>{s.sub_items[v].disabled=!0}):b.forEach((v,I)=>{s.sub_items[v].disabled=!1})}else if(s.multi_option==="one")s.sub_items.forEach((h,d)=>{h.sub_item_id===s.sub_items_checked&&(e+=this.item_qty*parseFloat(h.price),l.push(s.subcat_id))});else if(s.multi_option==="multiple"){var n=[];let h=s.multi_option_min;var p=s.multi_option_value,q=0;p>0&&k.push({subcat_id:s.subcat_id,min:h,max:p}),s.sub_items.forEach((d,V)=>{d.checked===!0&&(e+=d.qty*parseFloat(d.price),l.push(s.subcat_id),q+=d.qty),n.push(V)}),i[s.subcat_id]={total:q},this.addons[this.item_size_id][t].qty_selected=q,this.addons[this.item_size_id][t].qty_selected>=p?n.forEach((d,V)=>{this.addons[this.item_size_id][t].sub_items[d].disabled=!0}):n.forEach((d,V)=>{this.addons[this.item_size_id][t].sub_items[d].disabled=!1})}}),e>0&&(this.item_total=e);let g=!0;if(a.length>0&&a.forEach((s,t)=>{if(l.includes(s)===!1)return g=!1,!1}),this.items.cooking_ref_required){let s=!1;this.cooking_ref>0&&(s=!0),s||(g=!1)}if(Object.keys(k).length>0){let s,t;Object.entries(k).forEach(([n,p])=>{s=parseInt(p.min),i[p.subcat_id]&&(t=parseInt(i[p.subcat_id].total)),t>0&&s>t&&(g=!1)})}g?this.disabled_cart=!1:this.disabled_cart=!0},AddToCart(){const e=[];this.ingredients.length>0&&this.ingredients.forEach((i,g)=>{e.push({meta_id:i,checked:!0,meta_name:""})});const a={cooking_ref:[{meta_id:this.cooking_ref,checked:this.cooking_ref,meta_name:""}],ingredients:e},l=this.DataStore.cart_uuid,k={cart_uuid:l,cat_id:this.item_data.cat_id,item_size_id:this.item_size_id,item_token:this.item_data.item_uuid,item_qty:this.item_qty,special_instructions:this.special_instructions,if_sold_out:this.if_sold_out.value,transaction_type:this.DataStore.cart_transaction_type,meta:a,item_addons:Q(this.addons[this.item_size_id])?[]:this.addons[this.item_size_id]};this.loading_add=!0,$.fetchDataByTokenPost("addCartItems",k).then(i=>{Q(l)&&(this.DataStore.cart_uuid=i.details.cart_uuid),this.dialog=!1,this.$emit("afterAddtocart")}).catch(i=>{$.notify("red-5",i,"error_outline",this.$q)}).then(i=>{this.loading_add=!1})}}},oe={class:"q-pa-sm absolute-top-right"},ae={class:"text-weight-medium font17 line-normal ellipsis"},le={class:"ellipsis-3-lines text-grey font12"},de=["innerHTML"],ne={class:"text-weight-medium font15 line-normal"},re={class:"flex justify-between"},_e={class:"text-weight-medium font15 line-normal"},ue={class:"text-grey font12"},me={key:0,class:"bg-yellow-11 text-dark q-pa-xs rounded-borders"},ce={key:1},pe={class:"flex justify-between"},he={class:"text-weight-medium font15 line-normal"},fe={class:"flex justify-between"},ge={class:"text-weight-medium font15 line-normal"},ye={class:"text-grey font12"},be={key:0,class:"bg-yellow-11 text-dark q-pa-xs rounded-borders"},ke={key:2,class:"bg-yellow-11 text-dark q-pa-xs rounded-borders"},ve={key:2,class:"bg-yellow-11 text-dark q-pa-xs rounded-borders"},qe={key:0,class:"row items-center justify-center"},ze={class:"col no-padding text-center"},Ve={class:"col no-padding text-center"},we={class:"col no-padding text-center"},xe={key:1},Ce={class:"text-weight-medium font15 line-normal"},Ie={class:"text-weight-medium font15 line-normal"},Ee={key:2,class:"row items-center"},Oe={class:"col-4"},Qe={class:"text-weight-medium"},Se={class:"text-weight-bold text-primary"},$e={class:"col input-center row items-center q-col-gutter-sm"},je={class:"col-7"},Ae={class:"col"};function De(e,a,l,k,i,g){const s=H("NumberFormat");return _(),A(K,{modelValue:i.dialog,"onUpdate:modelValue":a[9]||(a[9]=t=>i.dialog=t),position:"bottom",onBeforeHide:g.beforeHide},{default:c(()=>[o(L,null,{default:c(()=>[o(D,{class:w(["no-wrap q-pa-none bg-mygreyx relative-position",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{"border-bottom-right-radius":"25px","border-bottom-left-radius":"25px"}},{default:c(()=>[o(W,{src:i.items.url_image,"placeholder-src":"placeholder.png",style:{height:"150px"},fit:"cover","spinner-color":"primary","spinner-size":"xs"},null,8,["src"]),u("div",oe,[U(o(x,{icon:"close",color:"grey",flat:"",round:"",dense:""},null,512),[[ie]])])]),_:1},8,["class"]),o(D,null,{default:c(()=>[u("div",ae,r(i.items.item_name),1),u("p",le,[u("span",{innerHTML:i.items.item_description},null,8,de)]),u("div",{class:w(["bg-mygreyx q-pa-sm radius10 q-mb-md",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[u("div",ne,r(e.$t("Customize your Order")),1),o(j,{modelValue:i.item_size_id,"onUpdate:modelValue":a[0]||(a[0]=t=>i.item_size_id=t),options:i.size_data,inline:"",size:"xs"},null,8,["modelValue","options"])],2),i.cooking_data.length>0?(_(),m("div",{key:0,class:w(["bg-mygreyx q-pa-sm radius10 q-mb-md",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[u("div",re,[u("div",_e,r(e.$t("Cooking Reference")),1),u("div",ue,[i.items.cooking_ref_required?(_(),m("span",me,r(e.$t("Required")),1)):(_(),m("span",ce,"("+r(e.$t("Optional"))+")",1))])]),o(j,{modelValue:i.cooking_ref,"onUpdate:modelValue":a[1]||(a[1]=t=>i.cooking_ref=t),options:i.cooking_data,inline:"",size:"xs"},null,8,["modelValue","options"])],2)):C("",!0),i.ingredients_data.length>0?(_(),m("div",{key:1,class:w(["bg-mygreyx q-pa-sm radius10 q-mb-md",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[u("div",pe,[u("div",null,[u("div",he,r(e.$t("Ingredients")),1)])]),o(j,{modelValue:i.ingredients,"onUpdate:modelValue":a[2]||(a[2]=t=>i.ingredients=t),options:i.ingredients_data,inline:"",type:"checkbox",size:"xs","checked-icon":"check_box","unchecked-icon":"square"},null,8,["modelValue","options"])],2)):C("",!0),i.addons[i.item_size_id]?(_(!0),m(f,{key:2},F(i.addons[i.item_size_id],t=>(_(),m("div",{key:t.subcat_id,class:w(["bg-mygreyx q-pa-sm radius10 q-mb-md",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[u("div",fe,[u("div",ge,r(t.subcategory_name),1),u("div",ye,[t.multi_option==="one"?(_(),m(f,{key:0},[y(r(e.$t("Select 1"))+" ",1),t.require_addon==1?(_(),m("span",be,r(e.$t("Required")),1)):C("",!0)],64)):t.multi_option==="multiple"?(_(),m(f,{key:1},[t.multi_option_min>0?(_(),m(f,{key:0},[y(r(e.$t("Select minimum {min} to maximum {max}",{min:t.multi_option_min,max:t.multi_option_value})),1)],64)):(_(),m(f,{key:1},[y(r(e.$t("Choose up to"))+" "+r(t.multi_option_value),1)],64)),t.require_addon==1?(_(),m("span",ke,r(e.$t("Required")),1)):C("",!0)],64)):t.multi_option==="custom"?(_(),m(f,{key:2},[t.multi_option_min>0?(_(),m(f,{key:0},[y(r(e.$t("Select minimum {min} to maximum {max}",{min:t.multi_option_min,max:t.multi_option_value})),1)],64)):(_(),m(f,{key:1},[y(r(e.$t("Choose up to"))+" "+r(t.multi_option_value),1)],64)),t.require_addon==1?(_(),m("span",ve,r(e.$t("Required")),1)):C("",!0)],64)):(_(),m(f,{key:3},[y(" ("+r(e.$t("Optional"))+") ",1)],64))])]),o(Z,null,{default:c(()=>[(_(!0),m(f,null,F(t.sub_items,n=>U((_(),A(G,{key:n.sub_item_id,tag:t.multi_option==="multiple"?"div":"label"},{default:c(()=>[t.multi_option==="one"?(_(),m(f,{key:0},[o(z,{avatar:""},{default:c(()=>[o(X,{modelValue:t.sub_items_checked,"onUpdate:modelValue":p=>t.sub_items_checked=p,val:n.sub_item_id,color:"primary",size:"sm"},null,8,["modelValue","onUpdate:modelValue","val"])]),_:2},1024),o(z,null,{default:c(()=>[o(E,null,{default:c(()=>[y(r(n.sub_item_name),1)]),_:2},1024)]),_:2},1024),o(z,{side:""},{default:c(()=>[o(E,{caption:""},{default:c(()=>[y(r(n.pretty_price),1)]),_:2},1024)]),_:2},1024)],64)):t.multi_option==="custom"?(_(),m(f,{key:1},[o(z,{avatar:""},{default:c(()=>[o(Y,{modelValue:n.checked,"onUpdate:modelValue":p=>n.checked=p,val:n.sub_item_id,label:"",disable:n.disabled,color:"primary",size:"sm"},null,8,["modelValue","onUpdate:modelValue","val","disable"])]),_:2},1024),o(z,null,{default:c(()=>[o(E,null,{default:c(()=>[y(r(n.sub_item_name),1)]),_:2},1024)]),_:2},1024),o(z,{side:""},{default:c(()=>[o(E,{caption:""},{default:c(()=>[y(r(n.pretty_price),1)]),_:2},1024)]),_:2},1024)],64)):t.multi_option==="multiple"?(_(),m(f,{key:2},[o(z,{side:!n.checked},{default:c(()=>[n.checked==!0?(_(),m("div",qe,[u("div",ze,[o(x,{onClick:p=>n.qty>1?n.qty--:n.checked=!1,round:"",unelevated:"",dense:"",size:"11px",color:"darkgreen",icon:"remove"},null,8,["onClick"])]),u("div",Ve,r(n.qty),1),u("div",we,[o(x,{onClick:p=>n.qty++,round:"",unelevated:"",dense:"",size:"11px",color:"darkgreen",icon:"add",disabled:n.disabled},null,8,["onClick","disabled"])])])):(_(),m("div",xe,[o(x,{onClick:p=>n.checked=!0,round:"",unelevated:"",dense:"",size:"11px",color:"grey-4",icon:"add",disabled:n.disabled},null,8,["onClick","disabled"])]))]),_:2},1032,["side"]),o(z,null,{default:c(()=>[o(E,null,{default:c(()=>[y(r(n.sub_item_name),1)]),_:2},1024)]),_:2},1024),o(z,{side:""},{default:c(()=>[o(E,{caption:""},{default:c(()=>[y(r(n.pretty_price),1)]),_:2},1024)]),_:2},1024)],64)):C("",!0)]),_:2},1032,["tag"])),[[J]])),128))]),_:2},1024)],2))),128)):C("",!0),u("div",{class:w(["bg-mygreyx q-pa-sm radius10 q-mb-md",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[u("div",Ce,r(e.$t("Special Instructions")),1),o(R,{modelValue:i.special_instructions,"onUpdate:modelValue":a[3]||(a[3]=t=>i.special_instructions=t),autogrow:"",class:"q-mb-md full-width"},null,8,["modelValue"]),u("div",Ie,r(e.$t("If sold out")),1),o(ee,{dense:"",modelValue:i.if_sold_out,"onUpdate:modelValue":a[4]||(a[4]=t=>i.if_sold_out=t),options:i.sold_out_options,class:"q-mb-md","transition-show":"scale","transition-hide":"scale"},null,8,["modelValue","options"])],2),o(te,{class:"q-pa-xl"})]),_:1})]),_:1}),u("div",{class:w(["fixed-bottom q-pa-md relative-position",{"bg-grey600 ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},[!i.loading&&i.items.not_for_sale?(_(),m(f,{key:0},[y(r(e.$t("Not for sale")),1)],64)):g.itemAvailable(i.items.item_id,i.items.cat_id)?(_(),m("div",Ee,[u("div",Oe,[u("div",Qe,r(e.$t("Total Price")),1),u("div",Se,[o(s,{amount:i.item_total},null,8,["amount"])])]),u("div",$e,[u("div",je,[o(R,{modelValue:i.item_qty,"onUpdate:modelValue":a[7]||(a[7]=t=>i.item_qty=t),outlined:"",color:"green-5","bg-color":"green-5",maxlength:"14",dense:"",class:"input-to-white radius28",style:{overflow:"hidden"}},{prepend:c(()=>[o(x,{color:"green","text-color":"white",icon:"remove",unelevated:"",dense:"",size:"sm",onClick:a[5]||(a[5]=t=>i.item_qty>1?i.item_qty--:1)})]),append:c(()=>[o(x,{color:"green","text-color":"white",icon:"add",unelevated:"",dense:"",size:"sm",onClick:a[6]||(a[6]=t=>i.item_qty++)})]),_:1},8,["modelValue"])]),u("div",Ae,[o(x,{unelevated:"",color:"green",label:e.$t("Add"),class:"radius28 q-pl-lg q-pr-lg q-pt-sm q-pb-sm","no-caps":"",onClick:a[8]||(a[8]=t=>g.AddToCart()),loading:i.loading_add,disable:i.disabled_cart},null,8,["label","loading","disable"])])])])):(_(),m(f,{key:1},[y(r(e.$t("Not available")),1)],64))],2)]),_:1},8,["modelValue","onBeforeHide"])}var Je=B(se,[["render",De]]);export{Je as default};
