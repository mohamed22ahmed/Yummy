import{l as s}from"./index.4f152a18.js";import{_ as i,u as r,aq as a,A as n,n as h,a0 as o}from"./index.f6661a24.js";const d={name:"ComponentsRealtime",props:["getevent"],setup(){return{DataStore:r()}},data(){return{data:[],pusher:void 0,channel:void 0}},watch:{DataStore:{immediate:!0,deep:!0,handler(e,t){Object.keys(e.realtime_data).length>0&&a.authenticated()&&(this.data=e.realtime_data,this.data.realtime_app_enabled==1&&this.initProvider())}}},methods:{initProvider(){switch(this.data.realtime_provider){case"pusher":s("https://js.pusher.com/7.0/pusher.min.js").then(()=>{this.initPusher()}).catch(()=>{console.debug("failed loading realtime script")});break}},initPusher(){if(n.empty(this.pusher)){Pusher.logToConsole=!1,this.pusher=new Pusher(this.data.pusher_key,{cluster:this.data.pusher_cluster});const e=a.getUser();this.channel=this.pusher.subscribe(e.merchant_uuid),this.channel.bind(this.data.event[this.getevent],t=>{this.$emit("afterReceive",t)})}}}},u={style:{display:"none"}};function c(e,t,p,l,m,_){return h(),o("div",u)}var b=i(d,[["render",c]]);export{b as default};
