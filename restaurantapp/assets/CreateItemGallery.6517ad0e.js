import{_ as y,ay as k,A as r,m as b,n as o,a0 as f,d as a,q as l,$ as m,F as q,a2 as u,X as Q,Y as p,Z as $,p as i,ap as n,ac as w,as as P,az as v}from"./index.f6661a24.js";import{Q as C}from"./QToolbarTitle.0f4dda99.js";import{Q as A}from"./QToolbar.7bb603c7.js";import{Q as D}from"./QHeader.ba9c2ff9.js";import{Q as I}from"./QInnerLoading.c6ed50f8.js";import{Q as _}from"./QImg.b7890c8b.js";import{Q as F}from"./QFooter.4f4f9530.js";import{Q as B}from"./QForm.4e86ee71.js";import{Q as S}from"./QPage.78315ab4.js";import{A as c}from"./AppCamera.4fe7ee93.js";import"./QResizeObserver.dc10e4c2.js";const U={name:"CreateItemGallery",data(){return{loading:!1,loading_get:!1,upload_enabled:!1,featured_filename:"",featured_url:"",upload_path:"",photo_data:""}},components:{UploaderFile:k(()=>v(()=>import("./UploaderFile.36c0f73c.js"),["assets/UploaderFile.36c0f73c.js","assets/QUploader.d12c38b5.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QCircularProgress.24399868.js","assets/format.de7e9769.js"]))},created(){this.item_uuid=this.$route.query.item_uuid},computed:{hasPhoto(){return!r.empty(this.featured_filename)},hasData(){return Object.keys(this.photo_data).length>0}},methods:{takePhoto(){this.$q.capacitor?c.isCameraEnabled().then(e=>{c.isFileAccessEnabled().then(s=>{c.getPhoto(1).then(h=>{this.photo_data=h}).catch(h=>{this.photo_data=[]})}).catch(s=>{r.notify("dark",s,"error",this.$q)})}).catch(e=>{r.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},onSubmit(){this.loading=!0,r.fetchDataByToken("createGallery",{item_uuid:this.item_uuid,featured_filename:this.featured_filename,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""}).then(e=>{r.notify("light-green",e.msg,"check_circle",this.$q),this.$router.replace({path:"/item/gallery",query:{item_uuid:this.item_uuid}})}).catch(e=>{r.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})},afterUploadfile(e){this.featured_filename=e.filename,this.featured_url=e.url_image,this.upload_path=e.upload_path},hadData(){return Object.keys(this.photo_data).length>0}}},x={class:"q-pa-md q-gutter-md"},z={class:"row q-gutter-sm"},G={key:2,class:"col-3 row items-center justify-center bg-mygrey radius8",style:{height:"70px"}},T={class:"col"},E={class:"font12 line-normal"};function N(e,s,h,V,d,t){const g=b("UploaderFile");return o(),f(q,null,[a(D,{class:m({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:l(()=>[a(A,null,{default:l(()=>[a(u,{onClick:s[0]||(s[0]=j=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(C,{class:"text-weight-bold"},{default:l(()=>[Q(p(e.$t("Item Gallery")),1)]),_:1})]),_:1}),a($)]),_:1},8,["class"]),a(S,{class:m({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:l(()=>[d.loading_get?(o(),i(I,{key:0,showing:!0,color:"primary",size:"md"})):(o(),i(B,{key:1,onSubmit:t.onSubmit},{default:l(()=>[n("div",x,[n("div",z,[t.hasData?(o(),i(_,{key:0,src:d.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):t.hasPhoto?(o(),i(_,{key:1,src:this.featured_url,"spinner-color":"white",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(o(),f("div",G,[a(w,{name:"las la-image",class:"text-grey",size:"xl"})])),n("div",T,[n("div",E,p(e.$t("Items with quality photos are often more popular. Maximum 2 MB"))+". "+p(e.$t("Accepted types: PNG. JPG")),1),a(u,{label:t.hasPhoto?this.$t("Change Photo"):t.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:t.takePhoto},null,8,["label","onClick"])]),d.upload_enabled?(o(),i(g,{key:3,ref:"uploader_file",onAfterUploadfile:t.afterUploadfile},null,8,["onAfterUploadfile"])):P("",!0)])]),a(F,{class:m(["q-pl-md q-pr-md q-pb-xs",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:l(()=>[a(u,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":"",loading:d.loading},null,8,["label","loading"])]),_:1},8,["class"])]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ee=y(U,[["render",N]]);export{ee as default};
