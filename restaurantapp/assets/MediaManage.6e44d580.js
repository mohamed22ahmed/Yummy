import{_ as q,ay as v,u as Q,A as e,m as $,n as s,a0 as d,d as a,q as i,$ as c,F as h,a2 as u,X as y,Y as n,Z as P,p,ap as f,ac as D,as as A,az as w}from"./index.f6661a24.js";import{Q as z}from"./QToolbarTitle.0f4dda99.js";import{Q as C}from"./QToolbar.7bb603c7.js";import{Q as S}from"./QHeader.ba9c2ff9.js";import{Q as B}from"./QInnerLoading.c6ed50f8.js";import{Q as _}from"./QImg.b7890c8b.js";import{Q as k}from"./QSpace.7af5fd36.js";import{Q as M}from"./QFooter.4f4f9530.js";import{Q as U}from"./QForm.4e86ee71.js";import{Q as F}from"./QPage.78315ab4.js";import{A as g}from"./AppCamera.4fe7ee93.js";import{u as E}from"./DriverStore.21c2c9f6.js";import"./QResizeObserver.dc10e4c2.js";const I={name:"CarManage",components:{UploaderFile:v(()=>w(()=>import("./UploaderFile.36c0f73c.js"),["assets/UploaderFile.36c0f73c.js","assets/QUploader.d12c38b5.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QCircularProgress.24399868.js","assets/format.de7e9769.js"]))},data(){return{id:"",data:[],loading:!1,upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:"",title:"",size:""}},setup(t){const o=Q(),l=E();return{DataStore:o,DriverStore:l}},created(){this.DriverStore.VehicleAttributes()},mounted(){this.id=this.$route.query.id,e.empty(this.id)||this.getData()},computed:{isEdit(){return!e.empty(this.id)},hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!e.empty(this.photo)}},methods:{getData(){this.loading=!0,e.fetchDataByTokenPost("getMedia","id="+this.id).then(t=>{this.avatar=t.details.avatar,this.photo=t.details.photo,this.upload_path=t.details.upload_path,this.title=t.details.title,this.size=t.details.size}).catch(t=>{e.notify("red-5",t,"error_outline",this.$q)}).then(t=>{this.loading=!1})},afterInput(t){this.phone=t},formSubmit(){let t={id:this.id,photo:this.photo,upload_path:this.upload_path,title:this.title,size:this.size,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""};e.showLoadingBox("",this.$q),e.fetchDataByTokenPost(e.empty(this.id)?"AddMedia":"UpdateMedia",t).then(o=>{e.notify("light-green",o.msg,"check_circle",this.$q),this.$router.replace({path:"/images/media_library"})}).catch(o=>{e.notify("red-5",o,"error_outline",this.$q)}).then(o=>{e.hideLoadingBox(this.$q)})},afterUploadfile(t){this.photo=t.filename,this.avatar=t.url_image,this.upload_path=t.upload_path,this.title=t.title,this.size=t.size},takePhoto(){this.$q.capacitor?g.isCameraEnabled().then(t=>{g.isFileAccessEnabled().then(o=>{g.getPhoto(1).then(l=>{this.photo_data=l}).catch(l=>{this.photo_data=[]})}).catch(o=>{e.notify("dark",o,"error",this.$q)})}).catch(t=>{e.notify("dark",t,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0}}},T={class:"row q-gutter-sm"},x={class:"col"},V={class:"font12 line-normal"};function N(t,o,l,j,m,r){const b=$("UploaderFile");return s(),d(h,null,[a(S,{class:c({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode})},{default:i(()=>[a(C,null,{default:i(()=>[a(u,{onClick:o[0]||(o[0]=L=>t.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:t.$q.dark.mode?"white":"dark"},null,8,["color"]),a(z,{class:"text-weight-bold"},{default:i(()=>[r.isEdit?(s(),d(h,{key:0},[y(n(t.$t("Update Media")),1)],64)):(s(),d(h,{key:1},[y(n(t.$t("Add Media")),1)],64))]),_:1})]),_:1}),a(P)]),_:1},8,["class"]),a(F,{class:c([{"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode},"q-pa-md"])},{default:i(()=>[m.loading?(s(),p(B,{key:0,showing:!0,color:"primary",size:"md"})):(s(),p(U,{key:1,onSubmit:r.formSubmit},{default:i(()=>[f("div",T,[r.hasPhotodata?(s(),p(_,{key:0,src:m.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):r.hasPhoto?(s(),p(_,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),d("div",{key:2,class:c(["col-3 row items-center justify-center radius8",{"bg-grey600 ":t.$q.dark.mode,"bg-mygrey ":!t.$q.dark.mode}]),style:{height:"70px"}},[a(D,{name:"las la-image",class:"text-grey",size:"xl"})],2)),f("div",x,[f("div",V,n(t.$t("Gallery Image. Maximum 2 MB"))+". "+n(t.$t("Accepted types: PNG. JPG")),1),a(u,{label:r.hasPhoto?this.$t("Change Photo"):r.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:r.takePhoto},null,8,["label","onClick"])])]),m.upload_enabled?(s(),d(h,{key:0},[a(k,{class:"q-pa-sm"}),a(b,{ref:"uploader_file",onAfterUploadfile:r.afterUploadfile},null,8,["onAfterUploadfile"])],64)):A("",!0),a(k,{class:"q-pa-sm"}),a(M,null,{default:i(()=>[a(u,{type:"submit",color:"primary","text-color":"white",label:t.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ot=q(I,[["render",N]]);export{ot as default};
