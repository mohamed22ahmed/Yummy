import{Q as _}from"./QToolbarTitle.0f4dda99.js";import{Q as y}from"./QSpace.7af5fd36.js";import{_ as Q,u as x,A as r,n as i,p as n,q as l,d as s,b7 as S,$ as k,X as w,Y as d,a2 as f,b8 as P,a0 as u,F as c,dc as V,a1 as B,ap as m,as as b,at as C,aQ as q}from"./index.f6661a24.js";import{Q as v}from"./QToolbar.7bb603c7.js";import{Q as p}from"./QSkeleton.e9a2b7df.js";import{Q as D}from"./QLinearProgress.0a813588.js";import{Q as T}from"./QTab.ac26d4d4.js";import{Q as A}from"./QTabs.dbf6b89c.js";import{Q as z}from"./QForm.4e86ee71.js";import{u as E}from"./CartStore.4102b575.js";import"./QResizeObserver.dc10e4c2.js";import"./rtl.276c3f1b.js";const N={name:"PointsModal",data(){return{loading:!1,loading2:!1,dialog:!1,points:0,points_tab:0,data_points:[],balance:0,points_id:0}},setup(){const t=E(),a=x();return{CartStore:t,DataStore:a}},methods:{beforeShow(){this.points=0,this.CartStore.pos_attributes.use_thresholds&&this.getPointsthresholds()},setPoints(){console.log(this.points_tab),this.points=this.points_tab.points,this.points_id=this.points_tab.id},onSubmit(){this.loading=!0,r.fetchDataByTokenPost("applyPoints","points="+this.points+"&cart_uuid="+this.DataStore.cart_uuid+"&customer_id="+this.CartStore.customer_id+"&points_id="+this.points_id).then(t=>{this.dialog=!1,r.notify("light-green",t.msg,"check_circle",this.$q),this.$emit("afterApplypoints")}).catch(t=>{r.notify("red-5",t,"error_outline",this.$q)}).then(t=>{this.loading=!1})},getPointsthresholds(){this.loading2=!0,r.fetchDataByTokenPost("getPointsthresholds","customer_id="+this.CartStore.customer_id).then(t=>{this.data_points=t.details.data,this.balance=t.details.balance}).catch(t=>{r.notify("red-5",t,"error_outline",this.$q)}).then(t=>{this.loading2=!1})}}},U={class:"text-caption"},F={class:"text-subtitle2 q-mb-sm"},M={key:0,class:"absolute-full flex flex-center"},I={class:"text-white font12 text-weight-bold"};function L(t,a,R,g,o,h){return i(),n(q,{modelValue:o.dialog,"onUpdate:modelValue":a[3]||(a[3]=e=>o.dialog=e),position:"bottom",class:"rounded-borders-top",onBeforeShow:h.beforeShow},{default:l(()=>[s(S,null,{default:l(()=>[s(v,{class:"text-primary top-toolbar q-pl-md",dense:""},{default:l(()=>[s(_,{class:k(["text-darkx text-weight-bold",{"text-white":t.$q.dark.mode,"text-dark":!t.$q.dark.mode}]),style:{overflow:"inherit"}},{default:l(()=>[w(d(t.$t("Apply Points discount")),1)]),_:1},8,["class"]),s(y),s(f,{onClick:a[0]||(a[0]=e=>o.dialog=!1),color:"white",square:"",unelevated:"","text-color":"grey",icon:"las la-times",dense:"","no-caps":"",size:"sm",class:"border-grey radius8"})]),_:1}),s(P,null,{default:l(()=>[s(z,{onSubmit:h.onSubmit},{default:l(()=>[g.CartStore.pos_attributes.use_thresholds?(i(),u(c,{key:0},[o.loading2?(i(),u(c,{key:0},[s(V,{class:"q-gutter-md flex flex-center"},{default:l(()=>[s(p,{type:"QBtn",style:{height:"80px"}}),s(p,{type:"QBtn",style:{height:"80px"}}),s(p,{type:"QBtn",style:{height:"80px"}})]),_:1}),s(p,{type:"QBtn",class:"full-width",style:{height:"50px"}})],64)):(i(),n(A,{key:1,modelValue:o.points_tab,"onUpdate:modelValue":[a[1]||(a[1]=e=>o.points_tab=e),h.setPoints],class:"text-dark q-mb-lg","no-caps":"","active-color":"white","active-bg-color":"blue","indicator-color":"blue"},{default:l(()=>[(i(!0),u(c,null,B(o.data_points,e=>(i(),n(T,{key:e,name:e,disable:!(o.balance>e.points)},{default:l(()=>[m("div",U,d(e.label),1),m("div",F,d(e.amount),1),s(D,{size:"18px",value:o.balance/e.points,style:{"min-width":"80px"},class:"radius28",color:o.balance>=e.points?"green":"blue"},{default:l(()=>[o.balance>=e.points?(i(),u("div",M,[m("span",I,d(t.$t("REDEEM")),1)])):b("",!0)]),_:2},1032,["value","color"])]),_:2},1032,["name","disable"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"]))],64)):(i(),n(C,{key:1,modelValue:o.points,"onUpdate:modelValue":a[2]||(a[2]=e=>o.points=e),outlined:"",color:"grey-5",rules:[e=>e&&e.length>0||this.$t("Please enter numbers")],type:"number",step:"any"},null,8,["modelValue","rules"])),o.loading2?b("",!0):(i(),n(f,{key:2,type:"submit",color:"primary","text-color":"white",label:t.$t("Apply"),unelevated:"",class:"full-width",size:"lg","no-caps":"",disable:!(o.points>0),loading:o.loading},null,8,["label","disable","loading"]))]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue","onBeforeShow"])}var et=Q(N,[["render",L]]);export{et as default};
