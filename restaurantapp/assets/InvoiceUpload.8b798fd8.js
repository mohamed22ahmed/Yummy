import{_ as v,ay as q,A as o,m as P,n as d,p as m,q as h,d as a,a2 as c,X as u,Y as i,Z as Q,$ as f,a0 as y,ap as l,ac as $,as as A,at as _,F as w,az as V}from"./index.f6661a24.js";import{Q as U}from"./QToolbarTitle.0f4dda99.js";import{Q as C}from"./QToolbar.7bb603c7.js";import{Q as D}from"./QHeader.ba9c2ff9.js";import{Q as T}from"./QInnerLoading.c6ed50f8.js";import{Q as g}from"./QImg.b7890c8b.js";import{Q as B}from"./QSpace.7af5fd36.js";import{Q as I}from"./QFooter.4f4f9530.js";import{Q as F}from"./QForm.4e86ee71.js";import{Q as S}from"./QPage.78315ab4.js";import{Q as N}from"./QPullToRefresh.a19885b1.js";import{A as b}from"./AppCamera.4fe7ee93.js";import"./QResizeObserver.dc10e4c2.js";import"./TouchPan.ca911d69.js";import"./touch.9135741d.js";import"./selection.ef67fb9c.js";import"./format.de7e9769.js";const z={name:"InvoiceActivity",components:{UploaderFile:q(()=>V(()=>import("./UploaderFile.36c0f73c.js"),["assets/UploaderFile.36c0f73c.js","assets/QUploader.d12c38b5.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QCircularProgress.24399868.js","assets/format.de7e9769.js"]))},data(){return{id:null,loading:!1,data:[],account_name:"",amount:0,reference_number:"",is_refresh:void 0,upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:""}},mounted(){this.id=this.$route.query.id,o.empty(this.id)||this.getData()},computed:{hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!o.empty(this.photo)}},methods:{formSubmit(){o.showLoadingBox("",this.$q),o.fetchDataByTokenPost("invoiceProofpayment",{id:this.id,account_name:this.account_name,amount:this.amount,reference_number:this.reference_number,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""}).then(e=>{o.notify("light-green",e.msg,"check_circle",this.$q),this.$router.replace({path:"/invoice/list"})}).catch(e=>{o.notify("red-5",e,"error_outline",this.$q)}).then(e=>{o.hideLoadingBox(this.$q)})},refresh(e){this.is_refresh=e,this.getData()},getData(){o.empty(this.is_refresh)&&(this.loading=!0),o.fetchDataByTokenPost("getInvoice","id="+this.id).then(e=>{this.data=e.details,this.account_name=e.details.account_name,this.amount=e.details.amount,this.reference_number=e.details.reference_number,this.photo=e.details.photo,this.upload_path=e.details.upload_path,this.avatar=e.details.avatar}).catch(e=>{o.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.loading=!1,o.empty(this.is_refresh)||this.is_refresh()})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},takePhoto(){this.$q.capacitor?b.isCameraEnabled().then(e=>{b.isFileAccessEnabled().then(s=>{b.getPhoto(1).then(p=>{this.photo_data=p}).catch(p=>{this.photo_data=[]})}).catch(s=>{o.notify("dark",s,"error",this.$q)})}).catch(e=>{o.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0}}},E={class:"text-subtitle1 q-mb-sm"},R={class:"text-caption"},j={class:"text-caption"},L={class:"q-pt-sm q-pb-sm"},O={class:"text-subtitle2"},x={class:"text-subtitle2"},G={class:"row q-gutter-sm"},M={class:"col"},H={class:"font12 line-normal"},J=l("br",null,null,-1),X=l("br",null,null,-1);function Y(e,s,p,Z,r,n){const k=P("UploaderFile");return d(),m(N,{onRefresh:n.refresh},{default:h(()=>[a(D,{class:f({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:h(()=>[a(C,null,{default:h(()=>[a(c,{onClick:s[0]||(s[0]=t=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(U,{class:"text-weight-bold"},{default:h(()=>[u(i(e.$t("Upload deposit")),1)]),_:1})]),_:1}),a(Q)]),_:1},8,["class"]),a(S,{class:f([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode},"q-pa-md"])},{default:h(()=>[r.loading?(d(),m(T,{key:0,showing:!0,color:"primary",size:"md"})):(d(),y(w,{key:1},[l("div",E,i(e.$t("Upload Proof of Payment")),1),l("div",R,i(e.$t("Please enter the details of your bank deposit payment below")),1),l("div",j,i(e.$t("Failure to provide accurate information may cause delays in processing or invalidation of your payment"))+". ",1),l("div",L,[l("div",O,i(e.$t("Invoice No#"))+": "+i(r.data.invoice_number),1),l("div",x,i(e.$t("Amount"))+": "+i(r.data.total),1)]),a(F,{onSubmit:n.formSubmit},{default:h(()=>[l("div",G,[n.hasPhotodata?(d(),m(g,{key:0,src:r.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):n.hasPhoto?(d(),m(g,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(d(),y("div",{key:2,class:f(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[a($,{name:"las la-image",class:"text-grey",size:"xl"})],2)),l("div",M,[l("div",H,[u(i(e.$t("Proof of payment"))+".",1),J,u(" "+i(e.$t("Maximum 2 MB")),1),X,u(" "+i(e.$t("Accepted types: PNG. JPG")),1)]),a(c,{label:n.hasPhoto?this.$t("Change Photo"):n.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:n.takePhoto},null,8,["label","onClick"])])]),r.upload_enabled?(d(),m(k,{key:0,ref:"uploader_file",onAfterUploadfile:n.afterUploadfile},null,8,["onAfterUploadfile"])):A("",!0),a(B,{class:"q-pa-sm"}),a(_,{modelValue:r.account_name,"onUpdate:modelValue":s[1]||(s[1]=t=>r.account_name=t),label:e.$t("Account name"),"stack-label":"",outlined:"",color:"grey-5",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(_,{modelValue:r.amount,"onUpdate:modelValue":s[2]||(s[2]=t=>r.amount=t),type:"number",step:"any",label:e.$t("Amount"),"stack-label":"",outlined:"",color:"grey-5",rules:[t=>t&&t>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(_,{modelValue:r.reference_number,"onUpdate:modelValue":s[3]||(s[3]=t=>r.reference_number=t),label:e.$t("Reference Number"),"stack-label":"",outlined:"",color:"grey-5",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(I,null,{default:h(()=>[a(c,{type:"submit",color:"primary","text-color":"white",label:e.$t("Submit"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})]),_:1},8,["onSubmit"])],64))]),_:1},8,["class"])]),_:1},8,["onRefresh"])}var fe=v(z,[["render",Y]]);export{fe as default};
