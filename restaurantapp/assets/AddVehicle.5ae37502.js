import{_ as D,ay as A,A as r,m as C,n as s,a0 as n,d as a,q as p,$ as b,F as c,a2 as y,X as f,Y as h,as as v,Z as S,p as _,ap as u,ac as w,at as g,az as U}from"./index.f6661a24.js";import{Q as $}from"./QToolbarTitle.0f4dda99.js";import{Q as T}from"./QToolbar.7bb603c7.js";import{Q as B}from"./QHeader.ba9c2ff9.js";import{Q as F}from"./QInnerLoading.c6ed50f8.js";import{Q as V}from"./QImg.b7890c8b.js";import{Q as q}from"./QSpace.7af5fd36.js";import{Q as P}from"./QSelect.4e3956e1.js";import{Q as I}from"./QFooter.4f4f9530.js";import{Q as E}from"./QForm.4e86ee71.js";import{Q as j}from"./QPage.78315ab4.js";import{A as m}from"./AppCamera.4fe7ee93.js";import{u as z}from"./DriverStore.21c2c9f6.js";import"./QResizeObserver.dc10e4c2.js";import"./QChip.5b52e54d.js";import"./QItemLabel.0d3c2221.js";import"./QMenu.c4f03f28.js";import"./selection.ef67fb9c.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";const N={name:"AddLicense",data(){return{loading:!1,data:[],vehicle_type_id:"",plate_number:"",maker:"",model:"",color:"",upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:"",upload_enabled2:!1,photo_data2:"",photo2:"",upload_path2:"",avatar2:""}},setup(e){return{DriverStore:z()}},components:{UploaderFile:A(()=>U(()=>import("./UploaderFile.36c0f73c.js"),["assets/UploaderFile.36c0f73c.js","assets/QUploader.d12c38b5.js","assets/index.f6661a24.js","assets/index.1593f83d.css","assets/QCircularProgress.24399868.js","assets/format.de7e9769.js"]))},created(){this.DriverStore.VehicleAttributes()},mounted(){this.id=this.$route.query.id,r.empty(this.id)||this.getVehicle()},computed:{hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!r.empty(this.photo)},hasPhotodata2(){return Object.keys(this.photo_data2).length>0},hasPhoto2(){return!r.empty(this.photo2)}},methods:{getVehicle(){this.loading=!0,r.fetchDataByTokenPost("getVehicle","id="+this.id).then(e=>{this.data=e.details,this.vehicle_type_id=parseInt(this.data.vehicle_type_id),this.plate_number=this.data.plate_number,this.maker=parseInt(this.data.maker),this.model=this.data.model,this.color=this.data.color,r.empty(e.details.photo_url)||(this.avatar=e.details.photo_url,this.photo=e.details.photo,this.upload_path=e.details.path)}).catch(e=>{}).then(e=>{this.loading=!1})},formSubmit(){r.showLoadingBox("",this.$q);let e={id:this.id,vehicle_type_id:this.vehicle_type_id,plate_number:this.plate_number,maker:this.maker,model:this.model,color:this.color,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""};r.fetchDataByTokenPost("AddVehicle",e).then(t=>{r.notify("light-green",t.msg,"check_circle",this.$q)}).catch(t=>{r.notify("red-5",t,"error_outline",this.$q)}).then(t=>{r.hideLoadingBox(this.$q)})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},afterUploadfile2(e){this.photo2=e.filename,this.avatar2=e.url_image,this.upload_path2=e.upload_path},takePhoto(){this.$q.capacitor?m.isCameraEnabled().then(e=>{m.isFileAccessEnabled().then(t=>{m.getPhoto(1).then(d=>{this.photo_data=d}).catch(d=>{this.photo_data=[]})}).catch(t=>{r.notify("dark",t,"error",this.$q)})}).catch(e=>{r.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0},takePhoto2(){this.$q.capacitor?m.isCameraEnabled().then(e=>{m.isFileAccessEnabled().then(t=>{m.getPhoto(1).then(d=>{this.photo_data2=d}).catch(d=>{this.photo_data2=[]})}).catch(t=>{r.notify("dark",t,"error",this.$q)})}).catch(e=>{r.notify("dark",e,"error",this.$q)}):this.upload_enabled2=!this.upload_enabled2},hadData2(){return Object.keys(this.photo_data2).length>0}}},O={class:"row q-gutter-sm"},L={class:"col"},x={class:"font12 line-normal"},G=u("br",null,null,-1),M={class:"text-subtitle1"},H={class:"q-gutter-y-md"},J={key:1,class:"text-grey"};function R(e,t,d,k,o,i){const Q=C("UploaderFile");return s(),n(c,null,[a(B,{class:b({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:p(()=>[a(T,null,{default:p(()=>[a(y,{onClick:t[0]||(t[0]=l=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a($,{class:"text-weight-bold"},{default:p(()=>[f(h(e.$t("Vehicle"))+" ",1),i.hasData?(s(),n(c,{key:0},[f(" - "+h(o.data.first_name)+" "+h(o.data.last_name),1)],64)):v("",!0)]),_:1})]),_:1}),a(S)]),_:1},8,["class"]),a(j,{class:b([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!o.loading&&!i.hasData},"q-pa-md"])},{default:p(()=>[o.loading?(s(),_(F,{key:0,showing:!0,color:"primary",size:"md"})):(s(),_(E,{key:1,onSubmit:i.formSubmit},{default:p(()=>[i.hasData?(s(),n(c,{key:0},[u("div",O,[i.hasPhotodata?(s(),_(V,{key:0,src:o.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):i.hasPhoto?(s(),_(V,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),n("div",{key:2,class:b(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[a(w,{name:"las la-image",class:"text-grey",size:"xl"})],2)),u("div",L,[u("div",x,[f(h(e.$t("Vehicle Thumbnail"))+".",1),G,f(" "+h(e.$t("Accepted types: PNG. JPG")),1)]),a(y,{label:i.hasPhoto?this.$t("Change Photo"):i.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:i.takePhoto},null,8,["label","onClick"])])]),o.upload_enabled?(s(),n(c,{key:0},[a(q,{class:"q-pa-sm"}),a(Q,{ref:"uploader_file",onAfterUploadfile:i.afterUploadfile},null,8,["onAfterUploadfile"])],64)):v("",!0),a(q,{class:"q-pa-sm"}),a(P,{modelValue:o.vehicle_type_id,"onUpdate:modelValue":t[1]||(t[1]=l=>o.vehicle_type_id=l),label:e.$t("Vehicle type"),options:k.DriverStore.getVehicleAttributes.vehicle_type,"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":"",rules:[l=>l&&l>0||this.$t("This field is required")]},null,8,["modelValue","label","options","rules"]),a(g,{modelValue:o.plate_number,"onUpdate:modelValue":t[2]||(t[2]=l=>o.plate_number=l),label:e.$t("Plate number"),"stack-label":"",outlined:"",color:"grey-5",rules:[l=>l&&l.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),u("div",M,h(e.$t("Maker")),1),u("div",H,[a(P,{modelValue:o.maker,"onUpdate:modelValue":t[3]||(t[3]=l=>o.maker=l),label:e.$t("Car brand"),options:k.DriverStore.getVehicleAttributes.vehicle_maker,"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":""},null,8,["modelValue","label","options"]),a(g,{modelValue:o.model,"onUpdate:modelValue":t[4]||(t[4]=l=>o.model=l),label:e.$t("Model"),"stack-label":"",outlined:"",color:"grey-5"},null,8,["modelValue","label"]),a(g,{modelValue:o.color,"onUpdate:modelValue":t[5]||(t[5]=l=>o.color=l),label:e.$t("Color"),"stack-label":"",outlined:"",color:"grey-5"},null,8,["modelValue","label"])]),a(I,null,{default:p(()=>[a(y,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})],64)):(s(),n("div",J,h(e.$t("No available data")),1))]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var fe=D(N,[["render",R]]);export{fe as default};
