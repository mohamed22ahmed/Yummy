import{Q as B}from"./QToolbarTitle.0f4dda99.js";import{Q as w}from"./QSpace.7af5fd36.js";import{s as H,c as h,h as l,bp as R,_ as T,A as c,n as p,p as q,q as n,d as s,b7 as z,X as V,Y as f,a2 as b,ap as v,as as x,a0 as D,F as L,a1 as M,$ as _,at as N,a3 as P,aQ as A}from"./index.f6661a24.js";import{Q as F}from"./QToolbar.7bb603c7.js";import{Q as j}from"./QCircularProgress.24399868.js";import{Q as I}from"./QFooter.4f4f9530.js";import{Q as U}from"./QForm.4e86ee71.js";import{C as Y}from"./ClosePopup.6296f014.js";import"./format.de7e9769.js";import"./QResizeObserver.dc10e4c2.js";var $=H({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:a}){const i=h(()=>e.sent===!0?"sent":"received"),C=h(()=>`q-message-text-content q-message-text-content--${i.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),r=h(()=>`q-message-text q-message-text--${i.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),d=h(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),t=h(()=>e.size!==void 0?`col-${e.size}`:""),y=h(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function Q(o){return a.stamp!==void 0?[o,l("div",{class:"q-message-stamp"},a.stamp())]:e.stamp?[o,l("div",{class:"q-message-stamp",[y.value.stamp]:e.stamp})]:[o]}function k(o,m){const g=m===!0?o.length>1?u=>u:u=>l("div",[u]):u=>l("div",{[y.value.msg]:u});return o.map((u,S)=>l("div",{key:S,class:r.value},[l("div",{class:C.value},Q(g(u)))]))}return()=>{const o=[];a.avatar!==void 0?o.push(a.avatar()):e.avatar!==void 0&&o.push(l("img",{class:`q-message-avatar q-message-avatar--${i.value}`,src:e.avatar,"aria-hidden":"true"}));const m=[];a.name!==void 0?m.push(l("div",{class:`q-message-name q-message-name--${i.value}`},a.name())):e.name!==void 0&&m.push(l("div",{class:`q-message-name q-message-name--${i.value}`,[y.value.name]:e.name})),a.default!==void 0?m.push(k(R(a.default()),!0)):e.text!==void 0&&m.push(k(e.text)),o.push(l("div",{class:t.value},m));const g=[];return a.label!==void 0?g.push(l("div",{class:"q-message-label"},a.label())):e.label!==void 0&&g.push(l("div",{class:"q-message-label",[y.value.label]:e.label})),g.push(l("div",{class:d.value},o)),l("div",{class:`q-message q-message-${i.value}`},g)}}});const E={name:"ReviewReply",props:["data"],data(){return{dialog:!1,reply_comment:"",loading:!1,loading_reply:!1,reply_data:[]}},computed:{hasData(){return Object.keys(this.reply_data).length>0}},methods:{whenHide(){this.reply_comment="",this.reply_data=[]},whenShow(){this.getCustomerReply()},onSubmit(){this.loading=!0,c.fetchDataByToken("reviewAddreply",{id:this.data.id,reply_comment:this.reply_comment}).then(e=>{c.notify("light-green",e.msg,"check_circle",this.$q),this.$emit("afterReply")}).catch(e=>{c.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})},getCustomerReply(){this.loading_reply=!0,c.fetchDataByTokenPost("getCustomerReply","id="+this.data.id).then(e=>{this.reply_data=e.details}).catch(e=>{this.reply_data=[]}).then(e=>{this.loading_reply=!1})},deleteReply(e){c.showLoadingBox("",this.$q),c.fetchDataByTokenPost("reviewDeleteReply","id="+e).then(a=>{this.getCustomerReply()}).catch(a=>{}).then(a=>{c.hideLoadingBox(this.$q)})}}},O={class:"q-pl-md q-pr-md q-mb-sm"},X={class:"text-weight-bold q-mb-sm"},G={class:"row items-center justify-between"},J={class:"text-weight-bold q-mb-sm"};function K(e,a,i,C,r,d){return p(),q(A,{modelValue:r.dialog,"onUpdate:modelValue":a[2]||(a[2]=t=>r.dialog=t),position:"bottom",onShow:d.whenShow,onBeforeHide:d.whenHide},{default:n(()=>[s(z,{class:"rounded-borders-top"},{default:n(()=>[s(U,{onSubmit:d.onSubmit},{default:n(()=>[s(F,{class:"text-primary top-toolbar q-pl-md",dense:""},{default:n(()=>[s(B,{class:"text-dark text-weight-bold"},{default:n(()=>[V(f(e.$t("Add reply")),1)]),_:1}),s(w),s(b,{onClick:a[0]||(a[0]=t=>r.dialog=!1),color:"white",square:"",unelevated:"","text-color":"grey",icon:"las la-times",dense:"","no-caps":"",size:"sm",class:"border-grey radius8"})]),_:1}),v("div",O,[v("div",X,f(e.$t("Customer review")),1),s($,{name:i.data.customer_fullname,text:[i.data.review],"bg-color":e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",size:"12"},null,8,["name","text","bg-color","text-color"]),r.loading_reply?(p(),q(j,{key:0,indeterminate:"",rounded:"",size:"20px",color:"primary",class:"q-ma-md"})):x("",!0),d.hasData&&!r.loading_reply?(p(!0),D(L,{key:1},M(r.reply_data,t=>(p(),q($,{key:t,size:"12","bg-color":e.$q.dark.mode?"grey600":"grey-1"},{name:n(()=>[v("div",G,[v("div",null,f(t.reply_from),1),s(b,{onClick:y=>d.deleteReply(t.id),flat:"",icon:"las la-trash",rounded:"",size:"sm",color:e.$q.dark.mode?"grey300":"blue"},null,8,["onClick","color"])])]),default:n(()=>[v("div",{class:_({"text-grey300":e.$q.dark.mode,"text-dark":!e.$q.dark.mode})},f(t.review),3)]),_:2},1032,["bg-color"]))),128)):x("",!0),v("div",J,f(e.$t("Your Reply")),1),s(N,{outlined:"",modelValue:r.reply_comment,"onUpdate:modelValue":a[1]||(a[1]=t=>r.reply_comment=t),label:e.$t("add your comment here"),"stack-label":"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")],autogrow:""},null,8,["modelValue","label","rules"]),s(w,{class:"q-pa-xl"})]),s(I,{class:_(["border-grey-top q-pa-sm row",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:n(()=>[P(s(b,{flat:"",label:e.$t("Cancel"),color:e.$q.dark.mode?"grey300":"dark","no-caps":"",class:"col"},null,8,["label","color"]),[[Y]]),s(b,{type:"submit",label:e.$t("Submit"),"no-caps":"",flat:"",color:"primary",unelevated:"",class:"col",loading:r.loading},null,8,["label","loading"])]),_:1},8,["class"])]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue","onShow","onBeforeHide"])}var ne=T(E,[["render",K]]);export{ne as default};
