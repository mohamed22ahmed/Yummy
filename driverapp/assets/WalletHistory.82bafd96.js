import{_ as B,u as S,X as _,ar as x,p as k,q as o,t as d,v as s,f as t,ae as e,a4 as u,a5 as w,Z as c,a1 as r,a0 as f,aj as g,ak as H,V,F as y,a3 as C,au as Q,aa as I,a7 as D}from"./index.57d98e6b.js";import{Q as L,a as N}from"./QPopupProxy.ce6d109d.js";import{Q as P}from"./QSkeleton.27b7e3fa.js";import{Q as T}from"./QCircularProgress.44787b73.js";import{Q as v}from"./QItemLabel.534f2eb0.js";import{Q as W}from"./QList.9b1deb90.js";import{Q as z}from"./QInfiniteScroll.0033dd1c.js";import{Q as E}from"./QPage.76c085e2.js";import{Q as R}from"./QPullToRefresh.b207fbbb.js";import{C as b}from"./ClosePopup.26d225cb.js";import"./use-render-cache.3aae9b27.js";import"./format.de7e9769.js";import"./QMenu.3e900caf.js";import"./position-engine.6e2e634f.js";import"./selection.b1db311e.js";import"./TouchPan.8da352e0.js";const F={name:"WalletHistory",data(){return{date_selected:"",date_start:"",date_end:"",loading:!1,loading_summary:!1,balance:[],data:[],page:0,proxyDate:void 0,date_now:""}},setup(){return{Activity:S()}},created(){this.Activity.setTitle(this.$t("History")),this.date_now=_.getDateNow(),this.getWalletBalance()},computed:{hasData(){return Object.keys(this.data).length>0}},components:{CalendarHalf:x(()=>Q(()=>import("./CalendarHalf.dad16ee0.js"),["assets/CalendarHalf.dad16ee0.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/swiper.min.49a5a6c9.js","assets/swiper.min.b39a1361.css"])),CashinAmountselection:x(()=>Q(()=>import("./CashinAmountselection.f09390a8.js"),["assets/CashinAmountselection.f09390a8.js","assets/QToolbarTitle.f2460359.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QToolbar.5785cd51.js","assets/QBtnGroup.a6a62eee.js","assets/QSpace.6257f203.js","assets/QForm.4d239df2.js"]))},methods:{getWalletBalance(a){this.loading=!0,_.fetchDataByTokenPost("getWalletBalance").then(i=>{this.balance=i.details.balance}).catch(i=>{}).then(i=>{this.loading=!1,_.empty(a)||a()})},afterSelectdate(a){this.date_selected=a,this.resetPagination()},getHistory(a,i){this.loading_summary=!0,_.fetchDataByTokenPost("walletHistory","page="+a+"&date="+this.date_selected+"&date_start="+this.date_start+"&date_end="+this.date_end).then(m=>{this.page=a,this.data.push(m.details.data)}).catch(m=>{_.empty(this.$refs.nscroll)||this.$refs.nscroll.stop()}).then(m=>{i(),this.loading_summary=!1})},refresh(a){this.getWalletBalance(a),this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},resetFilter(){this.date_selected="",this.date_start="",this.resetPagination()},updateProxy(){console.log("updateProxy=>"+this.date_now),this.proxyDate=this.date_now},filterByDate(){console.log(this.proxyDate),this.date_start=this.proxyDate.from,this.date_end=this.proxyDate.to,this.date_selected="",this.resetPagination()},showCashin(){this.$refs.cashin.dialog=!0}}},O={class:"q-pl-sm q-pr-sm q-pt-xs"},Y={class:"row"},j={class:"col-11"},M={class:"col"},K={class:"row items-center justify-end q-gutter-sm"},U={class:"row q-mb-md items-center q-col-gutter-sm"},X={class:"col-7"},Z={key:1,class:"text-white q-pa-sm radius8 bg-blue row items-center cursor-pointer"},G={class:"font12"},J={class:"text-weight-bold text-h6"},$=e("div",{class:"q-pl-md"},[e("i",{class:"las la-angle-right text-bold",style:{"font-size":"18px"}})],-1),ee={class:"col-5 text-center"},te={class:"row items-center"},ae={class:"text-h7 col"},se={class:"col-3 text-right"},oe={class:"q-pl-sm q-pr-sm q-pt-xs"},le={key:0,class:"flex flex-center full-width q-pa-xl",style:{"min-height":"calc(30vh)"}},re={key:0,class:"text-center"},ie={key:0,class:"flex flex-center",style:{"min-height":"calc(50vh)"}},ne={class:"text-center"},ce={class:"font16 text-weight-bold"},de={class:"font11"};function he(a,i,m,_e,l,n){const q=k("CalendarHalf"),A=k("CashinAmountselection");return o(),d(R,{onRefresh:n.refresh},{default:s(()=>[t(E,null,{default:s(()=>[e("div",O,[e("div",Y,[e("div",j,[t(q,{ref:"calendar",onAfterSelectdate:n.afterSelectdate,today_date:l.date_selected},null,8,["onAfterSelectdate","today_date"])]),e("div",M,[t(u,{icon:"event",round:"",color:"green-4",size:"sm",flat:""},{default:s(()=>[t(L,{onBeforeShow:n.updateProxy,cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[t(N,{modelValue:l.proxyDate,"onUpdate:modelValue":i[0]||(i[0]=p=>l.proxyDate=p),mask:"YYYY-MM-DD",range:""},{default:s(()=>[e("div",K,[w(t(u,{label:"Cancel",color:"primary",flat:""},null,512),[[b]]),w(t(u,{label:a.$t("OK"),color:"primary",flat:"",onClick:n.filterByDate},null,8,["label","onClick"]),[[b]])])]),_:1},8,["modelValue"])]),_:1},8,["onBeforeShow"])]),_:1})])]),e("div",U,[e("div",X,[l.loading?(o(),d(P,{key:0,height:"60px",square:""})):(o(),c("div",Z,[e("div",null,[e("div",G,r(a.$t("Available balance")),1),e("div",J,r(l.balance.pretty),1)]),$]))]),e("div",ee,[l.loading?(o(),d(P,{key:0,height:"60px",square:""})):(o(),d(u,{key:1,color:"primary",outline:"","no-caps":"",onClick:n.showCashin},{default:s(()=>[f(r(a.$t("CASH IN")),1)]),_:1},8,["onClick"]))])]),e("div",te,[e("div",ae,r(a.$t("Wallet transactions")),1),e("div",se,[l.date_selected||l.date_start?(o(),d(u,{key:0,round:"",color:"blue",icon:"las la-sync-alt",size:"sm",flat:"",onClick:n.resetFilter},null,8,["onClick"])):g("",!0)])])]),e("div",oe,[t(H,{class:"no-shadow"},{default:s(()=>[t(z,{ref:"nscroll",onLoad:n.getHistory,offset:250},{loading:s(()=>[l.page<=0?(o(),c("div",le,[t(V,{color:"primary",size:"2em"})])):(o(),c(y,{key:1},[l.data.length>1?(o(),c("div",re,[t(T,{indeterminate:"",rounded:"",size:"30px",color:"primary",class:"q-ma-md"})])):g("",!0)],64))]),default:s(()=>[!l.loading_summary&&!n.hasData?(o(),c("div",ie,[e("div",ne,[e("div",ce,r(a.$t("No available data")),1),e("p",de,r(a.$t("Pull down the page to refresh")),1)])])):g("",!0),t(W,{separator:""},{default:s(()=>[(o(!0),c(y,null,C(l.data,p=>(o(),c(y,{key:p},[(o(!0),c(y,null,C(p,h=>(o(),d(I,{key:h},{default:s(()=>[t(D,null,{default:s(()=>[t(v,null,{default:s(()=>[f(r(h.transaction_amount),1)]),_:2},1024),t(v,{caption:""},{default:s(()=>[f(r(h.transaction_description),1)]),_:2},1024),t(v,{caption:""},{default:s(()=>[f(r(h.transaction_date),1)]),_:2},1024)]),_:2},1024),t(D,{side:""},{default:s(()=>[f(r(h.running_balance),1)]),_:2},1024)]),_:2},1024))),128))],64))),128))]),_:1})]),_:1},8,["onLoad"])]),_:1})])]),_:1}),t(A,{ref:"cashin"},null,512)]),_:1},8,["onRefresh"])}var Ae=B(F,[["render",he]]);export{Ae as default};
