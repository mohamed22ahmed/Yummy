import{_ as b,ar as c,u as T,X as d,p as n,q as i,t as o,v as h,$ as g,f as p,Z as l,F as y,aj as u,a3 as q,ae as k,a1 as f,au as m,a4 as x,a0 as B}from"./index.57d98e6b.js";import{Q as S}from"./QSpace.6257f203.js";import{Q as V}from"./QPullToRefresh.b207fbbb.js";import{Q as E}from"./QPage.76c085e2.js";import{S as L,a as Q}from"./swiper.min.49a5a6c9.js";import"./TouchPan.8da352e0.js";import"./selection.b1db311e.js";import"./format.de7e9769.js";const R={name:"DeliveriesPage",components:{Swiper:L,SwiperSlide:Q,ActiveOrder:c(()=>m(()=>import("./ActiveOrder.254361a3.js"),["assets/ActiveOrder.254361a3.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QSlideItem.6eaab49f.js","assets/TouchPan.8da352e0.js","assets/selection.b1db311e.js","assets/use-render-cache.3aae9b27.js","assets/QList.9b1deb90.js","assets/LocationStore.ce636ffa.js"])),OrderPickup:c(()=>m(()=>import("./OrderPickup.510eb79f.js"),["assets/OrderPickup.510eb79f.js","assets/index.57d98e6b.js","assets/index.945c03c3.css"])),OrderCustomer:c(()=>m(()=>import("./OrderCustomer.0fc3428a.js"),["assets/OrderCustomer.0fc3428a.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QSpace.6257f203.js","assets/QSlideItem.6eaab49f.js","assets/TouchPan.8da352e0.js","assets/selection.b1db311e.js","assets/use-render-cache.3aae9b27.js","assets/QList.9b1deb90.js","assets/LocationStore.ce636ffa.js"])),OrderDropoff:c(()=>m(()=>import("./OrderDropoff.45da2242.js"),["assets/OrderDropoff.45da2242.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QSpace.6257f203.js","assets/QBar.3a2078ec.js","assets/position-engine.6e2e634f.js","assets/selection.b1db311e.js","assets/QImg.0d589814.js","assets/ClosePopup.26d225cb.js","assets/AppCamera.2e0dc590.js"]))},data(){return{loading:!1,list:[],data:[],merchants:[],order_meta:[],payment_list:[],active_order:void 0}},computed:{hasOrder(){return Object.keys(this.data).length>0},hasManyOrder(){return Object.keys(this.list).length>1}},setup(){return{Activity:T()}},created(){this.Activity.setTitle(this.$t("Deliveries")),this.getDelivery()},watch:{data(e,r){e.delivery_steps&&e.delivery_steps.instructions&&this.Activity.setTitle(e.delivery_steps.instructions)}},methods:{getDelivery(){d.showLoadingBox("",this.$q),this.loading=!0;const e=d.getDateNow();d.fetchDataByToken("getorderlist",{date:e}).then(r=>{this.list=r.details.data;const a=Object.keys(this.list);this.data=this.list[a[0]],this.active_order=this.data.order_id,this.data.delivery_steps.steps==1&&this.$router.push({path:"/order/new",query:{order_uuid:this.data.order_uuid}}),this.merchants=r.details.merchant,this.order_meta=r.details.order_meta,this.payment_list=r.details.payment_list}).catch(r=>{this.Activity.setTitle(this.$t("Deliveries")),this.data=[],this.active_order=void 0,this.merchants=[],this.order_meta=[],this.payment_list=[]}).then(r=>{d.hideLoadingBox(this.$q),this.loading=!1})},afterChangestatus(e){if(console.debug("afterChangestatus=>"),console.debug(e),Object.keys(e).length>0){const r=e.delivery_steps.steps;console.debug(r),this.data.delivery_steps=e.delivery_steps,d.empty(r)?this.getDelivery():this.Activity.setTitle(this.data.delivery_steps.instructions)}else this.getDelivery()},setActiveOrder(e){this.active_order=e,this.list[e]&&(this.data=this.list[e],this.data.delivery_steps.steps===1&&this.$router.push({path:"/order/new",query:{order_uuid:this.data.order_uuid}}))},refreshDelivery(e){this.loading=!0;const r=d.getDateNow();d.fetchDataByToken("getorderlist",{date:r}).then(a=>{this.list=a.details.data;const v=Object.keys(this.list);this.data=this.list[v[0]],this.active_order=this.data.order_id,this.data.delivery_steps.steps==1&&this.$router.push({path:"/order/new",query:{order_uuid:this.data.order_uuid}}),this.merchants=a.details.merchant,this.order_meta=a.details.order_meta,this.payment_list=a.details.payment_list}).catch(a=>{console.debug(a),this.data=[],this.active_order=void 0,this.merchants=[],this.order_meta=[],this.payment_list=[]}).then(a=>{e(),this.loading=!1})},isActive(e){return this.active_order==e?"primary":"grey-5"}}},j={key:1,class:"q-pa-md"},N={key:1,class:"text-center full-width"},I={class:"font15 line-normal text-weight-bold"},M={class:"font11 text-weight-light"};function z(e,r,a,v,t,s){const O=n("swiper-slide"),A=n("swiper"),w=n("ActiveOrder"),C=n("OrderPickup"),D=n("OrderCustomer"),P=n("OrderDropoff");return i(),o(E,{class:g({"row items-stretch":!s.hasOrder,"bg-mydark text-white":e.$q.dark.mode,"bg-grey-1 text-dark":!e.$q.dark.mode})},{default:h(()=>[p(V,{onRefresh:s.refreshDelivery,class:g({"col-12 flex flex-center relative-position":!s.hasOrder})},{default:h(()=>[t.loading?u("",!0):(i(),l(y,{key:0},[s.hasOrder?(i(),l(y,{key:0},[s.hasManyOrder?u("",!0):(i(),o(S,{key:0,class:"q-pa-xs"})),s.hasManyOrder?(i(),l("div",j,[p(A,{slidesPerView:3.5,spaceBetween:10,onSwiper:e.onSwiper},{default:h(()=>[(i(!0),l(y,null,q(t.list,_=>(i(),o(O,{key:_,class:"row"},{default:h(()=>[p(x,{unelevated:"",color:s.isActive(_.order_id),"no-caps":"",size:"md",onClick:F=>s.setActiveOrder(_.order_id)},{default:h(()=>[B("#"+f(_.order_id),1)]),_:2},1032,["color","onClick"])]),_:2},1024))),128))]),_:1},8,["slidesPerView","onSwiper"])])):u("",!0),t.data.delivery_steps.steps===2||t.data.delivery_steps.steps===3?(i(),o(w,{key:2,data:t.data,merchants:t.merchants,order_meta:t.order_meta,onAfterChangestatus:s.afterChangestatus},null,8,["data","merchants","order_meta","onAfterChangestatus"])):t.data.delivery_steps.steps===4?(i(),o(C,{key:3,ref:"order_pickup",order_uuid:t.data.order_uuid,data:t.data,merchants:t.merchants,order_meta:t.order_meta,onAfterChangestatus:s.afterChangestatus},null,8,["order_uuid","data","merchants","order_meta","onAfterChangestatus"])):t.data.delivery_steps.steps===5||t.data.delivery_steps.steps===6?(i(),o(D,{key:4,order_uuid:t.data.order_uuid,data:t.data,merchants:t.merchants,order_meta:t.order_meta,payment_list:t.payment_list,onAfterChangestatus:s.afterChangestatus},null,8,["order_uuid","data","merchants","order_meta","payment_list","onAfterChangestatus"])):t.data.delivery_steps.steps===7?(i(),o(P,{key:5,order_uuid:t.data.order_uuid,data:t.data,merchants:t.merchants,order_meta:t.order_meta,payment_list:t.payment_list,onAfterChangestatus:s.afterChangestatus},null,8,["order_uuid","data","merchants","order_meta","payment_list","onAfterChangestatus"])):u("",!0)],64)):(i(),l("div",N,[k("div",I,f(e.$t("You have no pending deliveries")),1),k("p",M,f(e.$t("Make sure your internet is always connected")),1)]))],64))]),_:1},8,["onRefresh","class"])]),_:1},8,["class"])}var W=b(R,[["render",z]]);export{W as default};
