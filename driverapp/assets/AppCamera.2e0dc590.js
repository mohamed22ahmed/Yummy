import{W as E,b4 as u,b5 as P,au as v}from"./index.57d98e6b.js";var l;(function(n){n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS"})(l||(l={}));var m;(function(n){n.Rear="REAR",n.Front="FRONT"})(m||(m={}));var f;(function(n){n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl"})(f||(f={}));class g extends E{async getPhoto(e){return new Promise(async(i,t)=>{if(e.webUseInput||e.source===l.Photos)this.fileInputExperience(e,i,t);else if(e.source===l.Prompt){let a=document.querySelector("pwa-action-sheet");a||(a=document.createElement("pwa-action-sheet"),document.body.appendChild(a)),a.header=e.promptLabelHeader||"Photo",a.cancelable=!1,a.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],a.addEventListener("onSelection",async r=>{r.detail===0?this.fileInputExperience(e,i,t):this.cameraExperience(e,i,t)})}else this.cameraExperience(e,i,t)})}async pickImages(e){return new Promise(async(i,t)=>{this.multipleFileInputExperience(i,t)})}async cameraExperience(e,i,t){if(customElements.get("pwa-camera-modal")){const a=document.createElement("pwa-camera-modal");a.facingMode=e.direction===m.Front?"user":"environment",document.body.appendChild(a);try{await a.componentOnReady(),a.addEventListener("onPhoto",async r=>{const s=r.detail;s===null?t(new u("User cancelled photos app")):s instanceof Error?t(s):i(await this._getCameraPhoto(s,e)),a.dismiss(),document.body.removeChild(a)}),a.present()}catch{this.fileInputExperience(e,i,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,i,t)}fileInputExperience(e,i,t){let a=document.querySelector("#_capacitor-camera-input");const r=()=>{var s;(s=a.parentNode)===null||s===void 0||s.removeChild(a)};a||(a=document.createElement("input"),a.id="_capacitor-camera-input",a.type="file",a.hidden=!0,document.body.appendChild(a),a.addEventListener("change",s=>{const c=a.files[0];let o="jpeg";if(c.type==="image/png"?o="png":c.type==="image/gif"&&(o="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(e.resultType==="dataUrl")i({dataUrl:d.result,format:o});else if(e.resultType==="base64"){const y=d.result.split(",")[1];i({base64String:y,format:o})}r()}),d.readAsDataURL(c)}else i({webPath:URL.createObjectURL(c),format:o}),r()}),a.addEventListener("cancel",s=>{t(new u("User cancelled photos app")),r()})),a.accept="image/*",a.capture=!0,e.source===l.Photos||e.source===l.Prompt?a.removeAttribute("capture"):e.direction===m.Front?a.capture="user":e.direction===m.Rear&&(a.capture="environment"),a.click()}multipleFileInputExperience(e,i){let t=document.querySelector("#_capacitor-camera-input-multiple");const a=()=>{var r;(r=t.parentNode)===null||r===void 0||r.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",r=>{const s=[];for(let c=0;c<t.files.length;c++){const o=t.files[c];let d="jpeg";o.type==="image/png"?d="png":o.type==="image/gif"&&(d="gif"),s.push({webPath:URL.createObjectURL(o),format:d})}e({photos:s}),a()}),t.addEventListener("cancel",r=>{i(new u("User cancelled photos app")),a()})),t.accept="image/*",t.click()}_getCameraPhoto(e,i){return new Promise((t,a)=>{const r=new FileReader,s=e.type.split("/")[1];i.resultType==="uri"?t({webPath:URL.createObjectURL(e),format:s,saved:!1}):(r.readAsDataURL(e),r.onloadend=()=>{const c=r.result;i.resultType==="dataUrl"?t({dataUrl:c,format:s,saved:!1}):t({base64String:c.split(",")[1],format:s,saved:!1})},r.onerror=c=>{a(c)})})}async checkPermissions(){if(typeof navigator=="undefined"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new g;const h=P("Camera",{web:()=>new g});var b;(function(n){n.Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE"})(b||(b={}));var w;(function(n){n.UTF8="utf8",n.ASCII="ascii",n.UTF16="utf16"})(w||(w={}));const p=P("Filesystem",{web:()=>v(()=>import("./web.e9006395.js"),["assets/web.e9006395.js","assets/index.57d98e6b.js","assets/index.945c03c3.css"]).then(n=>new n.FilesystemWeb)}),U={async isCameraEnabled(){return await new Promise(function(e,i){h.checkPermissions().then(t=>{switch(t.camera){case"prompt":case"prompt-with-rationale":case"denied":h.requestPermissions().then(a=>{switch(a.camera){case"granted":e("granted");break;default:i("denied");break}}).catch(a=>{i(a)});break;case"granted":e("granted");break}}).catch(t=>{i(t)})})},async isFileAccessEnabled(){return await new Promise(function(e,i){p.checkPermissions().then(t=>{switch(t.publicStorage){case"prompt":case"prompt-with-rationale":case"denied":p.requestPermissions().then(a=>{switch(a.publicStorage){case"granted":e("granted");break;default:i("denied");break}}).catch(a=>{i(a)});break;case"granted":e("granted");break;default:i("denied");break}}).catch(t=>{i(t)})})},async getPhoto(n){let e=l.Prompt;n==2?e=l.Camera:n==3&&(e=l.Photos);const i=await h.getPhoto({quality:90,allowEditing:!1,resultType:f.Uri,width:500,source:e});if(i){const t=await p.readFile({path:i.path});if(t)return{format:i.format,path:i.webPath,data:t.data}}return!1},async ReadFile(n){const e=await p.readFile({path:n});return e||!1}};export{U as A,w as E};
