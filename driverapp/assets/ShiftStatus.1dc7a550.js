import{_ as P,ar as S,u as $,ag as E,X as h,p as q,q as t,Z as l,f as n,v as g,F as c,$ as D,V as Q,ae as a,a4 as u,a1 as i,aj as r,t as y,a3 as L,d0 as w,a0 as m,ak as x,au as A,ah as C}from"./index.57d98e6b.js";import{Q as v}from"./QSpace.6257f203.js";import{Q as p}from"./QBadge.d629348d.js";import{Q as T}from"./QPage.76c085e2.js";import{Q as R}from"./QPullToRefresh.b207fbbb.js";import{u as O}from"./ScheduleStore.6d5970b3.js";import{A as V}from"./AppLocation.994227c2.js";import"./TouchPan.8da352e0.js";import"./selection.b1db311e.js";import"./format.de7e9769.js";const Y={name:"ShiftStatus",components:{AddCarPhoto:S(()=>A(()=>import("./AddCarPhoto.040371b1.js"),["assets/AddCarPhoto.040371b1.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QBar.3a2078ec.js","assets/position-engine.6e2e634f.js","assets/selection.b1db311e.js","assets/QSpace.6257f203.js","assets/QImg.0d589814.js","assets/ClosePopup.26d225cb.js","assets/AppCamera.2e0dc590.js"])),PhotoCarousel:S(()=>A(()=>import("./PhotoCarousel.7b508bee.js"),["assets/PhotoCarousel.7b508bee.js","assets/QBar.3a2078ec.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/position-engine.6e2e634f.js","assets/selection.b1db311e.js","assets/TouchPan.8da352e0.js","assets/use-render-cache.3aae9b27.js","assets/ClosePopup.26d225cb.js"]))},setup(){const e=$(),d=O();return{Activity:e,Schedule:d}},data(){return{loading:!1,schedule_uuid:"",location_enabled:!1,docs_data:[],employment_type:"",balance:[],loading_online:!1}},computed:{hasBalance(){return Object.keys(this.balance).length>0}},created(){this.Activity.settings_data.on_demand_availability?this.Activity.getOnlineStatus(null):(this.Schedule.$q=this.$q,this.Activity.setTitle(this.$t("Status")),this.Schedule.hadData()?(this.Schedule.runRemainingTime(),this.Schedule.startTimer()):this.Schedule.gettShift());let e=[];(e=E.getUser())&&(this.employment_type=e.employment_type),this.$q.capacitor&&this.locationEnabled(),this.getRemainingCashBalance()},unmounted(){this.Schedule.stopTimer()},mounted(){},methods:{refreshShift(e){this.Activity.settings_data.on_demand_availability?this.Activity.getOnlineStatus(e):this.Schedule.refreshShift(e),this.getRemainingCashBalance()},startWorking(e){this.schedule_uuid=e;let d=h.empty(this.Activity.settings_data)?!1:this.Activity.settings_data.task_take_pic;console.log("=>"+d),d?this.setPhoto():this.startShift(e)},setPhoto(e){this.$refs.car_photo.dialog=!0},afterAttachphoto(e){this.startShift(e)},startShift(e){h.showLoadingBox("Starting",this.$q),h.startShift({schedule_uuid:e}).then(d=>{this.Schedule.gettShift()}).catch(d=>{h.notify("red-5",d,"error_outline",this.$q)}).then(d=>{h.hideLoadingBox(this.$q)})},endShift(e){h.showLoadingBox("",this.$q),h.endShift({schedule_uuid:e}).then(d=>{this.Schedule.gettShift()}).catch(d=>{h.notify("red-5",d,"error_outline",this.$q)}).then(d=>{h.hideLoadingBox(this.$q)})},locationEnabled(){console.log("locationEnabled"),V.islocationEnabled().then(e=>{this.location_enabled=!0}).catch(e=>{this.location_enabled=!1})},viewDocs(e){this.docs_data=e,this.$refs.photo_carousel.dialog=!0},endBreak(e){h.showLoadingBox("",this.$q),h.fetchDataByTokenPost("endBreak","id="+this.Schedule.data_break.id).then(d=>{this.Schedule.gettShift()}).catch(d=>{h.notify("dark",d,"error",this.$q)}).then(d=>{h.hideLoadingBox(this.$q)})},getRemainingCashBalance(){h.fetchDataByTokenPost("getRemainingCashBalance").then(e=>{this.balance=e.details}).catch(e=>{this.balance=[]}).then(e=>{})},changeOnlineStatus(e){let d=e==!0?1:0;this.loading_online=!0,h.fetchDataByTokenPost("changeOnlineStatus","is_online="+d).then(k=>{this.Activity.is_online=k.details.is_online,this.Activity.is_online&&this.$router.push("/selectzone")}).catch(k=>{h.notify("red-5",k,"error_outline",this.$q)}).then(k=>{this.loading_online=!1})}}},N={key:0,class:"flex flex-center full-width q-pa-xl",style:{"min-height":"calc(50vh)"}},W={key:0,class:"flex q-gutter-x-sm"},I={class:""},j={class:"q-gitter-x-sm"},F={class:"q-mt-md"},G={class:"q-mb-none"},U={class:"row items-center q-pl-md q-pr-md q-pt-sm"},X={class:"col"},Z={key:0,class:"col text-right"},H=m("End Break"),J={class:"q-pa-md text-left"},K={class:"text-h7 q-mb-sm font16"},M={class:"row items-start q-gutter-sm"},ee={class:"col-3"},te={class:"bg-grey-2 flex flex-center rounded-borders"},ae={class:"text-center"},se={class:"text-orange text-weight-bold font17"},le={class:"text-dark text-weight-bold font19"},ie={class:"text-dark text-weight-medium font15"},oe={class:"ellipsis block",style:{width:"80px"}},ne={class:"col"},de={class:"font14 text-weight-bold"},ce={class:"flex"},he={class:"q-ml-sm font15 text-weight-medium"},re={class:"font14 text-weight-bold ellipsis-2-lines"},ue={class:"font12 text-weight-light ellipsis-2-lines"},_e={key:1,class:"font13 text-weight-medium text-green-5"},fe={key:2,class:"flex items-center"},ge={class:"q-ml-sm font14 text-weight-medium"},me={key:0,class:"text-center q-pt-md"},ye={key:0,class:"text-red text-weight-medium"},ke={class:"text-weight-bold"},be={class:"q-mb-none"},ve={class:"font14 text-weight-bold"},pe={class:"text-blue"},Se={class:"text-grey font12"},qe={key:1,class:"text-center"},we={class:"font16 text-weight-bold"},xe=m(" You have no work schedule for today "),Ae={class:"font11"};function Ce(e,d,k,o,_,f){const B=q("AddCarPhoto"),z=q("PhotoCarousel");return t(),l(c,null,[n(R,{onRefresh:f.refreshShift},{default:g(()=>[n(T,{class:D({"flex flex-center":!o.Schedule.hasData&&!o.Schedule.loading,"bg-mydark text-white":e.$q.dark.mode,"bg-grey-1 text-dark":!e.$q.dark.mode})},{default:g(()=>[o.Schedule.loading?(t(),l("div",N,[n(Q,{color:"primary",size:"2em"})])):(t(),l(c,{key:1},[o.Activity.settings_data.on_demand_availability?(t(),l("div",W,[a("div",I,[a("div",j,[n(u,{label:o.Activity.is_online?e.$t("Go offline"):e.$t("Go online"),color:o.Activity.is_online?"red-10":"indigo-7",loading:_.loading_online,unelevated:"",size:"lg","no-caps":"",class:"radius28",onClick:d[0]||(d[0]=s=>f.changeOnlineStatus(!o.Activity.is_online)),style:{"min-width":"150px"}},null,8,["label","color","loading"]),n(u,{unelevated:"",color:"white","text-color":"dark",size:"lg","no-caps":"",class:"radius28",icon:"tune",to:"/selectzone"})]),a("div",F,[_.location_enabled===!1?(t(),l(c,{key:0},[n(v,{class:"q-pa-xs"}),a("p",G,i(e.$t("Your location is disabled"))+". ",1),n(u,{to:"/location/permission",label:e.$t("Enabled Location"),unelevated:"",color:"blue",class:"text-weight-bold fit font16","no-caps":"",size:"lg"},null,8,["label"])],64)):r("",!0)])])])):(t(),l(c,{key:1},[o.Schedule.hasData?(t(),l(c,{key:0},[a("div",U,[a("div",X,[o.Schedule.isWorking?(t(),y(p,{key:0,"text-color":"white",style:{background:"#49c3a1"},label:"Working",class:"q-pa-sm q-pl-md q-pr-md text-weight-bold font15"})):(t(),y(p,{key:1,"text-color":"white",style:{background:"#9689e7"},label:"Not Working",class:"q-pa-sm q-pl-md q-pr-md text-weight-bold font15"}))]),o.Schedule.hasBreak?(t(),l("div",Z,[n(u,{unelevated:"",flat:"","no-caps":"",color:"blue",dense:"",onClick:f.endBreak},{default:g(()=>[H]),_:1},8,["onClick"])])):r("",!0)]),a("div",J,[a("div",K,i(e.$t("Today Schedule")),1),(t(!0),l(c,null,L(o.Schedule.data,s=>(t(),y(x,{key:s,class:"no-shadow q-mb-md"},{default:g(()=>[n(w,{class:"q-pa-sm"},{default:g(()=>[a("div",M,[a("div",ee,[a("div",te,[a("div",ae,[a("div",se,i(s.date_start_split.month),1),a("div",le,i(s.date_start_split.day),1),a("div",ie,[a("span",oe,i(s.date_start_split.date_string),1)])])])]),a("div",ne,[a("div",de,i(s.time_start)+" - "+i(s.time_end),1),a("div",ce,[n(p,{color:"myyellow1"},{default:g(()=>[n(C,{name:"las la-car-side",size:"1.3em"})]),_:1}),a("div",he,[o.Schedule.vehicle_data[s.vehicle_id]?(t(),l(c,{key:0},[m(i(o.Schedule.vehicle_maker[o.Schedule.vehicle_data[s.vehicle_id].maker])+" - "+i(o.Schedule.vehicle_data[s.vehicle_id].plate_number),1)],64)):r("",!0)])]),a("div",re,i(s.zone_name),1),a("div",ue,i(s.instructions),1),o.Schedule.vehicle_documents[s.vehicle_id]?(t(),y(u,{key:0,label:e.$t("View Car Documents"),unelevated:"","no-caps":"",flat:"",class:"q-pa-none",size:"lg",color:"amber-5",onClick:b=>f.viewDocs(o.Schedule.vehicle_documents[s.vehicle_id])},null,8,["label","onClick"])):r("",!0),s.starting_in?(t(),l("div",_e,i(e.$t("Starting in"))+" "+i(s.starting_in),1)):r("",!0),s.shift_status=="started"?(t(),l("div",fe,[n(C,{name:"las la-check-circle",size:"sm",class:"text-mygreen"}),a("div",ge,i(e.$t("Ongoing")),1)])):r("",!0)])]),s.shift_status=="ready"||s.shift_status=="late"?(t(),l(c,{key:0},[a("p",null,i(e.$t("Are you ready"))+"?",1),n(u,{label:e.$t("Start Working Now"),unelevated:"",color:"primary",class:"text-weight-bold fit font17","no-caps":"",onClick:b=>f.startWorking(s.schedule_uuid),size:"lg"},null,8,["label","onClick"])],64)):s.shift_status=="started"?(t(),l(c,{key:1},[o.Schedule.hasBreak?(t(),l("div",me,[o.Schedule.break_status=="break_ended"?(t(),l("span",ye,i(e.$t("Your break is already ended")),1)):(t(),l(c,{key:1},[m(i(e.$t("You are on break until"))+" ",1),a("span",ke,i(o.Schedule.data_break.break_until_hours),1)],64))])):(t(),l(c,{key:1},[o.Schedule.can_request_break?(t(),y(u,{key:0,label:e.$t("Request Break"),unelevated:"",color:"primary",class:"text-weight-bold fit font17 q-mt-md","no-caps":"",size:"lg",to:{name:"request_break",query:{schedule_uuid:s.schedule_uuid}}},null,8,["label","to"])):r("",!0)],64))],64)):s.shift_status=="shift_ended"?(t(),l(c,{key:2},[a("p",null,i(e.$t("Shift schedule already passed")),1),n(u,{label:e.$t("Search Shifts"),unelevated:"",color:"primary",class:"text-weight-bold fit font17","no-caps":"",to:"/shift/find",size:"lg"},null,8,["label"])],64)):s.shift_status=="ended"?(t(),l(c,{key:3},[a("p",null,i(e.$t("Your shift is already done please click end shift"))+"! ",1),n(u,{label:e.$t("End shift"),unelevated:"",color:"red",class:"text-weight-bold fit","no-caps":"",onClick:b=>f.endShift(s.schedule_uuid),size:"lg"},null,8,["label","onClick"])],64)):r("",!0),o.Activity.settings_data.enabled_end_shift?(t(),l(c,{key:4},[s.shift_status=="started"||s.shift_status=="shift_ended"?(t(),l(c,{key:0},[n(v,{class:"q-pa-xs"}),n(u,{label:e.$t("End shift"),unelevated:"",color:"red",class:"text-weight-bold fit","no-caps":"",onClick:b=>f.endShift(s.schedule_uuid),size:"lg"},null,8,["label","onClick"])],64)):r("",!0)],64)):r("",!0),_.location_enabled===!1?(t(),l(c,{key:5},[n(v,{class:"q-pa-xs"}),a("p",be,i(e.$t("Your location is disabled"))+". ",1),n(u,{to:"/location/permission",label:e.$t("Enabled Location"),unelevated:"",color:"blue",class:"text-weight-bold fit font16","no-caps":"",size:"lg"},null,8,["label"])],64)):r("",!0)]),_:2},1024)]),_:2},1024))),128)),f.hasBalance?(t(),y(x,{key:0,class:"no-shadow"},{default:g(()=>[n(w,null,{default:g(()=>[a("div",ve,[m(i(e.$t("Balance"))+" : ",1),a("span",pe,i(_.balance.balance),1)]),a("div",Se,i(e.$t("Your remaining balance that you can accept cash order")),1)]),_:1})]),_:1})):r("",!0)])],64)):(t(),l("div",qe,[a("div",we,[_.employment_type=="contractor"?(t(),l(c,{key:0},[m(i(e.$t("You don't have any shifts starting soon"))+". ",1)],64)):(t(),l(c,{key:1},[xe],64))]),a("p",Ae,[_.employment_type=="contractor"?(t(),l(c,{key:0},[m(i(e.$t("Search for more available shifts")),1)],64)):(t(),l(c,{key:1},[m(i(e.$t("Pull down the page to refresh")),1)],64))]),_.employment_type=="contractor"?(t(),y(u,{key:0,label:e.$t("Search Shifts"),unelevated:"",color:"primary",class:"text-weight-bold fit font17","no-caps":"",to:"/shift/find",size:"lg"},null,8,["label"])):r("",!0)]))],64))],64))]),_:1},8,["class"])]),_:1},8,["onRefresh"]),n(B,{ref:"car_photo",schedule_uuid:_.schedule_uuid,onAfterAttachphoto:f.afterAttachphoto},null,8,["schedule_uuid","onAfterAttachphoto"]),n(z,{ref:"photo_carousel",title:"Car Documents",data:_.docs_data},null,8,["data"])],64)}var Oe=P(Y,[["render",Ce]]);export{Oe as default};
