import{x as I,r as B,c as L,cY as M,O as H,aH as N,h as b,g as W,a4 as y,_ as z,ar as K,u as U,X as d,p as Y,q as p,Z as S,f as t,v as o,$ as P,F as $,a0 as v,a1 as u,a2 as X,V as E,ae as c,al as Z,cR as G,aa as g,a7 as m,t as C,a8 as J,au as ee}from"./index.57d98e6b.js";import{Q as te}from"./QToolbarTitle.f2460359.js";import{Q as ae}from"./QToolbar.5785cd51.js";import{Q as oe}from"./QHeader.8d398719.js";import{Q as le}from"./QMenu.3e900caf.js";import{Q as ne}from"./QSpace.6257f203.js";import{Q as T}from"./QList.9b1deb90.js";import{Q as se}from"./QSlideItem.6eaab49f.js";import{Q as re}from"./QFooter.9a53d96e.js";import{Q as ue}from"./QPage.76c085e2.js";import{Q as ie}from"./QPullToRefresh.b207fbbb.js";import"./QResizeObserver.1c6d7ccc.js";import"./position-engine.6e2e634f.js";import"./selection.b1db311e.js";import"./TouchPan.8da352e0.js";import"./use-render-cache.3aae9b27.js";import"./format.de7e9769.js";function k(e,a=new WeakMap){if(Object(e)!==e)return e;if(a.has(e))return a.get(e);const s=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const r=e.valueOf();if(Object(r)!==r){const l=new e.constructor(r);return a.set(e,l),l}}return a.set(e,s),e instanceof Set?e.forEach(r=>{s.add(k(r,a))}):e instanceof Map&&e.forEach((r,l)=>{s.set(l,k(r,a))}),Object.assign(s,...Object.keys(e).map(r=>({[r]:k(e[r],a)})))}var ce=I({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:a,emit:s}){const{proxy:r}=W(),{$q:l}=r,i=B(null),f=B(""),n=B("");let _=!1;const A=L(()=>M({initialValue:f.value,validate:e.validate,set:q,cancel:w,updatePosition:x},"value",()=>n.value,h=>{n.value=h}));function q(){e.validate(n.value)!==!1&&(Q()===!0&&(s("save",n.value,f.value),s("update:modelValue",n.value)),V())}function w(){Q()===!0&&s("cancel",n.value,f.value),V()}function x(){H(()=>{i.value.updatePosition()})}function Q(){return N(n.value,f.value)===!1}function V(){_=!0,i.value.hide()}function O(){_=!1,f.value=k(e.modelValue),n.value=k(e.modelValue),s("beforeShow")}function j(){s("show")}function F(){_===!1&&Q()===!0&&(e.autoSave===!0&&e.validate(n.value)===!0?(s("save",n.value,f.value),s("update:modelValue",n.value)):s("cancel",n.value,f.value)),s("beforeHide")}function R(){s("hide")}function D(){const h=a.default!==void 0?[].concat(a.default(A.value)):[];return e.title&&h.unshift(b("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&h.push(b("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[b(y,{flat:!0,color:e.color,label:e.labelCancel||l.lang.label.cancel,onClick:w}),b(y,{flat:!0,color:e.color,label:e.labelSet||l.lang.label.set,onClick:q})])),h}return Object.assign(r,{set:q,cancel:w,show(h){i.value!==null&&i.value.show(h)},hide(h){i.value!==null&&i.value.hide(h)},updatePosition:x}),()=>{if(e.disable!==!0)return b(le,{ref:i,class:"q-popup-edit",cover:e.cover,onBeforeShow:O,onShow:j,onBeforeHide:F,onHide:R,onEscapeKey:w},D)}}});const fe={name:"CashoutPage",components:{NumberFormat:K(()=>ee(()=>import("./NumberFormat.fc6956b7.js"),["assets/NumberFormat.fc6956b7.js","assets/index.57d98e6b.js","assets/index.945c03c3.css"]))},data(){return{loading:!1,first_loading:!1,balance:[],can_cashout:!1,payload:["processing_fee","get_bank_account","max_cashout"],bank_account:[],cashout_fee:[],totalCashout:0,label:this.$t("Edit amount")}},setup(){return{Activity:U()}},created(){this.getWalletBalance()},computed:{hasBankaccount(){return Object.keys(this.bank_account).length>0}},methods:{refresh(e){this.getWalletBalance(e)},getWalletBalance(e){this.first_loading?d.showLoadingBox("",this.$q):this.loading=!0,d.fetchDataByTokenPost2("getWalletBalance",{payload:this.payload}).then(a=>{this.first_loading=!0,this.balance=a.details.balance,this.bank_account=a.details.bank_accout,this.cashout_fee=a.details.cashout_fee,this.Activity.money_config=a.details.money_config,this.totalCashout=parseFloat(this.balance.raw),this.totalCashout>0?this.can_cashout=!0:this.can_cashout=!1}).catch(a=>{this.bank_account=[],this.balance=[],this.cashout_fee=[]}).then(a=>{this.loading=!1,d.hideLoadingBox(this.$q),d.empty(e)||e()})},confirmCashout(e){d.showLoadingBox("",this.$q),d.fetchDataByTokenPost("RequestPayout","amount="+this.totalCashout).then(a=>{d.notify("green-5",a.msg,"check_circle",this.$q),this.$router.replace({path:"/account/cashout-succesful",query:{id:a.details}})}).catch(a=>{e.reset(),d.notify("dark",a,"error_outline",this.$q)}).then(a=>{d.hideLoadingBox(this.$q)})},validateCashout(e){return parseFloat(e)>parseFloat(this.balance.raw)?(d.notify("dark",this.$t("Cash out amount should not be greater than earnings"),"error_outline",this.$q),!1):!0}}},de={key:0,class:"flex flex-center full-width q-pa-xl",style:{"min-height":"calc(20vh)"}},he={class:"q-pl-md q-pr-md q-pt-md row items-center"},me={class:"col"},pe={class:"font12"},ve={class:"text-weight-bold text-h6"},_e={class:"col-4 text-right"},be={class:"text-blue font12 cursor-pointer"},ge={class:"q-pl-md q-pr-md q-pt-md"},ye={class:"font12"},ke={class:"row justify-between q-mb-sm"},we={class:"text-weight-medium"},Ce={class:"text-weight-bold text-h7"};function qe(e,a,s,r,l,i){const f=Y("NumberFormat");return p(),S($,null,[t(oe,{class:P({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:o(()=>[t(ae,null,{default:o(()=>[t(y,{onClick:a[0]||(a[0]=n=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),t(te,{class:"text-weight-bold"},{default:o(()=>[v(u(e.$t("Cash out")),1)]),_:1})]),_:1}),t(X)]),_:1},8,["class"]),t(ie,{onRefresh:i.refresh},{default:o(()=>[t(ue,{class:P({"flex flex-center":l.loading})},{default:o(()=>[l.loading?(p(),S("div",de,[t(E,{color:"primary",size:"2em"})])):(p(),S($,{key:1},[c("div",he,[c("div",me,[c("div",pe,u(e.$t("Total earnings")),1),c("div",ve,u(l.balance.pretty),1)]),c("div",_e,[c("div",be,u(e.$t("Edit amount")),1),t(ce,{modelValue:l.totalCashout,"onUpdate:modelValue":a[1]||(a[1]=n=>l.totalCashout=n),"auto-save":"",validate:i.validateCashout},{default:o(n=>[t(Z,{modelValue:n.value,"onUpdate:modelValue":_=>n.value=_,dense:"",autofocus:"",counter:"",onKeyup:G(n.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:1},8,["modelValue","validate"])])]),t(ne,{class:"q-pa-sm"}),t(T,{separator:"",dense:""},{default:o(()=>[t(g,null,{default:o(()=>[t(m,null,{default:o(()=>[v(u(e.$t("Cashout")),1)]),_:1}),t(m,{side:""},{default:o(()=>[t(f,{amount:l.totalCashout},null,8,["amount"])]),_:1})]),_:1}),t(g,null,{default:o(()=>[t(m,null,{default:o(()=>[v(u(e.$t("Processing fee")),1)]),_:1}),t(m,{side:""},{default:o(()=>[v(u(l.cashout_fee.pretty),1)]),_:1})]),_:1}),i.hasBankaccount?(p(),C(g,{key:1},{default:o(()=>[t(m,null,{default:o(()=>[v(u(l.bank_account.account_type)+" - "+u(l.bank_account.account_number),1)]),_:1})]),_:1})):(p(),C(g,{key:0},{default:o(()=>[t(m,null,{default:o(()=>[t(y,{color:"primary",flat:"","no-caps":"",to:"/account/add-bank"},{default:o(()=>[v(u(e.$t("Add Bank Account")),1)]),_:1})]),_:1})]),_:1}))]),_:1}),c("div",ge,[c("p",ye,u(e.$t("After confirming money will be transfered to you bank account"))+". "+u(e.$t("It usually takes 2-4 business days for transfers like this to go through"))+". ",1)]),t(re,{class:"bg-transparent q-pa-md text-dark"},{default:o(()=>[c("div",ke,[c("div",we,u(e.$t("You receive")),1),c("div",Ce,[t(f,{amount:l.totalCashout-l.cashout_fee.value},null,8,["amount"])])]),l.can_cashout&&i.hasBankaccount?(p(),C(T,{key:0,bordered:"",separator:"",class:"radius8"},{default:o(()=>[t(se,{onLeft:i.confirmCashout,"left-color":"light-green-4",class:"radius8"},{left:o(()=>[t(E,{color:"primary",size:"2em"})]),default:o(()=>[t(g,{class:"text-white text-weight-bold btn-11",style:{"background-color":"#f8af01",color:"#fff"}},{default:o(()=>[t(m,{class:"text-center font17"},{default:o(()=>[v(u(e.$t("Confirm Transfer")),1)]),_:1}),t(m,{avatar:""},{default:o(()=>[t(J,{"text-color":"white",style:{"background-color":"#f8af01",color:"#fff"},icon:"las la-arrow-right"})]),_:1})]),_:1})]),_:1},8,["onLeft"])]),_:1})):(p(),C(y,{key:1,color:"primary",size:"lg",label:e.$t("Confirm Transfer"),unelevated:"",class:"fit","no-caps":"",disable:""},null,8,["label"]))]),_:1})],64))]),_:1},8,["class"])]),_:1},8,["onRefresh"])],64)}var Me=z(fe,[["render",qe]]);export{Me as default};
