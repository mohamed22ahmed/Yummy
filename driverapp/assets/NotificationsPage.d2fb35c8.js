import{bb as $,l as k,n as B,bc as L,b0 as g,aW as T,b1 as _,ao as V,_ as H,X as p,q as s,Z as c,f as l,v as n,$ as b,F as f,t as h,a4 as C,a0 as v,a1 as m,aj as P,a2 as I,ae as Q,a3 as x,V as z,a5 as j,a7 as N,af as A,a8 as S,aa as M}from"./index.57d98e6b.js";import{Q as R}from"./QToolbarTitle.f2460359.js";import{Q as E}from"./QToolbar.5785cd51.js";import{Q as F}from"./QHeader.8d398719.js";import{Q as O}from"./QImg.0d589814.js";import{Q as D}from"./QItemLabel.534f2eb0.js";import{Q as U}from"./QList.9b1deb90.js";import{Q as W}from"./QInfiniteScroll.0033dd1c.js";import{Q as X}from"./QPage.76c085e2.js";import{Q as Z}from"./QPullToRefresh.b207fbbb.js";import{c as w}from"./selection.b1db311e.js";import"./QResizeObserver.1c6d7ccc.js";import"./TouchPan.8da352e0.js";import"./format.de7e9769.js";var G=$({name:"touch-hold",beforeMount(t,o){const{modifiers:r}=o;if(r.mouse!==!0&&k.has.touch!==!0)return;const e={handler:o.value,noop:B,mouseStart(a){typeof e.handler=="function"&&L(a)===!0&&(g(e,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),e.start(a,!0))},touchStart(a){if(a.target!==void 0&&typeof e.handler=="function"){const i=a.target;g(e,"temp",[[i,"touchmove","move","passiveCapture"],[i,"touchcancel","end","notPassiveCapture"],[i,"touchend","end","notPassiveCapture"]]),e.start(a)}},start(a,i){e.origin=T(a);const d=Date.now();k.is.mobile===!0&&(document.body.classList.add("non-selectable"),w(),e.styleCleanup=y=>{e.styleCleanup=void 0;const q=()=>{document.body.classList.remove("non-selectable")};y===!0?(w(),setTimeout(q,10)):q()}),e.triggered=!1,e.sensitivity=i===!0?e.mouseSensitivity:e.touchSensitivity,e.timer=setTimeout(()=>{e.timer=void 0,w(),e.triggered=!0,e.handler({evt:a,touch:i!==!0,mouse:i===!0,position:e.origin,duration:Date.now()-d})},e.duration)},move(a){const{top:i,left:d}=T(a);e.timer!==void 0&&(Math.abs(d-e.origin.left)>=e.sensitivity||Math.abs(i-e.origin.top)>=e.sensitivity)&&(clearTimeout(e.timer),e.timer=void 0)},end(a){_(e,"temp"),e.styleCleanup!==void 0&&e.styleCleanup(e.triggered),e.triggered===!0?a!==void 0&&V(a):e.timer!==void 0&&(clearTimeout(e.timer),e.timer=void 0)}},u=[600,5,7];if(typeof o.arg=="string"&&o.arg.length!==0&&o.arg.split(":").forEach((a,i)=>{const d=parseInt(a,10);d&&(u[i]=d)}),[e.duration,e.touchSensitivity,e.mouseSensitivity]=u,t.__qtouchhold=e,r.mouse===!0){const a=r.mouseCapture===!0||r.mousecapture===!0?"Capture":"";g(e,"main",[[t,"mousedown","mouseStart",`passive${a}`]])}k.has.touch===!0&&g(e,"main",[[t,"touchstart","touchStart",`passive${r.capture===!0?"Capture":""}`],[t,"touchend","noop","notPassiveCapture"]])},updated(t,o){const r=t.__qtouchhold;r!==void 0&&o.oldValue!==o.value&&(typeof o.value!="function"&&r.end(),r.handler=o.value)},beforeUnmount(t){const o=t.__qtouchhold;o!==void 0&&(_(o,"main"),_(o,"temp"),o.timer!==void 0&&clearTimeout(o.timer),o.styleCleanup!==void 0&&o.styleCleanup(),delete t.__qtouchhold)}});const J={name:"NotificationsPage",data(){return{loading:!0,data:[],page:0,data_done:!1,hold:!1,notification_uuids:[]}},computed:{hasData(){return Object.keys(this.data).length>0},itemToDelete(){return Object.keys(this.notification_uuids).length}},methods:{getNotifications(t,o){this.loading=!0,p.fetchDataByTokenPost("getNotification","page="+t).then(r=>{this.page=t,this.data.push(r.details.data)}).catch(r=>{this.data_done=!0,this.$refs.nscroll.stop()}).then(r=>{o(),this.loading=!1})},deleteNotification(){p.showLoadingBox("",this.$q),p.fetchDataByToken("deleteNotifications",{data:this.notification_uuids}).then(t=>{this.resetHold(),this.resetPagination()}).catch(t=>{p.notify("red-5",t,"error_outline",this.$q)}).then(t=>{p.hideLoadingBox(this.$q)})},handleHold(t){this.hold=!0},resetHold(){this.hold=!1,this.notification_uuids=[]},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},refresh(t){this.resetPagination(),this.page=0,t()}}},K={key:0,class:"text-center"},Y={class:"font16 text-weight-bold"},ee={class:"font11"},te={class:"flex flex-center full-width q-pa-xl",style:{"min-height":"calc(50vh)"}};function ae(t,o,r,e,u,a){return s(),c(f,null,[l(F,{class:b({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode}),reveal:"","reveal-offset":"50"},{default:n(()=>[l(E,null,{default:n(()=>[u.hold?(s(),h(C,{key:0,onClick:a.resetHold,round:"",dense:"",flat:"",icon:"close",color:"red-5"},null,8,["onClick"])):(s(),h(C,{key:1,onClick:o[0]||(o[0]=i=>t.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:t.$q.dark.mode?"white":"dark"},null,8,["color"])),l(R,{class:"text-grey-10"},{default:n(()=>[u.hold?(s(),c(f,{key:0},[v(m(a.itemToDelete)+" "+m(t.$t("selected")),1)],64)):(s(),c(f,{key:1},[v(m(t.$t("Notifications")),1)],64))]),_:1}),u.hold?(s(),h(C,{key:2,onClick:a.deleteNotification,flat:"",round:"",dense:"",icon:"las la-trash-alt",color:"red-5"},null,8,["onClick"])):P("",!0)]),_:1}),l(I)]),_:1},8,["class"]),l(Z,{onRefresh:a.refresh},{default:n(()=>[l(X,{padding:"",class:b({"flex flex-center":!a.hasData&&!u.loading,"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode})},{default:n(()=>[l(W,{ref:"nscroll",onLoad:a.getNotifications,offset:250},{default:n(()=>[!a.hasData&&!u.loading?(s(),c("div",K,[Q("div",Y,m(t.$t("No available data")),1),Q("p",ee,m(t.$t("Pull down the page to refresh")),1)])):P("",!0),l(U,{separator:"",class:b({"bg-mydark ":t.$q.dark.mode,"bg-white ":!t.$q.dark.mode})},{default:n(()=>[(s(!0),c(f,null,x(u.data,i=>(s(),c(f,{key:i},[(s(!0),c(f,null,x(i,d=>j((s(),h(M,{clickable:"",key:d,tag:"label"},{default:n(()=>[l(N,{avatar:""},{default:n(()=>[u.hold?(s(),h(A,{key:0,modelValue:u.notification_uuids,"onUpdate:modelValue":o[1]||(o[1]=y=>u.notification_uuids=y),val:d.notification_uuid},null,8,["modelValue","val"])):(s(),c(f,{key:1},[d.image_type==="image"?(s(),h(S,{key:0},{default:n(()=>[l(O,{src:d.image,style:{height:"80px",width:"80px"},lazy:"",fit:"cover"},null,8,["src"])]),_:2},1024)):(s(),h(S,{key:1,size:"md",color:"myyellow","text-color":"white",icon:"las la-bell"}))],64))]),_:2},1024),l(N,null,{default:n(()=>[l(D,{class:"text-weight-medium",lines:"1"},{default:n(()=>[v(m(d.date),1)]),_:2},1024),l(D,{caption:"",lines:"2",class:"font11"},{default:n(()=>[v(m(d.message),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[G,a.handleHold,void 0,{mouse:!0}]])),128))],64))),128))]),_:1},8,["class"])]),loading:n(()=>[Q("div",te,[l(z,{color:"primary",size:"2em"})])]),_:1},8,["onLoad"])]),_:1},8,["class"])]),_:1},8,["onRefresh"])],64)}var ve=H(J,[["render",ae]]);export{ve as default};
