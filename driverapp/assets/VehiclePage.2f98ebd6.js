import{_ as q,ar as P,u as Q,X as i,p as A,q as r,Z as p,f as o,v as s,$ as d,F as w,a4 as c,a0 as b,a1 as f,a2 as C,V as $,t as n,ae as u,ah as T,aj as U,al as _,au as D}from"./index.57d98e6b.js";import{Q as B}from"./QToolbarTitle.f2460359.js";import{Q as S}from"./QToolbar.5785cd51.js";import{Q as z}from"./QHeader.8d398719.js";import{Q as k}from"./QImg.0d589814.js";import{Q as v}from"./QSelect.1b1c6dd3.js";import{Q as F}from"./QFooter.9a53d96e.js";import{Q as I}from"./QForm.4d239df2.js";import{Q as E}from"./QPage.76c085e2.js";import{A as y}from"./AppCamera.2e0dc590.js";import"./QResizeObserver.1c6d7ccc.js";import"./QItemLabel.534f2eb0.js";import"./QMenu.3e900caf.js";import"./position-engine.6e2e634f.js";import"./selection.b1db311e.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";const N={name:"VehiclePage",components:{UploaderFile:P(()=>D(()=>import("./UploaderFile.778c5550.js"),["assets/UploaderFile.778c5550.js","assets/index.57d98e6b.js","assets/index.945c03c3.css","assets/QCircularProgress.44787b73.js","assets/format.de7e9769.js"]))},data(){return{loading:!0,vehicle_uuid:"",vehicle_type_id:"",plate_number:"",maker:"",model:"",color:"",photo_data:"",upload_enabled:!1,featured_filename:"",featured_url:"",upload_path:"",has_photo:!1}},setup(){return{Activity:Q()}},created(){this.getVehicle()},computed:{hasPhoto(){return!1},hasData(){return!i.empty(this.featured_url)},hasPhotoData(){return Object.keys(this.photo_data).length>0}},methods:{getVehicle(){this.loading=!0,i.fetchDataByTokenPost("getVehicleInfo").then(e=>{this.vehicle_uuid=e.details.vehicle_uuid,this.vehicle_type_id=e.details.vehicle_type_id,this.vehicle_type_selected=e.details.vehicle_type_selected,this.plate_number=e.details.plate_number,this.maker=e.details.maker,this.model=e.details.model,this.color=e.details.color,this.has_photo=e.details.has_photo,this.featured_filename=e.details.photo,this.upload_path=e.details.path,this.featured_url=e.details.url_photo}).catch(e=>{this.vehicle_uuid="",this.vehicle_type_id="",this.plate_number="",this.maker="",this.model="",this.color=""}).then(e=>{this.loading=!1})},onSubmit(){i.showLoadingBox("",this.$q),i.fetchDataByToken("saveVehicleInfo",{vehicle_uuid:this.vehicle_uuid,vehicle_type_id:this.vehicle_type_id,plate_number:this.plate_number,maker:this.maker,model:this.model,color:this.color,featured_filename:this.featured_filename,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""}).then(e=>{i.notify("green-5",e.msg,"check_circle",this.$q)}).catch(e=>{i.notify("dark",e,"error_outline",this.$q)}).then(e=>{i.hideLoadingBox(this.$q)})},hadData(){return Object.keys(this.photo_data).length>0},takePhoto(){this.$q.capacitor?y.isCameraEnabled().then(e=>{y.isFileAccessEnabled().then(a=>{y.getPhoto(1).then(m=>{this.photo_data=m}).catch(m=>{this.photo_data=[]})}).catch(a=>{i.notify("dark",a,"error",this.$q)})}).catch(e=>{i.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},afterUploadfile(e){this.featured_filename=e.filename,this.featured_url=e.url_image,this.upload_path=e.upload_path,this.has_photo=!0}}},j={key:0,class:"fit text-center"},x={class:"row q-col-gutter-sm q-mb-sm"},M={class:"col"},L={class:"font12 line-normal"},O={class:"text-weight-bold"};function G(e,a,m,g,l,h){const V=A("UploaderFile");return r(),p(w,null,[o(z,{class:d({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:s(()=>[o(S,null,{default:s(()=>[o(c,{onClick:a[0]||(a[0]=t=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),o(B,{class:"text-weight-bold"},{default:s(()=>[b(f(e.$t("Vehicle")),1)]),_:1})]),_:1}),o(C)]),_:1},8,["class"]),o(E,{class:d(["q-pa-md",{"flex flex-center":l.loading}])},{default:s(()=>[l.loading?(r(),p("div",j,[o($,{color:"primary",size:"2em"})])):(r(),n(I,{key:1,onSubmit:h.onSubmit},{default:s(()=>[u("div",x,[l.has_photo?(r(),n(k,{key:0,src:l.featured_url,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):h.hasPhotoData?(r(),n(k,{key:1,src:l.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(r(),p("div",{key:2,class:d(["col-3 row items-center justify-center radius8",{"bg-grey600":e.$q.dark.mode,"bg-mygrey":!e.$q.dark.mode}]),style:{height:"70px"}},[o(T,{name:"las la-image",class:"text-grey",size:"xl"})],2)),u("div",M,[u("div",L,[u("span",O,f(e.$t("Vehicle Photo")),1),b(". "+f(e.$t("Maximum 2MB. Accepted types: PNG. JPG")),1)]),o(c,{label:l.has_photo?this.$t("Change Photo"):h.hasPhotoData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:h.takePhoto},null,8,["label","onClick"])])]),l.upload_enabled?(r(),n(V,{key:0,ref:"uploader_file",path:"upload/vehicle",onAfterUploadfile:h.afterUploadfile},null,8,["onAfterUploadfile"])):U("",!0),o(v,{modelValue:l.vehicle_type_id,"onUpdate:modelValue":a[1]||(a[1]=t=>l.vehicle_type_id=t),options:g.Activity.vehicle_type,label:e.$t("Vehicle type"),outlined:"",color:"grey-5",rules:[t=>t||this.$t("This field is required")],behavior:"dialog","emit-value":"","map-options":"","transition-show":"fade","transition-hide":"fade"},null,8,["modelValue","options","label","rules"]),o(_,{modelValue:l.plate_number,"onUpdate:modelValue":a[2]||(a[2]=t=>l.plate_number=t),label:e.$t("Plate number"),outlined:"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(v,{modelValue:l.maker,"onUpdate:modelValue":a[3]||(a[3]=t=>l.maker=t),label:e.$t("Maker"),options:g.Activity.vehicle_maker,outlined:"",color:"grey-5",rules:[t=>t||this.$t("This field is required")],behavior:"dialog","emit-value":"","map-options":""},null,8,["modelValue","label","options","rules"]),o(_,{modelValue:l.model,"onUpdate:modelValue":a[4]||(a[4]=t=>l.model=t),label:e.$t("Model"),outlined:"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(_,{modelValue:l.color,"onUpdate:modelValue":a[5]||(a[5]=t=>l.color=t),label:e.$t("Color"),outlined:"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(F,{class:d(["q-pa-md",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:s(()=>[o(c,{type:"submit",color:"primary","text-color":"white",label:e.$t("Submit"),unelevated:"",class:"full-width",size:"lg","no-caps":"",loading:l.loading},null,8,["label","loading"])]),_:1},8,["class"])]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var de=q(N,[["render",G]]);export{de as default};
