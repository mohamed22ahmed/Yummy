import{_ as h,X as t,q as m,Z as f,f as s,v as r,$ as u,F as p,a4 as d,a0 as g,a1 as l,a2 as _,ae as i,al as v}from"./index.57d98e6b.js";import{Q as b}from"./QToolbarTitle.f2460359.js";import{Q as q}from"./QToolbar.5785cd51.js";import{Q as $}from"./QHeader.8d398719.js";import{Q as k}from"./QSpace.6257f203.js";import{Q as y}from"./QFooter.9a53d96e.js";import{Q}from"./QForm.4d239df2.js";import{Q as w}from"./QPage.76c085e2.js";import"./QResizeObserver.1c6d7ccc.js";const C={data(){return{loading:!1,code:"",counter:0,signup_resend_counter:0,driver_uuid:"",sent_message:"",timer:void 0}},created(){this.driver_uuid=this.$route.query.uuid},mounted(){this.$refs.code.focus(),this.getAccountStatus()},watch:{counter(e,a){e<=0&&this.stopTimer()}},methods:{startTimer(){this.stopTimer(),this.timer=setInterval(()=>{this.counter--},1e3)},stopTimer(){clearInterval(this.timer)},getAccountStatus(){t.showLoadingBox("",this.$q),t.getAccountStatus(this.driver_uuid).then(e=>{this.sent_message=e.msg,this.counter=e.details.settings.signup_resend_counter,this.signup_resend_counter=this.counter,console.debug(e.details.data.status),console.debug(e.details.data.account_verified),e.details.data.account_verified==1,this.startTimer(),t.empty(e.details.otp)||t.notify("green-5",e.details.otp,"check_circle",this.$q)}).catch(e=>{t.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1,t.hideLoadingBox(this.$q)})},onSubmit(){this.loading=!0,t.verifyCode({driver_uuid:this.driver_uuid,code:this.code}).then(e=>{this.$router.push({path:"/account/attach_license",query:{uuid:this.driver_uuid}})}).catch(e=>{t.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})},resendCode(){t.showLoadingBox("",this.$q),t.requestCode({driver_uuid:this.driver_uuid}).then(e=>{this.counter=this.signup_resend_counter,this.startTimer(),t.notify("green-5",e.msg,"check_circle",this.$q),t.empty(e.details)||t.empty(e.details.otp)||t.notify("green-5",e.details.otp,"check_circle",this.$q)}).catch(e=>{t.notify("dark",e,"error",this.$q)}).then(e=>{t.hideLoadingBox(this.$q)})}}},S={class:"q-pa-lg"},T={class:"text-verification line-normal"},V={class:"no-margin font13 line-normal"},B={class:"row items-center q-pa-sm"},x={class:"col"},A={class:"countdown text-black"},F={class:"col text-right"};function I(e,a,L,z,o,c){return m(),f(p,null,[s($,{class:u({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:r(()=>[s(q,null,{default:r(()=>[s(d,{onClick:a[0]||(a[0]=n=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),s(b,{class:"text-weight-bold"},{default:r(()=>[g(l(e.$t("Verification")),1)]),_:1})]),_:1}),s(_)]),_:1},8,["class"]),s(w,{class:"flex flex-center q-pl-md q-pr-md"},{default:r(()=>[s(Q,{onSubmit:c.onSubmit},{default:r(()=>[i("div",S,[i("p",T,l(e.$t("Enter verification code we've sent on given number")),1),i("p",V,l(o.sent_message),1),s(k,{class:"q-pa-md"}),s(v,{ref:"code",label:e.$t("Enter verification code"),modelValue:o.code,"onUpdate:modelValue":a[1]||(a[1]=n=>o.code=n),color:"grey-5",mask:"####","lazy-rules":"",rules:[n=>n&&n.length>0||this.$t("This field is required")]},null,8,["label","modelValue","rules"])]),s(y,{class:u(["q-pa-md",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:r(()=>[i("div",B,[i("div",x,[i("div",A,l(e.$t("Resend Code in"))+" "+l(o.counter),1)]),i("div",F,[s(d,{disable:o.counter!=0,onClick:c.resendCode,flat:"",class:"btn-resend",label:e.$t("Resend"),"no-caps":""},null,8,["disable","onClick","label"])])]),s(d,{type:"submit",color:"primary","text-color":"white",label:e.$t("Submit"),unelevated:"",class:"full-width",size:"lg","no-caps":"",loading:o.loading},null,8,["label","loading"])]),_:1},8,["class"])]),_:1},8,["onSubmit"])]),_:1})],64)}var j=h(C,[["render",I]]);export{j as default};
