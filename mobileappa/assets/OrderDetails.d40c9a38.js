import{_ as S,l as Q,m as h,n as C,p as l,q as g,s as t,f as e,X as k,a5 as u,Y as r,a6 as z,U as n,ab as f,ac as d,S as _,b3 as $,as as q,az as m,F as c,V as v,a7 as L,b1 as D,bD as A,t as O}from"./index.4c3eb750.js";import{Q as P}from"./QToolbarTitle.eef0f00f.js";import{Q as V}from"./QToolbar.45531803.js";import{Q as E}from"./QHeader.d51d9950.js";import{Q as F}from"./QInnerLoading.488297dd.js";import{Q as p}from"./QItemLabel.cc035d74.js";import{Q as I}from"./QChip.0b7ba82a.js";import{Q as x}from"./QList.5b181e45.js";import{Q as N}from"./QExpansionItem.88397ee9.js";import{Q as H}from"./QImg.721b5b7a.js";import{Q as M}from"./QBadge.df254e4a.js";import{Q as U}from"./QPage.959871c7.js";import{Q as j}from"./QFooter.bd11e2a3.js";import{Q as G}from"./QPullToRefresh.1e0c7d6e.js";import{u as W}from"./DeliverySched.57b613f9.js";import"./QResizeObserver.4d611c44.js";import"./QSlideTransition.1b723af0.js";import"./touch.9135741d.js";import"./selection.1ed6461a.js";import"./format.8ac60962.js";const X={name:"OrderDetails",components:{CancelOrder:Q(()=>O(()=>import("./CancelOrder.f27ef5f9.js"),["assets/CancelOrder.f27ef5f9.js","assets/QSpace.5a38bd33.js","assets/index.4c3eb750.js","assets/index.4784a50d.css","assets/ClosePopup.d9033651.js"])),OrderDeliveryDetails:Q(()=>O(()=>import("./OrderDeliveryDetails.7d8553be.js"),["assets/OrderDeliveryDetails.7d8553be.js","assets/QToolbarTitle.eef0f00f.js","assets/index.4c3eb750.js","assets/index.4784a50d.css","assets/QSpace.5a38bd33.js","assets/QToolbar.45531803.js"]))},setup(){return{DeliveryschedStore:W()}},data(){return{order_uuid:"",order_data:[],loading:!1,order_items:[],order_summary:[],order_info:[],order_label:[],refund_transaction:[],order_status:[],order_services:[],merchant:[],progress:0,data_progress:[],progress_order_status:"",progress_order_status_details:"",allowed_to_cancel:!1,pdf_link:"",delivery_timeline:[],order_delivery_status:[],allowed_to_review:!1,payload:["merchant_info","items","summary","order_info","progress","refund_transaction","status_allowed_cancelled","pdf_link","delivery_timeline","order_delivery_status","allowed_to_review"],order_table_data:[]}},created(){this.order_uuid=this.$route.query.order_uuid,this.orderDetails()},computed:{hasRefund(){return this.refund_transaction.length>0},hasTableInfo(){return Object.keys(this.order_table_data).length>0}},methods:{refresh(s){this.orderDetails(s)},orderDetails(s){this.loading=!0,h.fetchDataByToken("orderDetails",{order_uuid:this.order_uuid,payload:this.payload}).then(a=>{this.order_data=a.details,this.merchant=a.details.data.merchant,this.order_items=a.details.data.items,this.order_summary=a.details.data.summary,this.order_info=a.details.data.order.order_info,this.order_label=a.details.data.label,this.refund_transaction=a.details.data.refund_transaction,this.order_status=a.details.data.order.status,this.order_services=a.details.data.order.services,this.data_progress=a.details.data.progress,this.progress=a.details.data.progress.order_progress,this.allowed_to_cancel=a.details.data.allowed_to_cancel,this.pdf_link=a.details.data.pdf_link,this.delivery_timeline=a.details.data.delivery_timeline,this.order_delivery_status=a.details.data.order_delivery_status,this.allowed_to_review=a.details.data.allowed_to_review,this.order_table_data=a.details.data.order_table_data,this.progress_order_status=a.details.data.progress.order_status,this.progress_order_status_details=a.details.data.progress.order_status_details,this.order_services=this.order_services[this.order_info.service_code],this.order_status=this.order_status[this.order_info.status]}).catch(a=>{h.notify("dark",a,"error",this.$q)}).then(a=>{this.loading=!1,h.empty(s)||s()})},afterReceive(s){if(s.order_id!==this.order_info.order_id)return!1;s.order_progress===0?(this.progress=s.order_progress,this.progress_order_status=s.order_status,this.progress_order_status_details=s.order_status_details):s.order_progress===-1||(this.progress=s.order_progress,this.progress_order_status=s.order_status,this.progress_order_status_details=s.order_status_details)},defineColors(s){return this.progress<=0?"grey-8":this.progress>s?"primary":"grey-4"},copyClipboard(s){navigator.clipboard.writeText(s),h.notify("light-green","Copied","check_circle",this.$q)},Buyagain(){const s={cart_uuid:h.getStorage("cart_uuid"),order_uuid:this.order_uuid};h.showLoadingBox("",this.$q),h.orderBuyAgain(s).then(a=>{this.DeliveryschedStore.transaction_type=a.details.restaurant_slug,h.setStorage("cart_uuid",a.details.cart_uuid),this.$router.push("/cart")}).catch(a=>{h.notify("grey-8",a,"error_outline",this.$q)}).then(a=>{h.hideLoadingBox(this.$q)})},afterCancelorder(){console.debug("afterCancelorder"),this.$refs.cancel_order.show_modal=!1,this.orderDetails()}}},Y={class:"q-mr-sm text-weight-bold"},J={class:"text-weight-bold"},K={class:"text-weight-light font11"},Z={class:"text-weight-bold"},ee={class:"text-weight-light font11"},te={class:"text-weight-bold"},re={class:"text-weight-light font11"},se={class:"text-weight-bold text-blue"},ae={class:"text-weight-bold"},oe={class:"text-weight-light"},le={class:"text-weight-light"},ie={class:"text-weight-light"},de={class:"no-margin"},ne=["innerHTML"],_e={class:"m-0 text-grey"},ue={key:0,class:"no-margin"},ce={key:1,class:"no-margin"},pe={key:2,class:"no-margin"},fe=u(", "),he={key:0,class:"no-margin"},me={key:1,class:"no-margin"},ge={class:"no-margin font12 text-weight-bold"},ye={class:"row full-width items-center text-center"},be={class:"col"},ve={class:"col"};function ke(s,a,we,qe,i,w){const T=C("CancelOrder"),R=C("OrderDeliveryDetails");return l(),g(G,{onRefresh:w.refresh},{default:t(()=>[e(E,{reveal:"","reveal-offset":"50",class:z(["",{"bg-mydark text-white":s.$q.dark.mode,"bg-grey-1 text-dark":!s.$q.dark.mode}])},{default:t(()=>[e(V,null,{default:t(()=>[e(k,{onClick:a[0]||(a[0]=o=>s.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:s.$q.dark.mode?"white":"dark"},null,8,["color"]),e(P,{class:"text-weight-bold"},{default:t(()=>[u(r(s.$t("Orders Details")),1)]),_:1})]),_:1})]),_:1},8,["class"]),e(U,{class:z(["b q-pl-md q-pr-md q-pb-md",{"bg-mydark text-white":s.$q.dark.mode,"bg-grey-1 text-dark":!s.$q.dark.mode}])},{default:t(()=>[i.loading?(l(),g(F,{key:0,showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})):(l(),n(c,{key:1},[e(x,null,{default:t(()=>[e(f,{class:"q-pl-none q-pr-none"},{default:t(()=>[e(d,null,{default:t(()=>[e(p,{class:"text-dark text-weight-bold"},{default:t(()=>[u(r(s.$t("Order ID")),1)]),_:1}),e(p,{caption:"",class:"font12"},{default:t(()=>[_("span",Y,"#"+r(i.order_info.order_id),1),e(I,{color:s.$q.dark.mode?"grey600":"mygrey","text-color":s.$q.dark.mode?"grey300":"dark",size:"sm",class:"q-ma-none"},{default:t(()=>[u(r(i.order_services.service_name),1)]),_:1},8,["color","text-color"])]),_:1}),e(p,{caption:"",class:"font12"},{default:t(()=>[_("div",J,r(i.order_info.payment_name),1),_("div",K,r(i.order_info.place_on),1)]),_:1})]),_:1}),e(d,{side:"",top:""},{default:t(()=>[e(I,{color:"mygrey","text-color":"dark",size:"sm",style:$(`color:${i.order_status.font_color_hex} !important; background-color:${i.order_status.background_color_hex} !important; `),class:"q-ma-none"},{default:t(()=>[u(r(i.order_status.status),1)]),_:1},8,["style"])]),_:1})]),_:1}),e(f,{onClick:a[1]||(a[1]=o=>this.$refs.OrderDeliveryDetails.dialog=!0),clickable:"",class:"q-pl-none q-pr-none q-pt-none"},{default:t(()=>[e(d,null,{default:t(()=>[e(p,{caption:"",class:"font12"},{default:t(()=>[_("div",Z,r(i.progress_order_status),1),_("div",ee,r(i.progress_order_status_details),1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e(q,{color:"grey",size:"15px",name:"las la-angle-right"})]),_:1})]),_:1}),i.allowed_to_review?(l(),g(f,{key:0,to:{path:"/order/write-review",query:{order_uuid:i.order_info.order_uuid,back_url:"/orders",order_id:i.order_info.order_id}},clickable:"",class:"q-pl-none q-pr-none q-pt-none"},{default:t(()=>[e(d,null,{default:t(()=>[e(p,{caption:"",class:"font12"},{default:t(()=>[_("div",te,r(s.$t("Write Review")),1),_("div",re,r(s.$t("Rate your order"))+"! ",1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e(q,{color:"grey",size:"15px",name:"las la-angle-right"})]),_:1})]),_:1},8,["to"])):m("",!0),i.order_info.upload_deposit_link?(l(),g(f,{key:1,to:{path:"/account/upload-deposit",query:{order_uuid:this.order_uuid}},clickable:"",class:"q-pl-none q-pr-none q-pt-none"},{default:t(()=>[e(d,{caption:"",class:"font12"},{default:t(()=>[_("div",se,r(s.$t("Upload bank deposit")),1)]),_:1}),e(d,{avatar:""},{default:t(()=>[e(q,{color:"grey",size:"15px",name:"las la-angle-right"})]),_:1})]),_:1},8,["to"])):m("",!0)]),_:1}),w.hasRefund?(l(),g(x,{key:0,class:"qlist-no-padding"},{default:t(()=>[e(N,{"expand-separator":"",label:"Refund Issued"},{default:t(()=>[e(x,null,{default:t(()=>[e(f,null,{default:t(()=>[e(d,null,{default:t(()=>[(l(!0),n(c,null,v(i.refund_transaction,o=>(l(),n(c,{key:o},[e(p,{caption:"",class:"font12"},{default:t(()=>[u(r(s.$t("Description"))+": "+r(o.description),1)]),_:2},1024),e(p,{caption:"",class:"font12"},{default:t(()=>[u(r(s.$t("Amount"))+": "+r(o.trans_amount),1)]),_:2},1024),e(p,{caption:"",class:"font12"},{default:t(()=>[u(r(s.$t("Issued to"))+": "+r(o.used_card),1)]),_:2},1024),e(p,{caption:"",class:"font12"},{default:t(()=>[u(r(s.$t("Date issued"))+": "+r(o.date),1)]),_:2},1024)],64))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):m("",!0),w.hasTableInfo?(l(),g(x,{key:1},{default:t(()=>[e(f,{class:"q-pl-none q-pr-none q-pt-none"},{default:t(()=>[e(p,{caption:"",class:"font12"},{default:t(()=>[_("div",ae,r(s.$t("Table information")),1),_("div",oe,r(s.$t("Guest"))+" : "+r(i.order_table_data.guest_number),1),_("div",le,r(s.$t("Room name"))+" : "+r(i.order_table_data.room_name),1),_("div",ie,r(s.$t("Table name"))+" : "+r(i.order_table_data.table_name),1)]),_:1})]),_:1})]),_:1})):m("",!0),e(L,{flat:"",class:"radius8"},{default:t(()=>[e(x,{class:"q-pb-md"},{default:t(()=>[e(f,null,{default:t(()=>[e(d,null,{default:t(()=>[e(p,{lines:"1",class:"text-weight-medium text-grey font13"},{default:t(()=>[u(r(i.order_label.your_order_from)+" :",1)]),_:1})]),_:1}),e(d,{side:""},{default:t(()=>[e(p,{lines:"1",class:"text-weight-bold font13"},{default:t(()=>[e(k,{flat:"",unelevated:"","no-caps":"",class:"q-pa-none min-height",to:{name:"menu",params:{slug:i.merchant.restaurant_slug}}},{default:t(()=>[u(r(i.merchant.restaurant_name),1)]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),(l(!0),n(c,null,v(i.order_items,o=>(l(),n(c,{key:o.item_id},[e(f,null,{default:t(()=>[e(d,{avatar:"",top:""},{default:t(()=>[e(H,{src:o.url_image,lazy:"",fit:"cover",style:{height:"50px",width:"50px"},class:"rounded-borders"},null,8,["src"])]),_:2},1024),e(d,null,{default:t(()=>[e(p,{class:"text-weight-bold q-mb-xs font12"},{default:t(()=>[_("p",de,[u(r(o.qty)+" x ",1),_("span",{innerHTML:o.item_name},null,8,ne),o.price.size_name!=""?(l(),n(c,{key:0},[u(" ("+r(o.price.size_name)+") ",1)],64)):m("",!0),o.item_changes=="replacement"?(l(),n(c,{key:1},[_("div",_e,r(s.$t("Replace"))+' "'+r(o.item_name_replace)+'" ',1),e(M,{color:"primary","text-color":"white",label:s.$t("Replacement")},null,8,["label"])],64)):m("",!0)])]),_:2},1024),e(p,{caption:"",class:"text-weight-medium font12"},{default:t(()=>[o.price.discount>0?(l(),n("p",ue,[_("del",null,r(o.price.pretty_price),1),u(" "+r(o.price.pretty_price_after_discount),1)])):(l(),n("p",ce,r(o.price.pretty_price),1)),o.special_instructions!=""?(l(),n("p",pe,r(o.special_instructions),1)):m("",!0),o.attributes!=""?(l(!0),n(c,{key:3},v(o.attributes,y=>(l(),n("p",{key:y,class:"no-margin"},[(l(!0),n(c,null,v(y,(b,B)=>(l(),n(c,null,[u(r(b),1),B<y.length-1?(l(),n(c,{key:0},[fe],64)):m("",!0)],64))),256))]))),128)):m("",!0)]),_:2},1024)]),_:2},1024),e(d,{side:"",top:""},{default:t(()=>[e(p,{caption:"",class:"text-weight-bold font12"},{default:t(()=>[o.price.discount<=0?(l(),n("p",he,r(o.price.pretty_total),1)):(l(),n("p",me,r(o.price.pretty_total_after_discount),1))]),_:2},1024)]),_:2},1024)]),_:2},1024),(l(!0),n(c,null,v(o.addons,y=>(l(),n(c,{key:y},[e(f,{class:"q-item-small"},{default:t(()=>[e(d,{avatar:""}),e(d,null,{default:t(()=>[e(p,{class:"text-weight-bold font12"},{default:t(()=>[u(r(y.subcategory_name),1)]),_:2},1024)]),_:2},1024),e(d,{side:"",top:""})]),_:2},1024),(l(!0),n(c,null,v(y.addon_items,b=>(l(),g(f,{key:b,class:"q-item-small"},{default:t(()=>[e(d,{avatar:""}),e(d,null,{default:t(()=>[e(p,{lines:"1",class:"font12 text-weight-medium"},{default:t(()=>[u(r(b.qty)+" x "+r(b.pretty_price)+" "+r(b.sub_item_name),1)]),_:2},1024)]),_:2},1024),e(d,{side:"",top:""},{default:t(()=>[_("p",ge,r(b.pretty_addons_total),1)]),_:2},1024)]),_:2},1024))),128))],64))),128)),e(D,{inset:""})],64))),128)),e(f,{class:"q-pb-none",style:{"min-height":"auto"}},{default:t(()=>[e(d,{class:"text-weight-medium font13"},{default:t(()=>[u(r(s.$t("Summary")),1)]),_:1})]),_:1}),(l(!0),n(c,null,v(i.order_summary,o=>(l(),n(c,{key:o.name},[o.type=="total"?(l(),n(c,{key:0},[e(D,{spaced:"",inset:""}),e(f,{dense:"",class:"q-pb-none",style:{"min-height":"auto"}},{default:t(()=>[e(d,{class:"font13 text-weight-medium"},{default:t(()=>[u(r(o.name),1)]),_:2},1024),e(d,{side:"",class:"font13 text-weight-medium"},{default:t(()=>[u(r(o.value),1)]),_:2},1024)]),_:2},1024)],64)):(l(),g(f,{key:1,dense:"",class:"q-pb-none",style:{"min-height":"auto"}},{default:t(()=>[e(d,{class:"font13 text-weight-medium"},{default:t(()=>[u(r(o.name),1)]),_:2},1024),e(d,{side:"",class:"font13 text-weight-medium"},{default:t(()=>[u(r(o.value),1)]),_:2},1024)]),_:2},1024))],64))),128))]),_:1}),e(D),e(A,null,{default:t(()=>[_("div",ye,[_("div",be,[e(k,{flat:"","no-caps":"",class:"q-pa-none text-weight-bold line-1 min-height",color:"secondary",disable:!i.allowed_to_cancel,onClick:a[2]||(a[2]=o=>this.$refs.cancel_order.showModal(this.order_uuid))},{default:t(()=>[_("div",null,r(s.$t("Cancel")),1),e(q,{right:"",name:"las la-angle-right",size:"15px",class:"text-grey q-ml-sm"})]),_:1},8,["disable"])]),_("div",ve,[e(k,{flat:"","no-caps":"",class:"q-pa-none text-weight-bold line-1 min-height",color:"grey",href:i.pdf_link,target:"_blank"},{default:t(()=>[_("div",null,r(s.$t("Download PDF")),1),e(q,{right:"",name:"las la-angle-right",size:"15px",class:"text-grey q-ml-sm"})]),_:1},8,["href"])])])]),_:1})]),_:1})],64))]),_:1},8,["class"]),e(T,{ref:"cancel_order",onAfterCancelorder:w.afterCancelorder},null,8,["onAfterCancelorder"]),e(R,{ref:"OrderDeliveryDetails",data:i.delivery_timeline,order_status:i.order_delivery_status,progress:i.data_progress},null,8,["data","order_status","progress"]),i.loading?m("",!0):(l(),g(j,{key:0,class:"bg-grey-1 row q-gutter-md q-pl-md q-pr-md q-pb-sm"},{default:t(()=>[e(k,{label:i.order_label.buy_again,unelevated:"","no-caps":"",color:"mygrey","text-color":"dark",class:"col",onClick:a[3]||(a[3]=o=>w.Buyagain()),size:"lg"},null,8,["label"]),e(k,{to:{path:"/account/trackorder",query:{order_uuid:this.order_uuid,back_url:1}},label:i.order_label.track,unelevated:"","no-caps":"",color:"primary text-white",class:"col",size:"lg"},null,8,["to","label"])]),_:1}))]),_:1},8,["onRefresh"])}var Me=S(X,[["render",ke]]);export{Me as default};
