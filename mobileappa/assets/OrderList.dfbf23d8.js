import{_ as D,l as L,m as P,n as w,p as o,U as c,f as t,s as r,aA as I,F as p,a6 as v,X as y,a5 as h,Y as l,q as _,S as m,az as f,V as b,a7 as S,a8 as C,aX as N,t as T,aE as $,b3 as B,b1 as R,as as j,ab as V,ac as q}from"./index.4c3eb750.js";import{Q as A}from"./QToolbarTitle.eef0f00f.js";import{Q as E}from"./QToolbar.45531803.js";import{Q as M}from"./QHeader.d51d9950.js";import{Q as g}from"./QChip.0b7ba82a.js";import{Q as U}from"./QItemLabel.cc035d74.js";import{Q as H}from"./QRating.938cf6d9.js";import{Q as F}from"./QList.5b181e45.js";import{Q as Y}from"./QInnerLoading.488297dd.js";import{Q as X}from"./QSpinnerDots.27b56c3e.js";import{Q as G}from"./QInfiniteScroll.7f30e01e.js";import{Q as J}from"./QPageScroller.62333d8f.js";import{Q as K}from"./QPage.959871c7.js";import{Q as W}from"./QPullToRefresh.1e0c7d6e.js";import{Q as Z}from"./QForm.ce1b13be.js";import{S as ee,a as se}from"./swiper-slide.172c9bc8.js";/* empty css                   */import"./QResizeObserver.4d611c44.js";import"./format.8ac60962.js";import"./use-page-sticky.9d6b41d8.js";import"./touch.9135741d.js";import"./selection.1ed6461a.js";const te={name:"OrderList",components:{Swiper:ee,SwiperSlide:se,OrderPreview:L(()=>T(()=>import("./OrderPreview.00c409c0.js"),["assets/OrderPreview.00c409c0.js","assets/index.4c3eb750.js","assets/index.4784a50d.css","assets/QToolbarTitle.eef0f00f.js","assets/QSpace.5a38bd33.js","assets/QToolbar.45531803.js","assets/QImg.721b5b7a.js","assets/QItemLabel.cc035d74.js","assets/QList.5b181e45.js"]))},data(){return{q:"",data:[],loading:!1,load_more:!1,page:0,merchants:[],services:[],payment_list:[],payment_status:[],status_list:[],order_tab:"all",modal_search:!1,is_search:!1,is_refresh:void 0,order_items:[],items:{},status_allowed_review:[],reviews:[],rate_value:[],orderTabs:[{label:this.$t("All"),value:"all"},{label:this.$t("Active"),value:"active"},{label:this.$t("Past Order"),value:"past_order"},{label:this.$t("Cancel Order"),value:"cancel_order"}]}},watch:{order_tab(e,n){this.resetPage()}},computed:{hasData(){return this.data.length>0},NodataMessage(){return this.is_search?"No results found":this.order_tab=="all"?"You don't have any orders here!":"No results"},NodataMessage2(){return this.is_search?"Sorry, we couldn't find any results":this.order_tab=="all"?"Let's change that":"no current order with this status"}},methods:{refresh(e){this.resetPage(),this.is_refresh=e},orderHistory(e,n){this.loading=!0,this.page=e,P.fetchDataByTokenPost("orderHistory","page="+e+"&q="+this.q+"&order_tab="+this.order_tab).then(i=>{i.details.show_next_page==!1&&e>1?this.$refs.nscroll.stop():(this.data.push(i.details.data.data),Object.entries(i.details.data.merchants).forEach(([k,s])=>{this.merchants[k]=s}),this.services=i.details.data.services,this.payment_list=i.details.payment_list,this.status_list=i.details.data.status,this.payment_status=i.details.payment_status,this.status_allowed_review=i.details.data.status_allowed_review,this.reviews=i.details.data.reviews,Object.entries(i.details.data.items2).forEach(([k,s])=>{this.items[k]=s}))}).catch(i=>{this.$refs.nscroll&&this.$refs.nscroll.stop()}).then(i=>{this.loading=!1,n(),P.empty(this.is_refresh)||this.is_refresh()})},onSubmit(){console.log("onSubmit"),this.modal_search=!1,this.is_search=!0,this.resetPagination()},resetPage(){this.q="",this.resetPagination(),this.is_search=!1},resetPagination(){this.page=0,this.data=[],this.services=[],this.payment_list=[],this.status_list=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},showQuickDetails(e){this.order_items=e,this.$refs.OrderPreview.dialog=!this.$refs.OrderPreview.dialog},setRateValue(e,n,i){this.$router.push({path:"/order/write-review",query:{order_uuid:n,rate:e,order_id:i,back_url:"/account/allorder"}})}}},re={class:"q-pl-md q-pr-md text-center q-pt-sm"},ae={key:0,class:"text-h5 text-weight-bold"},oe={key:0,class:"flex flex-center",style:{"min-height":"300px"}},le={class:"text-center full-width"},ie={class:"text-h5 text-weight-bold"},de={class:"text-grey font12"},ne={class:"row justify-between items-center"},ce={class:"font13"},me={class:"text-secondary q-ml-sm text-weight-bold"},ue={class:"row justify-between items-center"},_e={key:0,class:"font13"},he={class:"text-weight-bold font13"},fe={class:"row justify-between items-center"},pe={class:"font13"},ye={key:0,class:"font12"},ge={class:"row items-center"},ke={key:0,class:"q-pa-sm flex flex-center text-caption text-grey"},ve={class:"text-weight-bold"},we={key:1,class:"row justify-center absolute-bottom"};function be(e,n,i,k,s,u){const O=w("swiper-slide"),x=w("swiper"),z=w("OrderPreview");return o(),c(p,null,[t(W,{onRefresh:u.refresh},{default:r(()=>[t(M,{reveal:"","reveal-offset":"10",class:v({"bg-mydark text-white":e.$q.dark.mode,"bg-grey-1 text-black":!e.$q.dark.mode})},{default:r(()=>[t(E,null,{default:r(()=>[t(y,{onClick:n[0]||(n[0]=d=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),t(A,{class:"text-weight-bold"},{default:r(()=>[h(l(e.$t("Orders")),1)]),_:1}),s.is_search?(o(),_(y,{key:0,flat:"",round:"",dense:"",icon:"close",onClick:u.resetPage},null,8,["onClick"])):(o(),_(y,{key:1,onClick:n[1]||(n[1]=d=>s.modal_search=!s.modal_search),flat:"",round:"",dense:"",icon:"search"}))]),_:1})]),_:1},8,["class"]),t(K,{class:v({"bg-mydark":e.$q.dark.mode,"bg-grey-1":!e.$q.dark.mode})},{default:r(()=>[t(G,{ref:"nscroll",onLoad:u.orderHistory,offset:250},{loading:r(()=>[s.page<=1?(o(),_(Y,{key:0,showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})):(o(),c("div",we,[t(X,{color:"secondary",size:"40px"})]))]),default:r(()=>[m("div",re,[s.is_search?(o(),c(p,{key:0},[u.hasData?(o(),c("div",ae,l(e.$t("Search result")),1)):f("",!0)],64)):(o(),_(x,{key:1,slidesPerView:2.3,spaceBetween:10,class:"q-mb-md"},{default:r(()=>[(o(!0),c(p,null,b(s.orderTabs,d=>(o(),_(O,{key:d,class:"row"},{default:r(()=>[t(y,{unelevated:"","no-caps":"",class:"radius8 fit",size:"md",label:d.label,onClick:a=>s.order_tab=d.value,color:s.order_tab==d.value?"primary":e.$q.dark.mode?"grey600":"mygrey","text-color":s.order_tab==d.value?"white":e.$q.dark.mode?"grey300":"dark"},null,8,["label","onClick","color","text-color"])]),_:2},1024))),128))]),_:1},8,["slidesPerView"]))]),!u.hasData&&!s.loading?(o(),c("div",oe,[m("div",le,[m("div",ie,l(u.NodataMessage),1),m("p",de,l(u.NodataMessage2),1)])])):f("",!0),t(F,null,{default:r(()=>[(o(!0),c(p,null,b(s.data,d=>(o(),c(p,{key:d},[(o(!0),c(p,null,b(d,a=>(o(),_(V,{key:a.order_id_raw,clickable:""},{default:r(()=>[t(S,{flat:"",class:"fit radius8"},{default:r(()=>[t(C,{class:"q-pl-md q-pr-md q-pt-sm q-pb-sm",onClick:$(Q=>u.showQuickDetails(a),["stop"])},{default:r(()=>[m("div",ne,[t(g,{icon:"las la-calendar",color:e.$q.dark.mode?"grey600":"white","text-color":e.$q.dark.mode?"grey300":"grey",size:"sm",class:v({"":e.$q.dark.mode,"q-pl-none":!e.$q.dark.mode})},{default:r(()=>[h(l(a.date_created),1)]),_:2},1032,["color","text-color","class"]),s.status_list[a.status]?(o(),_(g,{key:0,color:"mygrey","text-color":"dark",size:"sm",style:B(`color:${s.status_list[a.status].font_color_hex} !important; background-color:${s.status_list[a.status].background_color_hex} !important; `)},{default:r(()=>[h(l(s.status_list[a.status].status),1)]),_:2},1032,["style"])):f("",!0)]),m("div",ce,[h(l(e.$t("Order ID")),1),m("span",me,"#"+l(a.order_id_raw),1)]),m("div",ue,[s.merchants[a.merchant_id]?(o(),c("div",_e,l(s.merchants[a.merchant_id].restaurant_name),1)):f("",!0),m("div",he,l(a.total),1)]),m("div",fe,[m("div",pe,l(e.$t("Payment")),1),s.payment_list[a.payment_code]?(o(),c("div",ye,l(s.payment_list[a.payment_code]),1)):f("",!0)]),m("div",ge,[t(g,{color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",size:"sm"},{default:r(()=>[h(l(a.total_items),1)]),_:2},1032,["color","text-color"]),s.services[a.service_code]?(o(),_(g,{key:0,color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",size:"sm"},{default:r(()=>[h(l(s.services[a.service_code].service_name),1)]),_:2},1032,["color","text-color"])):f("",!0),s.payment_status[a.payment_status]?(o(),_(g,{key:1,color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",size:"sm"},{default:r(()=>[h(l(s.payment_status[a.payment_status].title),1)]),_:2},1032,["color","text-color"])):f("",!0)])]),_:2},1032,["onClick"]),s.status_allowed_review.includes(a.status)?(o(),c(p,{key:0},[t(R),s.reviews[a.order_id_raw]?(o(),c("div",ke,[h(l(e.$t("You have rated this"))+" ",1),t(j,{name:"star",size:"2em",color:"yellow-9"}),m("span",ve,l(s.reviews[a.order_id_raw]),1)])):(o(),_(V,{key:1},{default:r(()=>[t(q,{avatar:""},{default:r(()=>[t(U,{caption:""},{default:r(()=>[h(l(e.$t("Tap to rate")),1)]),_:1})]),_:1}),t(q,null,{default:r(()=>[t(H,{"model-value":s.rate_value[a.order_uuid],size:"2em",max:5,color:"grey-5","color-selected":"warning",class:"q-mb-xs","onUpdate:modelValue":Q=>u.setRateValue(Q,a.order_uuid,a.order_id_raw)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),t(q,{side:""})]),_:2},1024))],64)):f("",!0)]),_:2},1024)]),_:2},1024))),128))],64))),128))]),_:1})]),_:1},8,["onLoad"]),t(J,{position:"bottom-right","scroll-offset":150,offset:[18,18]},{default:r(()=>[t(y,{fab:"",icon:"keyboard_arrow_up",color:e.$q.dark.mode?"grey600":"mygrey","text-color":e.$q.dark.mode?"grey300":"dark",dense:"",padding:"3px"},null,8,["color","text-color"])]),_:1})]),_:1},8,["class"])]),_:1},8,["onRefresh"]),t(I,{modelValue:s.modal_search,"onUpdate:modelValue":n[3]||(n[3]=d=>s.modal_search=d),position:"top","transition-show":"fade","transition-hide":"fade"},{default:r(()=>[t(S,{class:v(["no-shadow q-pt-md q-pb-sm",{"text-dark":e.$q.dark.mode,"bg-white":!e.$q.dark.mode}])},{default:r(()=>[t(C,null,{default:r(()=>[t(Z,{onSubmit:u.onSubmit},{default:r(()=>[t(N,{modelValue:s.q,"onUpdate:modelValue":n[2]||(n[2]=d=>s.q=d),label:e.$t("Search order"),outlined:"","lazy-rules":"","bg-color":e.$q.dark.mode?"grey600":"input","label-color":e.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless cursor-pointer"},{append:r(()=>[t(y,{onClick:u.onSubmit,round:"",color:"primary",flat:"",icon:"eva-search-outline"},null,8,["onClick"])]),_:1},8,["modelValue","label","bg-color","label-color"])]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"]),t(z,{ref:"OrderPreview",data:s.order_items,items_details:s.items},null,8,["data","items_details"])],64)}var He=D(te,[["render",be]]);export{He as default};
