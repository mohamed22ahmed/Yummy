import{W as E,bI as u,ay as P,t as L}from"./index.4c3eb750.js";import{u as v}from"./vue-i18n.runtime.esm-bundler.b784e096.js";var l;(function(i){i.Prompt="PROMPT",i.Camera="CAMERA",i.Photos="PHOTOS"})(l||(l={}));var d;(function(i){i.Rear="REAR",i.Front="FRONT"})(d||(d={}));var f;(function(i){i.Uri="uri",i.Base64="base64",i.DataUrl="dataUrl"})(f||(f={}));class g extends E{async getPhoto(a){return new Promise(async(r,t)=>{if(a.webUseInput||a.source===l.Photos)this.fileInputExperience(a,r,t);else if(a.source===l.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=a.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:a.promptLabelPhoto||"From Photos"},{title:a.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",async n=>{n.detail===0?this.fileInputExperience(a,r,t):this.cameraExperience(a,r,t)})}else this.cameraExperience(a,r,t)})}async pickImages(a){return new Promise(async(r,t)=>{this.multipleFileInputExperience(r,t)})}async cameraExperience(a,r,t){if(customElements.get("pwa-camera-modal")){const e=document.createElement("pwa-camera-modal");e.facingMode=a.direction===d.Front?"user":"environment",document.body.appendChild(e);try{await e.componentOnReady(),e.addEventListener("onPhoto",async n=>{const s=n.detail;s===null?t(new u("User cancelled photos app")):s instanceof Error?t(s):r(await this._getCameraPhoto(s,a)),e.dismiss(),document.body.removeChild(e)}),e.present()}catch{this.fileInputExperience(a,r,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(a,r,t)}fileInputExperience(a,r,t){let e=document.querySelector("#_capacitor-camera-input");const n=()=>{var s;(s=e.parentNode)===null||s===void 0||s.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",s=>{const c=e.files[0];let o="jpeg";if(c.type==="image/png"?o="png":c.type==="image/gif"&&(o="gif"),a.resultType==="dataUrl"||a.resultType==="base64"){const m=new FileReader;m.addEventListener("load",()=>{if(a.resultType==="dataUrl")r({dataUrl:m.result,format:o});else if(a.resultType==="base64"){const y=m.result.split(",")[1];r({base64String:y,format:o})}n()}),m.readAsDataURL(c)}else r({webPath:URL.createObjectURL(c),format:o}),n()}),e.addEventListener("cancel",s=>{t(new u("User cancelled photos app")),n()})),e.accept="image/*",e.capture=!0,a.source===l.Photos||a.source===l.Prompt?e.removeAttribute("capture"):a.direction===d.Front?e.capture="user":a.direction===d.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(a,r){let t=document.querySelector("#_capacitor-camera-input-multiple");const e=()=>{var n;(n=t.parentNode)===null||n===void 0||n.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",n=>{const s=[];for(let c=0;c<t.files.length;c++){const o=t.files[c];let m="jpeg";o.type==="image/png"?m="png":o.type==="image/gif"&&(m="gif"),s.push({webPath:URL.createObjectURL(o),format:m})}a({photos:s}),e()}),t.addEventListener("cancel",n=>{r(new u("User cancelled photos app")),e()})),t.accept="image/*",t.click()}_getCameraPhoto(a,r){return new Promise((t,e)=>{const n=new FileReader,s=a.type.split("/")[1];r.resultType==="uri"?t({webPath:URL.createObjectURL(a),format:s,saved:!1}):(n.readAsDataURL(a),n.onloadend=()=>{const c=n.result;r.resultType==="dataUrl"?t({dataUrl:c,format:s,saved:!1}):t({base64String:c.split(",")[1],format:s,saved:!1})},n.onerror=c=>{e(c)})})}async checkPermissions(){if(typeof navigator=="undefined"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}new g;const h=P("Camera",{web:()=>new g});var b;(function(i){i.Documents="DOCUMENTS",i.Data="DATA",i.Library="LIBRARY",i.Cache="CACHE",i.External="EXTERNAL",i.ExternalStorage="EXTERNAL_STORAGE"})(b||(b={}));var w;(function(i){i.UTF8="utf8",i.ASCII="ascii",i.UTF16="utf16"})(w||(w={}));const p=P("Filesystem",{web:()=>L(()=>import("./web.eb179fbd.js"),["assets/web.eb179fbd.js","assets/index.4c3eb750.js","assets/index.4784a50d.css","assets/vue-i18n.runtime.esm-bundler.b784e096.js"]).then(i=>new i.FilesystemWeb)}),R={async isCameraEnabled(){return await new Promise(function(a,r){h.checkPermissions().then(t=>{switch(t.camera){case"prompt":case"prompt-with-rationale":case"denied":h.requestPermissions().then(e=>{switch(e.camera){case"granted":a("granted");break;default:r("denied");break}}).catch(e=>{r(e)});break;case"granted":a("granted");break}}).catch(t=>{r(t)})})},async isFileAccessEnabled(){return await new Promise(function(a,r){p.checkPermissions().then(t=>{switch(t.publicStorage){case"prompt":case"prompt-with-rationale":case"denied":p.requestPermissions().then(e=>{switch(e.publicStorage){case"granted":a("granted");break;default:r("denied");break}}).catch(e=>{r(e)});break;case"granted":a("granted");break;default:r("denied");break}}).catch(t=>{r(t)})})},async getPhoto(i){let a=l.Prompt;i==2?a=l.Camera:i==3&&(a=l.Photos);const{t:r}=v(),t=await h.getPhoto({quality:90,allowEditing:!1,resultType:f.Uri,width:500,source:a,promptLabelHeader:r("Photo"),promptLabelCancel:r("Cancel"),promptLabelPhoto:r("From Photos"),promptLabelPicture:r("Take Picture")});if(t){const e=await p.readFile({path:t.path});if(e)return{format:t.format,path:t.webPath,data:e.data}}return!1},async ReadFile(i){const a=await p.readFile({path:i});return a||!1}};export{R as A,w as E};
