import{l as i}from"./index.4f152a18.js";import{_ as r,Q as n,av as a,m as o,p as h,U as u}from"./index.4c3eb750.js";const c={name:"ComponentsRealtime",props:["getevent","subscribe_to"],setup(){return{DataStore:n()}},data(){return{data:[],pusher:void 0,channel:void 0}},watch:{DataStore:{immediate:!0,deep:!0,handler(e,t){Object.keys(e.realtime_data).length>0&&a.authenticated()&&(this.data=e.realtime_data,this.data.realtime_app_enabled==1&&this.initProvider())}}},methods:{initProvider(){switch(this.data.realtime_provider){case"pusher":i("https://js.pusher.com/7.0/pusher.min.js").then(()=>{this.initPusher()}).catch(()=>{console.debug("failed loading realtime script")});break}},initPusher(){if(o.empty(this.pusher)){Pusher.logToConsole=!1,this.pusher=new Pusher(this.data.pusher_key,{cluster:this.data.pusher_cluster});let t=a.getUser().client_uuid;typeof this.subscribe_to!="undefined"&&this.subscribe_to!==null&&(t=this.subscribe_to),this.channel=this.pusher.subscribe(t),this.channel.bind(this.data.event[this.getevent],s=>{this.$emit("afterReceive",s)})}}}},d={style:{display:"none"}};function l(e,t,s,p,m,_){return h(),u("div",d)}var v=r(c,[["render",l]]);export{v as default};
