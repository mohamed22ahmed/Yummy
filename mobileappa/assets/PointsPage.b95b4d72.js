import{_ as D,m as u,p as s,q as k,s as a,f as t,X as B,a5 as p,Y as d,a6 as g,S as h,as as L,U as r,F as m,az as _,V as b,ab as v,ac as y,b1 as q}from"./index.4c3eb750.js";import{Q as z}from"./QToolbarTitle.eef0f00f.js";import{Q as A}from"./QToolbar.45531803.js";import{Q as I}from"./QHeader.d51d9950.js";import{Q}from"./QSkeleton.d3c12595.js";import{Q as x}from"./QTab.37c50045.js";import{Q as C}from"./QTabs.a0a2f719.js";import{Q as P}from"./QItemLabel.cc035d74.js";import{Q as T}from"./QList.5b181e45.js";import{Q as w}from"./QInnerLoading.488297dd.js";import{Q as S}from"./QSpinnerDots.27b56c3e.js";import{Q as V}from"./QInfiniteScroll.7f30e01e.js";import{Q as N,a as $}from"./QTabPanels.4612ac98.js";import{Q as M}from"./QPage.959871c7.js";import{Q as j}from"./QPullToRefresh.1e0c7d6e.js";import"./QResizeObserver.4d611c44.js";import"./rtl.276c3f1b.js";import"./use-panel.c764e2a6.js";import"./touch.9135741d.js";import"./selection.1ed6461a.js";import"./use-render-cache.3aae9b27.js";import"./format.8ac60962.js";const U={name:"PointsPage",data(){return{tab:"transaction",loading:!1,loading_balance:!0,data:[],page:0,is_refresh:void 0,merchant_refresh:void 0,balance:0,loading_merchant:!1,data_merchant:[],page_merchant:0}},created(){this.getAvailablePoints()},computed:{hasData(){return Object.keys(this.data).length>0},hasDataMerchant(){return Object.keys(this.data_merchant).length>0}},methods:{tabChange(e){e=="transaction"?this.data=[]:this.data_merchant=[]},getAvailablePoints(){this.loading_balance=!0,u.fetchDataByTokenPost("getAvailablePoints").then(e=>{e.code==1?this.balance=e.details.total:this.balance=0}).catch(e=>{}).then(e=>{this.loading_balance=!1})},getPointsTransaction(e,l){this.loading=!0,this.page=e,u.fetchDataByTokenPost("getPointsTransaction","page="+e).then(o=>{console.log(o),o.code==1?this.data.push(o.details.data):this.$refs.nscroll.stop()}).catch(o=>{this.$refs.nscroll&&this.$refs.nscroll.stop()}).then(o=>{this.loading=!1,l(),u.empty(this.is_refresh)||this.is_refresh()})},refresh(e){this.tab=="transaction"?(this.resetPage(),this.is_refresh=e,this.getAvailablePoints()):(this.resetPagination2(),this.merchant_refresh=e)},resetPage(){this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},resetPagination2(){this.page_merchant=0,this.data_merchant=[],this.$refs.merchantScroll.reset(),this.$refs.merchantScroll.resume(),this.$refs.merchantScroll.trigger()},getPointsTransactionMerchant(e,l){this.loading_merchant=!0,this.page_merchant=e,u.fetchDataByTokenPost("getPointsTransactionMerchant","page="+e).then(o=>{console.log(o),o.code==1?this.data_merchant.push(o.details.data):this.$refs.merchantScroll.stop()}).catch(o=>{this.$refs.merchantScroll&&this.$refs.merchantScroll.stop()}).then(o=>{this.loading_merchant=!1,l(),u.empty(this.merchant_refresh)||this.merchant_refresh()})}}},R={class:"row items-center q-gutter-md"},F={class:"col"},O={class:"no-margin"},E={class:"font12 no-margin"},H={key:0,class:"flex flex-center",style:{"min-height":"300px"}},X={class:"text-grey"},Y={key:0,class:"q-pa-xl"},G={key:1,class:"row justify-center absolute-bottom"},J={key:0,class:"flex flex-center",style:{"min-height":"300px"}},K={class:"text-grey"},W={class:"text-bold text-green"},Z={key:0,class:"q-pa-xl"},ee={key:1,class:"row justify-center absolute-bottom"};function te(e,l,o,ae,n,f){return s(),k(j,{onRefresh:f.refresh},{default:a(()=>[t(I,{reveal:"","reveal-offset":"50",class:g({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:a(()=>[t(A,null,{default:a(()=>[t(B,{onClick:l[0]||(l[0]=i=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",class:"q-mr-sm",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),t(z,{class:"text-weight-bold"},{default:a(()=>[p(d(e.$t("Points")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(M,{class:"q-pl-md q-pr-md"},{default:a(()=>[h("div",{class:g(["q-pa-md bg-grey-1x q-mb-sm radius8",{"bg-grey600 text-white":e.$q.dark.mode,"bg-grey-1 text-black":!e.$q.dark.mode}])},[h("div",R,[h("div",null,[n.loading_balance?(s(),k(Q,{key:0,type:"QAvatar"})):(s(),k(L,{key:1,color:"grey-4",name:"card_giftcard",style:{"font-size":"60px"}}))]),h("div",F,[n.loading_balance?(s(),r(m,{key:0},[t(Q,{type:"text"}),t(Q,{type:"text"})],64)):(s(),r(m,{key:1},[h("h4",O,d(n.balance),1),h("p",E,d(e.$t("Available Points")),1)],64))])])],2),t(C,{modelValue:n.tab,"onUpdate:modelValue":[l[1]||(l[1]=i=>n.tab=i),f.tabChange],dense:"","active-color":"primary","indicator-color":"primary",align:"left","narrow-indicator":"","no-caps":"",class:g({"text-grey300":e.$q.dark.mode,"text-dark":!e.$q.dark.mode}),breakpoint:0},{default:a(()=>[t(x,{name:"transaction",label:e.$t("Transactions"),"no-caps":"","content-class":"text-weight-500 "},null,8,["label"]),t(x,{name:"points_merchant",label:e.$t("Points by merchant"),"no-caps":"","content-class":"text-weight-500 "},null,8,["label"])]),_:1},8,["modelValue","class","onUpdate:modelValue"]),t(N,{modelValue:n.tab,"onUpdate:modelValue":l[2]||(l[2]=i=>n.tab=i),animated:"","transition-next":"fade","transition-prev":"fade",class:g({"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode})},{default:a(()=>[t($,{name:"transaction",class:"q-pl-none q-pr-none",style:{"min-height":"300px"}},{default:a(()=>[t(V,{ref:"nscroll",onLoad:f.getPointsTransaction,offset:250},{default:a(()=>[!f.hasData&&!n.loading?(s(),r("div",H,[h("p",X,d(e.$t("No data available")),1)])):_("",!0),t(T,null,{default:a(()=>[(s(!0),r(m,null,b(n.data,i=>(s(),r(m,{key:i},[(s(!0),r(m,null,b(i,c=>(s(),r(m,{key:c.transaction_date},[t(v,null,{default:a(()=>[t(y,null,{default:a(()=>[t(P,null,{default:a(()=>[p(d(c.transaction_description),1)]),_:2},1024),t(P,{caption:""},{default:a(()=>[p(d(c.transaction_date),1)]),_:2},1024)]),_:2},1024),t(y,{side:""},{default:a(()=>[h("div",{class:g(["text-bold",{"text-green":c.transaction_type=="credit","text-red":c.transaction_type=="debit"}])},d(c.transaction_amount),3)]),_:2},1024)]),_:2},1024),t(q,{spaced:"",inset:""})],64))),128))],64))),128))]),_:1})]),loading:a(()=>[n.page<=1?(s(),r("div",Y,[t(w,{showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})])):n.page>2?(s(),r("div",G,[t(S,{color:"secondary",size:"40px"})])):_("",!0)]),_:1},8,["onLoad"])]),_:1}),t($,{name:"points_merchant",class:"q-pl-none q-pr-none",style:{"min-height":"300px"}},{default:a(()=>[t(V,{ref:"merchantScroll",onLoad:f.getPointsTransactionMerchant,offset:250},{default:a(()=>[!f.hasDataMerchant&&!n.loading_merchant?(s(),r("div",J,[h("p",K,d(e.$t("No data available")),1)])):_("",!0),t(T,null,{default:a(()=>[(s(!0),r(m,null,b(n.data_merchant,i=>(s(),r(m,{key:i},[(s(!0),r(m,null,b(i,c=>(s(),r(m,{key:c.total_earning},[t(v,null,{default:a(()=>[t(y,null,{default:a(()=>[t(P,null,{default:a(()=>[p(d(c.restaurant_name),1)]),_:2},1024)]),_:2},1024),t(y,{side:""},{default:a(()=>[h("div",W,d(c.total_earning),1)]),_:2},1024)]),_:2},1024),t(q,{spaced:"",inset:""})],64))),128))],64))),128))]),_:1})]),loading:a(()=>[n.page_merchant<=1?(s(),r("div",Z,[t(w,{showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})])):n.page_merchant>2?(s(),r("div",ee,[t(S,{color:"secondary",size:"40px"})])):_("",!0)]),_:1},8,["onLoad"])]),_:1})]),_:1},8,["modelValue","class"])]),_:1})]),_:1},8,["onRefresh"])}var xe=D(U,[["render",te]]);export{xe as default};
